{"version":3,"file":"index.js.map","sources":["ng://@wm/mobile/runtime/components/app-ext.component.ts","ng://@wm/mobile/runtime/services/cookie.service.ts","ng://@wm/mobile/runtime/services/http-interceptor.service.ts","ng://@wm/mobile/runtime/services/webprocess.service.ts","ng://@wm/mobile/runtime/mobile-runtime.module.ts","ng://@wm/mobile/runtime/index.ts"],"sourcesContent":["import { AfterViewInit, Component, ElementRef, ViewChild } from '@angular/core';\n\nimport { hasCordova } from '@wm/core';\nimport { FileBrowserComponent, FileSelectorService, ProcessManagerComponent, ProcessManagementService } from '@wm/mobile/components';\n\n@Component({\n    selector: '[wmAppExt]',\n    template: `<ng-container>\n        <div wmNetworkInfoToaster></div>\n        <div wmAppUpdate></div>\n        <div wmMobileFileBrowser></div>\n        <div wmProcessManager></div>\n    </ng-container>`\n})\nexport class AppExtComponent implements AfterViewInit {\n\n    @ViewChild(FileBrowserComponent) fileBrowserComponent: FileBrowserComponent;\n\n    @ViewChild(ProcessManagerComponent) processManagerComponent: ProcessManagerComponent;\n\n    constructor(\n        private elRef: ElementRef,\n        private fileSelectorService: FileSelectorService,\n        private processManagementService: ProcessManagementService\n    ) {}\n\n    ngAfterViewInit() {\n        const mobileElements = $(this.elRef.nativeElement).find('>[wmNetworkInfoToaster], >[wmAppUpdate], >[wmMobileFileBrowser]');\n        const $body = $('body:first');\n        if (hasCordova()) {\n            mobileElements.appendTo($body);\n            this.fileSelectorService.setFileBrowser(this.fileBrowserComponent);\n        } else {\n            mobileElements.remove();\n        }\n        $(this.elRef.nativeElement).find('>[wmProgressManager]').appendTo($body);\n        this.processManagementService.setUIComponent(this.processManagerComponent);\n    }\n}\n","import { Injectable } from '@angular/core';\n\nimport { IDeviceStartUpService } from '@wm/mobile/core';\n\ndeclare const _;\n\nconst STORAGE_KEY = 'wavemaker.persistedcookies';\n\ninterface CookieInfo {\n    hostname: string;\n    name: string;\n    value: string;\n}\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CookieService implements IDeviceStartUpService {\n\n    private cookieInfo = {};\n\n    public serviceName = 'CookeService';\n\n    public persistCookie(hostname: string, cookieName: string, cookieValue?: string): Promise<void> {\n        return new Promise<string>(resolve => {\n                if (cookieValue) {\n                    resolve(cookieValue);\n                } else {\n                    this.getCookie(hostname, cookieName)\n                        .then(data => resolve(data.cookieValue));\n                }\n            }).then(value => {\n                this.cookieInfo[hostname + '-' + cookieName] = {\n                    hostname: hostname.replace(/:[0-9]+/, ''),\n                    name: cookieName,\n                    value: this.rotateLTR(value)\n                };\n                localStorage.setItem(STORAGE_KEY, JSON.stringify(this.cookieInfo));\n            });\n    }\n\n    public getCookie(hostname: string, cookieName: string): Promise<any> {\n        return new Promise<void>((resolve, reject) => {\n            window['cookieEmperor'].getCookie(hostname, cookieName, resolve, reject);\n        });\n    }\n\n    public setCookie(hostname: string, cookieName: string, cookieValue: string): Promise<any> {\n        return new Promise<void>((resolve, reject) => {\n            window['cookieEmperor'].setCookie(hostname, cookieName, cookieValue, resolve, reject);\n        });\n    }\n\n    public clearAll(): Promise<any> {\n        return new Promise<any>((resolve, reject) => window['cookieEmperor'].clearAll(resolve, reject));\n    }\n\n    /**\n     * Loads persisted cookies from local storage and adds them to the browser.\n     * @returns {*}\n     */\n    public start(): Promise<any> {\n        const cookieInfoStr = localStorage.getItem(STORAGE_KEY),\n            promises = [];\n        if (cookieInfoStr) {\n            const cookieInfo = JSON.parse(cookieInfoStr) as Map<string, CookieInfo>;\n            _.forEach(cookieInfo, c => {\n                if (c.name && c.value) {\n                    const promise = new Promise((resolve, reject) => {\n                        window['cookieEmperor'].setCookie(c.hostname, c.name, this.rotateRTL(c.value), resolve, reject);\n                    });\n                    promises.push(promise);\n                }\n            });\n        }\n        return Promise.all(promises);\n    }\n\n    /**\n     * Just rotates the given string exactly from 1/3 of string length in left to right direction.\n     * @param str\n     * @returns {string}\n     */\n    private rotateLTR(str: string): string {\n        const arr = str.split(''),\n            tArr = [],\n            shift = Math.floor(str.length / 3);\n        arr.forEach((v, i) => {\n            tArr[(i + shift) % arr.length] = arr[i];\n        });\n        return tArr.join('');\n    }\n\n    /**\n     * Just rotates the given string exactly from 1/3 of string length in  right to left direction..\n     * @param str\n     * @returns {string}\n     */\n    private rotateRTL(str: string): string {\n        const arr = str.split(''),\n            tArr = [],\n            shift = Math.floor(str.length / 3);\n        arr.forEach((v, i) => {\n            tArr[(arr.length + i - shift) % arr.length] = arr[i];\n        });\n        return tArr.join('');\n    }\n}\n","import { HttpEvent, HttpHandler, HttpInterceptor, HttpRequest, HttpResponse } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\n\nimport { File } from '@ionic-native/file';\nimport { from, Observable, Subject } from 'rxjs';\nimport { mergeMap } from 'rxjs/operators';\n\nimport { App, executePromiseChain, getWmProjectProperties, hasCordova, noop, removeExtraSlashes } from '@wm/core';\nimport { DeviceFileDownloadService, DeviceService, NetworkService } from '@wm/mobile/core';\nimport { SecurityService } from '@wm/security';\nimport { CONSTANTS } from '@wm/variables';\n\ndeclare const cordova;\ndeclare const _;\n\ninterface RequestInterceptor {\n    intercept(request: HttpRequest<any>): Promise<HttpRequest<any>>;\n}\n\n@Injectable()\nexport class MobileHttpInterceptor implements HttpInterceptor {\n\n    private requestInterceptors: RequestInterceptor[] = [];\n\n    public constructor(private app: App,\n                       file: File,\n                       deviceFileDownloadService: DeviceFileDownloadService,\n                       private deviceService: DeviceService,\n                       private networkService: NetworkService,\n                       securityService: SecurityService) {\n        if (hasCordova() && !CONSTANTS.isWaveLens) {\n            this.requestInterceptors.push(new SecurityInterceptor(app, file, securityService));\n            this.requestInterceptors.push(new RemoteSyncInterceptor(app, deviceFileDownloadService, deviceService, file, networkService));\n            this.requestInterceptors.push(new ServiceCallInterceptor(app));\n        }\n    }\n\n    public intercept(request: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {\n        const subject = new Subject<HttpEvent<any>>();\n        const token = localStorage.getItem(CONSTANTS.XSRF_COOKIE_NAME);\n        if (token) {\n            // Clone the request to add the new header\n            request = request.clone({ headers: request.headers.set(getWmProjectProperties().xsrf_header_name, token) });\n        }\n        const data = {request: request};\n\n        // invoke the request only when device is ready.\n        const obs = from(this.deviceService.whenReady()\n            .then(() => executePromiseChain(this.getInterceptors(), [data])));\n        return obs.pipe(mergeMap(() => {\n            return next.handle(data.request);\n        }));\n    }\n\n    private getInterceptors() {\n        return this.requestInterceptors.map(i => {\n            return (data) => i.intercept(data.request).then(req => data.request = req);\n        });\n    }\n\n    private onHttpError(response: HttpResponse<any>) {\n        if (hasCordova\n            && (!response || !response.status || response.status < 0 || response.status === 404)\n            && (this.networkService.isConnected())) {\n            this.networkService.isAvailable(true);\n        }\n    }\n}\n\nclass ServiceCallInterceptor implements RequestInterceptor {\n\n    private static REMOTE_SERVICE_URL_PATTERNS = [\n        new RegExp('^((./)|/)?services/'),\n        new RegExp('j_spring_security_check'),\n        new RegExp('j_spring_security_logout')\n    ];\n\n    constructor(private app: App) {}\n\n    public intercept(request: HttpRequest<any>): Promise<HttpRequest<any>> {\n        let modifiedRequest = request;\n        let url = request.url;\n        // if necessary, prepend deployed url\n        if (url.indexOf('://') < 0\n            && ServiceCallInterceptor.REMOTE_SERVICE_URL_PATTERNS.find(r => r.test(url))) {\n            url = this.app.deployedUrl + url;\n        }\n        url = removeExtraSlashes(url);\n        if (url !== request.url) {\n            modifiedRequest = request.clone({\n                url: url\n            });\n        }\n        return Promise.resolve(modifiedRequest);\n    }\n\n}\n\nclass RemoteSyncInterceptor implements RequestInterceptor {\n\n    private checkRemoteDirectory = true;\n    private hasRemoteChanges = false;\n\n    private static URL_TO_SYNC = [\n        new RegExp('page.min.json$'),\n        new RegExp('app.js$'),\n        new RegExp('app.variables.json$')\n    ];\n\n    constructor(private app: App,\n                private deviceFileDownloadService: DeviceFileDownloadService,\n                private deviceService: DeviceService,\n                private file: File,\n                private networkService: NetworkService) {\n        this.file.checkDir(cordova.file.dataDirectory, 'remote').then(() => this.hasRemoteChanges = true, noop);\n    }\n\n    public intercept(request: HttpRequest<any>): Promise<HttpRequest<any>> {\n        const isRemoteSyncEnabled = localStorage.getItem('remoteSync') === 'true';\n        if (this.hasRemoteChanges || isRemoteSyncEnabled) {\n            return Promise.resolve(request.url).then(url => {\n                if (url.indexOf('://') < 0\n                    && RemoteSyncInterceptor.URL_TO_SYNC.find(r => r.test(url))) {\n                    const fileNameFromUrl = _.last(_.split(url, '/'));\n                    return this.download(url, fileNameFromUrl, isRemoteSyncEnabled);\n                }\n                return url;\n            }).then(url => {\n                if (url !== request.url) {\n                    this.hasRemoteChanges = true;\n                    return request.clone({\n                        url: url\n                    });\n                }\n                return request;\n            });\n        } else {\n            return Promise.resolve(request);\n        }\n    }\n\n    private createFolderStructure(parentFolder: string, folderNamesList: string[]): Promise<string> {\n        const folderName = folderNamesList[0];\n        if (!_.isEmpty(folderName)) {\n            return this.file.createDir(parentFolder, folderName, false)\n                .catch(noop)\n                .then(() => {\n                    parentFolder = parentFolder + folderName + '/';\n                    folderNamesList.shift();\n                    return this.createFolderStructure(parentFolder, folderNamesList);\n                });\n        }\n        return Promise.resolve(parentFolder);\n    }\n\n    private init(pageUrl: string, isRemoteSyncEnabled: boolean) {\n        const fileName = _.last(_.split(pageUrl, '/')),\n            path = _.replace(pageUrl, fileName, ''),\n            folderPath = 'remote' + _.replace(path, this.app.deployedUrl, ''),\n            downloadsParent = cordova.file.dataDirectory;\n        return new Promise((resolve, reject) => {\n                if (this.checkRemoteDirectory) {\n                    return this.deviceService.getAppBuildTime().then(buildTime => {\n                        const remoteSyncInfo = this.deviceService.getEntry('remote-sync') || {};\n                        if (!remoteSyncInfo.lastBuildTime || remoteSyncInfo.lastBuildTime !== buildTime) {\n                            return this.file.removeDir(cordova.file.dataDirectory, 'remote')\n                                .catch(noop).then(() => {\n                                    remoteSyncInfo.lastBuildTime = buildTime;\n                                    this.hasRemoteChanges = false;\n                                    return this.deviceService.storeEntry('remote-sync', remoteSyncInfo);\n                                });\n                        }\n                    }).then(() => this.checkRemoteDirectory = false)\n                        .then(resolve, reject);\n                }\n                resolve();\n            })\n            .then(() => this.file.checkDir(downloadsParent, folderPath))\n            .then(() => downloadsParent + folderPath,\n                () => {\n                    if (isRemoteSyncEnabled) {\n                        return this.createFolderStructure(downloadsParent, _.split(folderPath, '/'));\n                    }\n                    return Promise.reject('Could not find equivalent remote path');\n                });\n    }\n\n    private download(url: string, fileName: string, isRemoteSyncEnabled: boolean): Promise<string> {\n        const pageUrl = this.app.deployedUrl + '/' + url;\n        let folderPath;\n        return this.init(pageUrl, isRemoteSyncEnabled)\n            .then(pathToRemote => {\n                folderPath = pathToRemote;\n                return this.file.checkFile(folderPath + fileName, '');\n            }).then(() => {\n                if (isRemoteSyncEnabled && this.networkService.isConnected()) {\n                    return this.file.removeFile(folderPath, fileName)\n                        .then(() => folderPath + fileName);\n                }\n                return folderPath + fileName;\n            }, () => url)\n            .then(path => {\n                if (isRemoteSyncEnabled && this.networkService.isConnected()) {\n                    return this.deviceFileDownloadService.download(pageUrl, false, folderPath, fileName);\n                }\n                return path;\n            });\n    }\n\n}\n\nclass SecurityInterceptor implements RequestInterceptor {\n\n    private initialized = false;\n    private static PAGE_URL_PATTERN = new RegExp('page.min.json$');\n    private publicPages;\n\n    constructor(private app: App, private file: File, private securityService: SecurityService) {}\n\n    public intercept(request: HttpRequest<any>): Promise<HttpRequest<any>> {\n        return new Promise<HttpRequest<any>>((resolve, reject) => {\n            if (SecurityInterceptor.PAGE_URL_PATTERN.test(request.url)) {\n                return Promise.resolve().then(() => {\n                    if (!this.initialized) {\n                        return this.init();\n                    }\n                }).then(() => {\n                    const urlSplits = _.split(request.url, '/');\n                    const pageName = urlSplits[urlSplits.length - 2];\n                    if (!this.publicPages || this.publicPages[pageName]) {\n                        return Promise.resolve(request);\n                    } else {\n                        this.securityService.getConfig(config => {\n                            if (!config.securityEnabled || config.authenticated) {\n                                resolve(request);\n                            } else {\n                                reject(`Page '${pageName}' is not accessible to the user.`);\n                                this.app.notify('http401', { page: pageName});\n                            }\n                        }, () => reject(`Security call failed.`));\n                    }\n                    return Promise.resolve(request);\n                }).then(resolve, reject);\n            }\n            return resolve(request);\n        });\n    }\n\n    /**\n     * loads public pages from 'metadata/app/public-pages.info' and overrides canAccess method SecurityService\n     */\n    private init(): Promise<any> {\n        const folderPath = cordova.file.applicationDirectory + 'www/metadata/app',\n            fileName = 'public-pages.json';\n        return this.file.readAsText(folderPath, fileName).then(text => {\n            if (!this.initialized) {\n                this.publicPages = {};\n                this.initialized = true;\n                _.forEach(JSON.parse(text), pageName => this.publicPages[pageName] = true);\n            }\n        }).catch(() => {\n            this.initialized = true;\n        });\n    }\n}\n","import { Injectable } from '@angular/core';\n\nimport { App, AbstractHttpService } from '@wm/core';\nimport { ExtAppMessageService } from '@wm/mobile/core';\n\nimport { CookieService } from './cookie.service';\n\ndeclare const cordova;\n\n@Injectable()\nexport class WebProcessService {\n\n    constructor(\n        private app: App,\n        private cookieService: CookieService,\n        private httpService: AbstractHttpService,\n        private extAppMessageService: ExtAppMessageService\n    ) {}\n\n    public execute(process: string, hookUrl: string, useSystemBrowser = false): Promise<any> {\n        return this.httpService.get(`/services/webprocess/prepare?processName=${process}&hookUrl=${hookUrl}&requestSourceType=MOBILE`)\n            .then((processInfo) => {\n                if (useSystemBrowser) {\n                    return this.executeWithSystemBrowser(processInfo);\n                } else {\n                    return this.executeWithInAppBrowser(processInfo, process);\n                }\n            }).then(output => {\n                return this.httpService.get('/services/webprocess/decode?encodedProcessdata=' + output);\n            });\n    }\n\n    private executeWithSystemBrowser(processInfo: string): Promise<any> {\n        return new Promise((resolve) => {\n            const oauthAdress = '^services/webprocess/LOGIN';\n            const deregister = this.extAppMessageService.subscribe(oauthAdress, message => {\n                resolve(message.data['process_output']);\n                deregister();\n            });\n            window.open(this.app.deployedUrl + 'services/webprocess/start?process=' + encodeURIComponent(processInfo), '_system');\n        });\n    }\n\n    private executeWithInAppBrowser(processInfo: string, process: string): Promise<any> {\n        return new Promise((resolve, reject) => {\n            const ref = cordova.InAppBrowser.open(this.app.deployedUrl + 'services/webprocess/start?process=' + encodeURIComponent(processInfo), '_blank', 'location=yes,clearcache=yes');\n            let isSuccess = false;\n            ref.addEventListener('loadstop', () => {\n                ref.executeScript({ code: this.getScriptToInject(process)}, output => {\n                    if (output && output[0]) {\n                        isSuccess = true;\n                        ref.close();\n                        resolve(output[0]);\n                    }\n                });\n            });\n            ref.addEventListener('exit', () => {\n                if (!isSuccess) {\n                    reject('Login process is stopped');\n                }\n            });\n        }).then((output) => {\n            let url = this.app.deployedUrl;\n            if (url.endsWith('/')) {\n                url = url.substr(0, url.length - 1);\n            }\n            return this.cookieService.setCookie(url, 'WM_WEB_PROCESS', processInfo)\n                .then(() => output);\n        });\n    }\n\n    private getScriptToInject(process: string): string {\n        return `\n            (function() {\n                var elements = document.querySelectorAll('body.flex>a.link');\n                for (var i = 0; i < elements.length; i++) {\n                    var href = elements[i].href;\n                    if (href && href.indexOf('://services/webprocess/${process}?process_output=')) {\n                        return href.split('process_output=')[1];\n                    }\n                }\n                window.isWebLoginProcess = true;\n            })();\n        `;\n    }\n}\n","import { HTTP_INTERCEPTORS } from '@angular/common/http';\nimport { ModuleWithProviders, NgModule } from '@angular/core';\n\nimport { AppVersion } from '@ionic-native/app-version';\nimport { BarcodeScanner } from '@ionic-native/barcode-scanner';\nimport { Calendar } from '@ionic-native/calendar';\nimport { Camera } from '@ionic-native/camera';\nimport { Contacts } from '@ionic-native/contacts';\nimport { File } from '@ionic-native/file';\nimport { FileOpener } from '@ionic-native/file-opener';\nimport { Device } from '@ionic-native/device';\nimport { MediaCapture } from '@ionic-native/media-capture';\nimport { Geolocation } from '@ionic-native/geolocation';\nimport { Network } from '@ionic-native/network';\nimport { SQLite } from '@ionic-native/sqlite';\nimport { Vibration } from '@ionic-native/vibration';\n\n\nimport {\n    App,\n    AbstractHttpService,\n    fetchContent,\n    hasCordova,\n    insertAfter,\n    isIpad,\n    isIphone,\n    isIpod,\n    isObject,\n    loadStyleSheet,\n    noop,\n    removeNode\n} from '@wm/core';\nimport { FileExtensionFromMimePipe } from '@wm/components';\nimport { WmMobileComponentsModule } from '@wm/mobile/components';\nimport { DeviceFileOpenerService, DeviceService, ExtAppMessageService, MobileCoreModule, NetworkService } from '@wm/mobile/core';\nimport { PushService, PushServiceImpl } from '@wm/mobile/offline';\nimport { SecurityService } from '@wm/security';\nimport { VariablesModule } from '@wm/mobile/variables';\nimport { $rootScope, CONSTANTS } from '@wm/variables';\n\nimport { AppExtComponent } from './components/app-ext.component';\nimport { CookieService } from './services/cookie.service';\nimport { MobileHttpInterceptor } from './services/http-interceptor.service';\nimport { WebProcessService } from './services/webprocess.service';\n\ndeclare const $, navigator, _;\n\nexport const MAX_WAIT_TIME_4_OAUTH_MESSAGE = 60000;\n\nenum OS {\n    IOS = 'ios',\n    ANDROID = 'android'\n}\nconst MINIMUM_TAB_WIDTH = 768;\nconst KEYBOARD_CLASS = 'keyboard';\n\nconst ionicServices = [\n    AppVersion,\n    BarcodeScanner,\n    Calendar,\n    Camera,\n    Contacts,\n    File,\n    FileOpener,\n    Device,\n    Geolocation,\n    MediaCapture,\n    Network,\n    SQLite,\n    Vibration\n];\n\n@NgModule({\n    declarations: [\n        AppExtComponent\n    ],\n    exports: [\n        AppExtComponent,\n        WmMobileComponentsModule\n    ],\n    imports: [\n        MobileCoreModule,\n        VariablesModule,\n        WmMobileComponentsModule\n    ],\n    bootstrap: []\n})\nexport class MobileRuntimeModule {\n\n    static forRoot(): ModuleWithProviders {\n        /* add all providers that are required for mobile here. This is to simplify placeholder.*/\n        return {\n            ngModule: MobileRuntimeModule,\n            providers: [\n                WebProcessService,\n                {\n                    provide: HTTP_INTERCEPTORS,\n                    useClass: MobileHttpInterceptor,\n                    multi: true\n                },\n                ...ionicServices,\n                FileExtensionFromMimePipe,\n                {provide: PushService, useClass: PushServiceImpl}\n            ]\n        };\n    }\n\n    private static initialized = false;\n    // Startup services have to be added only once in the app life-cycle.\n    private static initializeRuntime(runtimeModule: MobileRuntimeModule,\n                      app: App,\n                      cookieService: CookieService,\n                      deviceFileOpenerService: DeviceFileOpenerService,\n                      deviceService: DeviceService) {\n        if (this.initialized) {\n            return;\n        }\n        this.initialized = true;\n        app.deployedUrl = runtimeModule.getDeployedUrl();\n        runtimeModule.getDeviceOS().then(os => {\n            app.selectedViewPort = {\n                os: os\n            };\n            runtimeModule.applyOSTheme(os);\n        });\n        if (hasCordova()) {\n            runtimeModule.handleKeyBoardClass();\n            deviceService.addStartUpService(cookieService);\n            app.subscribe('userLoggedIn', () => {\n                let url = $rootScope.project.deployedUrl;\n                if (url.endsWith('/')) {\n                    url = url.substr(0, url.length - 1);\n                }\n                cookieService.persistCookie(url, 'JSESSIONID').catch(noop);\n                cookieService.persistCookie(url, 'SPRING_SECURITY_REMEMBER_ME_COOKIE').catch(noop);\n            });\n            app.subscribe('device-file-download', (data) => {\n                deviceFileOpenerService.openRemoteFile(data.url, data.extension, data.name).then(data.successCb, data.errorCb);\n            });\n            const __zone_symbol__FileReader = window['__zone_symbol__FileReader'];\n            if (__zone_symbol__FileReader && __zone_symbol__FileReader.READ_CHUNK_SIZE) {\n                // cordova File Reader is required. Otherwise, file operations are failing.\n                window['FileReader'] = __zone_symbol__FileReader;\n            }\n            if (!CONSTANTS.isWaveLens) {\n                (window as any).remoteSync = (flag = true) => {\n                    localStorage.setItem('remoteSync', flag ? 'true' : 'false');\n                };\n            }\n            runtimeModule.addAuthInBrowser();\n        }\n        deviceService.start();\n        deviceService.whenReady().then(() => {\n            if (hasCordova()) {\n                runtimeModule._$appEl.addClass('cordova');\n                runtimeModule.exposeOAuthService();\n                navigator.splashscreen.hide();\n                // Fix for issue: ios device is not considering the background style, eventhough value is set in config.xml.\n                if (window['StatusBar']) {\n                    window['StatusBar'].overlaysWebView(false);\n                }\n            }\n        });\n    }\n\n    private _$appEl;\n\n    constructor(\n        private app: App,\n        private cookieService: CookieService,\n        private deviceFileOpenerService: DeviceFileOpenerService,\n        private deviceService: DeviceService,\n        private securityService: SecurityService,\n        private httpService: AbstractHttpService,\n        private extAppMessageService: ExtAppMessageService,\n        private networkService: NetworkService,\n        private webProcessService: WebProcessService\n    ) {\n        this._$appEl = $('.wm-app:first');\n        if (this._$appEl.width() >= MINIMUM_TAB_WIDTH) {\n            app.isTabletApplicationType =  true;\n            this._$appEl.addClass('wm-tablet-app');\n        } else {\n            this._$appEl.addClass('wm-mobile-app');\n        }\n        MobileRuntimeModule.initializeRuntime(this, this.app, this.cookieService, this.deviceFileOpenerService, this.deviceService);\n    }\n\n    private exposeOAuthService() {\n        window['OAuthInMobile'] = (providerId) => {\n            return new Promise<string>((resolve, reject) => {\n                const oauthAdress = '^services/oauth/' + providerId + '$';\n                const deregister = this.extAppMessageService.subscribe(oauthAdress, message => {\n                        resolve(message.data['access_token']);\n                        deregister();\n                        clearTimeout(timerId);\n                    });\n                const timerId = setTimeout(function () {\n                    deregister();\n                    reject(`Time out for oauth message after ${MAX_WAIT_TIME_4_OAUTH_MESSAGE % 1000} seconds`);\n                }, MAX_WAIT_TIME_4_OAUTH_MESSAGE);\n            });\n        };\n        const handleOpenURL = window['handleOpenURL'];\n        handleOpenURL.isReady = true;\n        handleOpenURL(handleOpenURL.lastURL);\n    }\n\n    private applyOSTheme(os) {\n        let oldStyleSheet = $('link[theme=\"wmtheme\"]:first');\n        const themeUrl = oldStyleSheet.attr('href').replace(new RegExp('/[a-z]*/style.css$'), `/${os.toLowerCase()}/style.css`),\n            newStyleSheet = loadStyleSheet(themeUrl, {name: 'theme', value: 'wmtheme'});\n        oldStyleSheet = oldStyleSheet.length > 0 && oldStyleSheet[0];\n        if (newStyleSheet && oldStyleSheet) {\n            insertAfter(newStyleSheet, oldStyleSheet);\n            removeNode(oldStyleSheet);\n        }\n    }\n\n    private handleKeyBoardClass() {\n        const initialScreenSize = window.innerHeight;\n        // keyboard class is added when keyboard is open.\n        window.addEventListener('resize', () => {\n            if (window.innerHeight < initialScreenSize) {\n                this._$appEl.addClass(KEYBOARD_CLASS);\n            } else {\n                this._$appEl.removeClass(KEYBOARD_CLASS);\n            }\n        });\n    }\n\n    private getDeployedUrl(): string {\n        const waveLensAppUrl = window['WaveLens'] && window['WaveLens']['appUrl'];\n        let deployedUrl = $rootScope.project.deployedUrl;\n        if (hasCordova()) {\n            if (waveLensAppUrl) {\n                // TODO: Temporary Fix for WMS-13072, baseUrl is {{DEVELOPMENT_URL}} in wavelens\n                deployedUrl = waveLensAppUrl;\n            } else {\n                fetchContent('json', './config.json', true, (response => {\n                    if (!response.error && response.baseUrl) {\n                        deployedUrl = response.baseUrl;\n                    }\n                }));\n            }\n        }\n        if (!deployedUrl.endsWith('/')) {\n            deployedUrl = deployedUrl + '/';\n        }\n        $rootScope.project.deployedUrl = deployedUrl;\n        return deployedUrl;\n    }\n\n    private getDeviceOS(): Promise<string> {\n        return new Promise<string>(function (resolve, reject) {\n            const msgContent = {key: 'on-load'};\n            // Notify preview window that application is ready. Otherwise, identify the OS.\n            if (window.top !== window) {\n                window.top.postMessage(msgContent, '*');\n                // This is for preview page\n                window.onmessage = function (msg) {\n                    const data = msg.data;\n                    if (isObject(data) && data.key === 'switch-device') {\n                        resolve(data.device.os);\n                    }\n                };\n            } else if (isIphone() || isIpod() || isIpad()) {\n                resolve(OS.IOS);\n            } else {\n                resolve(OS.ANDROID);\n            }\n        });\n    }\n\n    private addAuthInBrowser() {\n        this.securityService.authInBrowser = (): Promise<any> => {\n            if (!this.networkService.isConnected()) {\n                return Promise.reject('In offline, app cannot contact the server.');\n            }\n            return this.webProcessService.execute('LOGIN', '/')\n                .then(output => {\n                    let url = this.app.deployedUrl;\n                    if (url.endsWith('/')) {\n                        url = url.substr(0, url.length - 1);\n                    }\n                    output = JSON.parse(output);\n                    if (output[CONSTANTS.XSRF_COOKIE_NAME]) {\n                        localStorage.setItem(CONSTANTS.XSRF_COOKIE_NAME, output[CONSTANTS.XSRF_COOKIE_NAME]);\n                    }\n                    return this.cookieService.clearAll()\n                        .then(() => {\n                            const  promises = _.keys(output).map(k => {\n                                return this.cookieService.setCookie(url, k, output[k]);\n                            });\n                            return Promise.all(promises);\n                        });\n                })\n                .then(() => this.app.notify('userLoggedIn', {}));\n        };\n    }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n\nexport {AppExtComponent as Éµa} from './components/app-ext.component';\nexport {CookieService as Éµb} from './services/cookie.service';\nexport {MobileHttpInterceptor as Éµd} from './services/http-interceptor.service';\nexport {WebProcessService as Éµc} from './services/webprocess.service';"],"names":[],"mappings":"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"}
