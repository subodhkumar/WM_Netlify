!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/compiler")):"function"==typeof define&&define.amd?define("@wm/transpiler",["exports","@angular/compiler"],r):r((e.wm=e.wm||{},e.wm.transpiler={}),e.ng.compiler)}(this,function(e,p){"use strict";function v(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,a,i=t.call(e),o=[];try{for(;(void 0===r||0<r--)&&!(n=i.next()).done;)o.push(n.value)}catch(s){a={error:s}}finally{try{n&&!n.done&&(t=i["return"])&&t.call(i)}finally{if(a)throw a.error}}return o}function g(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(v(arguments[r]));return e}var o={COMMENTS_FORMAT:/\/\*((?!\*\/).|\n)+\*\//g,SELECTOR_FORMAT:/[^\{\}]*\{/gi,SELECTOR_EXCLUDE_FORMAT:/(@keyframes|@media|@font-face|@comment[0-9]+|from|to|[0-9]+%)\b/i},s={accessroles:"*accessroles","ng-if":"*ngIf",showindevice:"showInDevice","ng-class":"[ngClass]","data-ng-class":"[ngClass]","data-ng-src":"src","ng-src":"src","data-ng-href":"href","ng-href":"href","ng-disabled":"disabled","data-ng-disabled":"disabled","ng-model":'[ngModelOptions]="{standalone: true}" [(ngModel)]'},u=function(e){return e?(e=e.trim()).startsWith("bind:")?e.substr(5):void 0:null},l=function(e){return(""+e).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},m=new Map,f=new p.HtmlParser,h=function(){return""},b=function(e){var r,t,n=s[e.name],a=e.valueSpan?e.value:undefined;if(n)return"accessroles"===e.name?[n,"'"+a+"'"]:[n,l(a)];if("o"===(t=e.name)[0]&&"n"===t[1]&&"-"===t[2])return[(r=e).name.substr(3)+".event",r.value];var i,o=u(e.value);return o?(i=o,[e.name+".bind",l(i)]):[e.name,l(a)]},y=function(e){var r=e.split(".");if("Variables"===r[0]||"Widgets"===r[0])return r[0]+"."+r[1]},w=function(t){var n="";return t.forEach(function(e,r){n+=" "+r,e&&(e=e.trim(),"[ngClass]"===r&&e.startsWith("{")&&(e=e.replace(/"/g,"'")),"show.bind"===r&&"true"===t.get("deferload")&&(e=e+'" *lazyLoad="'+("&apos;"+e.replace(/&apos/g,"&quot").replace(/&quot/g,"\\&quot")+"&apos;")),n+='="'+e+'"')}),n},a=["padding","borderwidth","margin"],c="unset",E=function(n){Array.from(n.keys()).forEach(function(e){if(a.includes(e)){var r={},t=n.get(e);n["delete"](e),function(t,e,r){var n,a,i,o,s,u=e,l="";function f(e,r){r===c&&(r=""),t[u+e+l]=r}"borderwidth"===e&&(l="width",u="border"),-1!==(n=r).indexOf(c)?(a=(n=n.split(" "))[0],i=n[1]||n[0],o=n[2]||n[0],s=n[3]||n[1]||n[0],f("top",a),f("right",i),f("bottom",o),f("left",s)):("borderwidth"===e&&(u="borderwidth"),t[u]=r)}(r,e,t),Object.keys(r).forEach(function(e){r[e]&&n.set(e,r[e])})}})},O=function(e,r){var t,n,a,i=m.get(e.name);i&&(t=i.pre||h,n=i.post||h,a=i.template||h);var o,s,u,l="";if(r||(r=[]),e instanceof p.Element){var f=void 0;i&&(s=function(t,n,a){if(!t.requires)return[];var e=t.requires;return"string"==typeof e&&(e=[e]),Array.isArray(e)?e.map(function(e){for(var r=a.length-1;0<=r;r--)if("tableName"===a[r].name)return t[a[r].value];for(r=n.length-1;0<=r;r--)if(n[r].nodeName===e)return n[r].provide}):[]}(i,r,e.attrs),u=new Map,a.apply(void 0,g([e,u],s))),o=function(e){var a=new Map;if(e.forEach(function(e){var r=v(b(e),2),t=r[0],n=r[1];a.set(t,n)}),a.get("dataset.bind")){var r=y(a.get("dataset.bind"));r&&a.set("datasource.bind",r)}return a}(e.attrs),E(o);var c=e.name.replace(":svg:svg","svg").replace(":svg:","svg:");if(i){if(l=t.apply(void 0,g([o,u],s)),i.provide){if(f={nodeName:e.name,provide:_.isFunction(i.provide)?i.provide.apply(i,g([o,u],s)):i.provide},"wm-table"===e.name){var d=m.get("wm-table-column");d[_.find(e.attrs,function(e){return"name"===e.name}).value]=f.provide,m.set("wm-table-column",d)}r.push(f)}}else l="<"+c+" "+w(o)+">";e.children.forEach(function(e){return l+=O(e,r)}),i?(f&&r.splice(r.indexOf(f),1),l+=n.apply(void 0,g([o,u],s))):e.endSourceSpan&&!p.getHtmlTagDefinition(e.name).isVoid&&(l+="</"+c+">")}else e instanceof p.Text&&(l+=e.value);return l};e.getBoundToExpr=u,e.getDataSource=y,e.getFormMarkupAttr=function(e){if(e.get("datavalue.bind")){var r=y(e.get("datavalue.bind"));e.set("datavaluesource.bind",r)}return w(e)},e.getAttrMarkup=w,e.processNode=O,e.transpile=function(e){var r,t;if(void 0===e&&(e=""),e.length){var n=f.parse(e,"");if(!n.errors.length){var a="";try{for(var i=function u(e){var r="function"==typeof Symbol&&e[Symbol.iterator],t=0;return r?r.call(e):{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}}}(n.rootNodes),o=i.next();!o.done;o=i.next()){var s=o.value;a+=O(s)}}catch(l){r={error:l}}finally{try{o&&!o.done&&(t=i["return"])&&t.call(i)}finally{if(r)throw r.error}}return a}}},e.register=function(e,r){return m.set(e,r())},e.scopeComponentStyles=function(a,i,e){void 0===e&&(e=""),a=a.toLowerCase();var t={},n=0;if(e.startsWith("/*DISABLE_SCOPING*/"))return e;for(var r in e=(e=e.replace(o.COMMENTS_FORMAT,function(e){var r="@comment"+n+++"{";return t[r]=e,r})).replace(o.SELECTOR_FORMAT,function(e){if(!o.SELECTOR_EXCLUDE_FORMAT.test(e)){var r=e.match(/\S/).index,t="";if(0<r&&(t=e.substring(0,r),e=e.substring(r)),!e.startsWith("/*")&&0<e.trim().length){var n=e.indexOf(" ");if(e.startsWith(".wm-app")){if(!(0<n))return e;e=e.substring(n+1)}0===i||"PAGE"===i?e=".wm-app app-page-"+a+" "+e:1===i||"PREFAB"===i?e=".wm-app app-prefab-"+a+" "+e:2!==i&&"PARTIAL"!==i||(e=".wm-app app-partial-"+a+" "+e)}e=t+e}return e}),t)e=e.replace(r,t[r]);return e},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.min.js.map