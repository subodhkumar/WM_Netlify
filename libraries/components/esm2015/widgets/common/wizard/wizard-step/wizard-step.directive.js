import { ContentChildren, Directive, HostBinding, Injector, Self } from '@angular/core';
import { NgForm } from '@angular/forms';
import { registerProps } from './wizard-step.props';
import { BaseComponent } from '../../base/base.component';
import { RedrawableDirective } from '../../redraw/redrawable.directive';
import { provideAsWidgetRef } from '../../../../utils/widget-utils';
const DEFAULT_CLS = 'app-wizard-step-content';
const WIDGET_CONFIG = {
    widgetType: 'wm-wizardstep',
    hostClass: DEFAULT_CLS,
};
export class WizardStepDirective extends BaseComponent {
    constructor(inj, ngForm) {
        super(inj, WIDGET_CONFIG);
        this.ngForm = ngForm;
        this.status = 2 /* DISABLED */;
    }
    get isCurrent() {
        return this.active;
    }
    get isValid() {
        return this.ngForm.valid;
    }
    get enableNext() {
        return !this.disablenext;
    }
    get enableDone() {
        return !this.disabledone;
    }
    get enablePrev() {
        return !this.disableprevious;
    }
    set active(nv) {
        const isActive = this.active;
        this.status = 1 /* CURRENT */;
        if (nv && !isActive) {
            this.invokeEventCallback('load');
            this.redrawChildren();
        }
    }
    get active() {
        return this.status === 1 /* CURRENT */;
    }
    set done(nv) {
        if (nv) {
            this.status = 3 /* COMPLETED */;
        }
    }
    get done() {
        return this.status === 3 /* COMPLETED */;
    }
    set disabled(nv) {
        if (nv) {
            this.status = 2 /* DISABLED */;
        }
    }
    get disabled() {
        return this.status === 2 /* DISABLED */;
    }
    onNext(index) {
        return this.invokeEventCallback('next', { currentStep: this, stepIndex: index });
    }
    onPrev(index) {
        return this.invokeEventCallback('prev', { currentStep: this, stepIndex: index });
    }
    onSkip(index) {
        return this.invokeEventCallback('skip', { currentStep: this, stepIndex: index });
    }
    // redraw all the projected components which are projected.
    redrawChildren() {
        setTimeout(() => {
            if (this.reDrawableComponents) {
                this.reDrawableComponents.forEach(c => c.redraw());
            }
        }, 100);
    }
}
WizardStepDirective.initializeProps = registerProps();
WizardStepDirective.decorators = [
    { type: Directive, args: [{
                selector: 'form[wmWizardStep]',
                providers: [
                    provideAsWidgetRef(WizardStepDirective)
                ],
                exportAs: 'wmWizardStep'
            },] }
];
/** @nocollapse */
WizardStepDirective.ctorParameters = () => [
    { type: Injector },
    { type: NgForm, decorators: [{ type: Self }] }
];
WizardStepDirective.propDecorators = {
    reDrawableComponents: [{ type: ContentChildren, args: [RedrawableDirective, { descendants: true },] }],
    isCurrent: [{ type: HostBinding, args: ['class.current',] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2l6YXJkLXN0ZXAuZGlyZWN0aXZlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHdtL2NvbXBvbmVudHMvIiwic291cmNlcyI6WyJ3aWRnZXRzL2NvbW1vbi93aXphcmQvd2l6YXJkLXN0ZXAvd2l6YXJkLXN0ZXAuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxlQUFlLEVBQUUsU0FBUyxFQUFFLFdBQVcsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3hGLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUd4QyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDcEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQzFELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBQ3hFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBRXBFLE1BQU0sV0FBVyxHQUFHLHlCQUF5QixDQUFDO0FBQzlDLE1BQU0sYUFBYSxHQUFrQjtJQUNqQyxVQUFVLEVBQUUsZUFBZTtJQUMzQixTQUFTLEVBQUUsV0FBVztDQUN6QixDQUFDO0FBZUYsTUFBTSxPQUFPLG1CQUFvQixTQUFRLGFBQWE7SUFzRWxELFlBQVksR0FBYSxFQUFrQixNQUFjO1FBQ3JELEtBQUssQ0FBQyxHQUFHLEVBQUUsYUFBYSxDQUFDLENBQUM7UUFEYSxXQUFNLEdBQU4sTUFBTSxDQUFRO1FBM0RqRCxXQUFNLG9CQUFxQztJQTZEbkQsQ0FBQztJQXhERCxJQUNJLFNBQVM7UUFDVCxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUM7SUFDdkIsQ0FBQztJQUVELElBQVcsT0FBTztRQUNkLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUM7SUFDN0IsQ0FBQztJQUVELElBQVcsVUFBVTtRQUNqQixPQUFPLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQztJQUM3QixDQUFDO0lBRUQsSUFBVyxVQUFVO1FBQ2pCLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDO0lBQzdCLENBQUM7SUFFRCxJQUFXLFVBQVU7UUFDakIsT0FBTyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUM7SUFDakMsQ0FBQztJQUVELElBQVcsTUFBTSxDQUFDLEVBQVc7UUFDekIsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUM3QixJQUFJLENBQUMsTUFBTSxrQkFBc0IsQ0FBQztRQUNsQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFFBQVEsRUFBRTtZQUNqQixJQUFJLENBQUMsbUJBQW1CLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDakMsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1NBQ3pCO0lBQ0wsQ0FBQztJQUVELElBQVcsTUFBTTtRQUNiLE9BQU8sSUFBSSxDQUFDLE1BQU0sb0JBQXdCLENBQUM7SUFDL0MsQ0FBQztJQUVELElBQVcsSUFBSSxDQUFDLEVBQVc7UUFDdkIsSUFBSSxFQUFFLEVBQUU7WUFDSixJQUFJLENBQUMsTUFBTSxvQkFBd0IsQ0FBQztTQUN2QztJQUNMLENBQUM7SUFFRCxJQUFXLElBQUk7UUFDWCxPQUFPLElBQUksQ0FBQyxNQUFNLHNCQUEwQixDQUFDO0lBQ2pELENBQUM7SUFFRCxJQUFXLFFBQVEsQ0FBQyxFQUFXO1FBQzNCLElBQUksRUFBRSxFQUFFO1lBQ0osSUFBSSxDQUFDLE1BQU0sbUJBQXVCLENBQUM7U0FDdEM7SUFDTCxDQUFDO0lBRUQsSUFBVyxRQUFRO1FBQ2YsT0FBTyxJQUFJLENBQUMsTUFBTSxxQkFBeUIsQ0FBQztJQUNoRCxDQUFDO0lBTU0sTUFBTSxDQUFDLEtBQWE7UUFDdkIsT0FBTyxJQUFJLENBQUMsbUJBQW1CLENBQUMsTUFBTSxFQUFFLEVBQUMsV0FBVyxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFDLENBQUMsQ0FBQztJQUNuRixDQUFDO0lBRU0sTUFBTSxDQUFDLEtBQWE7UUFDdkIsT0FBTyxJQUFJLENBQUMsbUJBQW1CLENBQUMsTUFBTSxFQUFFLEVBQUMsV0FBVyxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFDLENBQUMsQ0FBQztJQUNuRixDQUFDO0lBRU0sTUFBTSxDQUFDLEtBQWE7UUFDdkIsT0FBTyxJQUFJLENBQUMsbUJBQW1CLENBQUMsTUFBTSxFQUFFLEVBQUMsV0FBVyxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFDLENBQUMsQ0FBQztJQUNuRixDQUFDO0lBRUQsMkRBQTJEO0lBQ25ELGNBQWM7UUFDbEIsVUFBVSxDQUFDLEdBQUcsRUFBRTtZQUNaLElBQUksSUFBSSxDQUFDLG9CQUFvQixFQUFFO2dCQUMzQixJQUFJLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUM7YUFDdEQ7UUFDTCxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDWixDQUFDOztBQTVGTSxtQ0FBZSxHQUFHLGFBQWEsRUFBRSxDQUFDOztZQVI1QyxTQUFTLFNBQUM7Z0JBQ1AsUUFBUSxFQUFFLG9CQUFvQjtnQkFDOUIsU0FBUyxFQUFFO29CQUNQLGtCQUFrQixDQUFDLG1CQUFtQixDQUFDO2lCQUMxQztnQkFDRCxRQUFRLEVBQUUsY0FBYzthQUMzQjs7OztZQTNCaUQsUUFBUTtZQUNqRCxNQUFNLHVCQWlHaUIsSUFBSTs7O21DQXhEL0IsZUFBZSxTQUFDLG1CQUFtQixFQUFFLEVBQUMsV0FBVyxFQUFFLElBQUksRUFBQzt3QkFFeEQsV0FBVyxTQUFDLGVBQWUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb250ZW50Q2hpbGRyZW4sIERpcmVjdGl2ZSwgSG9zdEJpbmRpbmcsIEluamVjdG9yLCBTZWxmIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBOZ0Zvcm0gfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5cbmltcG9ydCB7IElXaWRnZXRDb25maWcgfSBmcm9tICcuLi8uLi8uLi9mcmFtZXdvcmsvdHlwZXMnO1xuaW1wb3J0IHsgcmVnaXN0ZXJQcm9wcyB9IGZyb20gJy4vd2l6YXJkLXN0ZXAucHJvcHMnO1xuaW1wb3J0IHsgQmFzZUNvbXBvbmVudCB9IGZyb20gJy4uLy4uL2Jhc2UvYmFzZS5jb21wb25lbnQnO1xuaW1wb3J0IHsgUmVkcmF3YWJsZURpcmVjdGl2ZSB9IGZyb20gJy4uLy4uL3JlZHJhdy9yZWRyYXdhYmxlLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBwcm92aWRlQXNXaWRnZXRSZWYgfSBmcm9tICcuLi8uLi8uLi8uLi91dGlscy93aWRnZXQtdXRpbHMnO1xuXG5jb25zdCBERUZBVUxUX0NMUyA9ICdhcHAtd2l6YXJkLXN0ZXAtY29udGVudCc7XG5jb25zdCBXSURHRVRfQ09ORklHOiBJV2lkZ2V0Q29uZmlnID0ge1xuICAgIHdpZGdldFR5cGU6ICd3bS13aXphcmRzdGVwJyxcbiAgICBob3N0Q2xhc3M6IERFRkFVTFRfQ0xTLFxufTtcblxuY29uc3QgZW51bSBTVEVQX1NUQVRVUyB7XG4gICAgQ1VSUkVOVCA9IDEsXG4gICAgRElTQUJMRUQsXG4gICAgQ09NUExFVEVEXG59XG5cbkBEaXJlY3RpdmUoe1xuICAgIHNlbGVjdG9yOiAnZm9ybVt3bVdpemFyZFN0ZXBdJyxcbiAgICBwcm92aWRlcnM6IFtcbiAgICAgICAgcHJvdmlkZUFzV2lkZ2V0UmVmKFdpemFyZFN0ZXBEaXJlY3RpdmUpXG4gICAgXSxcbiAgICBleHBvcnRBczogJ3dtV2l6YXJkU3RlcCdcbn0pXG5leHBvcnQgY2xhc3MgV2l6YXJkU3RlcERpcmVjdGl2ZSBleHRlbmRzIEJhc2VDb21wb25lbnQge1xuICAgIHN0YXRpYyBpbml0aWFsaXplUHJvcHMgPSByZWdpc3RlclByb3BzKCk7XG5cbiAgICBwdWJsaWMgc2hvdzogYm9vbGVhbjtcbiAgICBwdWJsaWMgbmFtZTogc3RyaW5nO1xuICAgIHB1YmxpYyBlbmFibGVza2lwOiBhbnk7XG4gICAgcHVibGljIGRpc2FibGVuZXh0OiBib29sZWFuO1xuICAgIHB1YmxpYyBkaXNhYmxlZG9uZTogYm9vbGVhbjtcbiAgICBwdWJsaWMgZGlzYWJsZXByZXZpb3VzOiBib29sZWFuO1xuICAgIHB1YmxpYyBpc0luaXRpYWxpemVkOiBib29sZWFuO1xuXG4gICAgcHJpdmF0ZSBzdGF0dXM6IFNURVBfU1RBVFVTID0gU1RFUF9TVEFUVVMuRElTQUJMRUQ7XG5cbiAgICAvLyByZWZlcmVuY2UgdG8gdGhlIGNvbXBvbmVudHMgd2hpY2ggbmVlZHMgYSByZWRyYXcoZWcsIGdyaWQsIGNoYXJ0KSB3aGVuIHRoZSBoZWlnaHQgb2YgdGhpcyBjb21wb25lbnQgY2hhbmdlc1xuICAgIEBDb250ZW50Q2hpbGRyZW4oUmVkcmF3YWJsZURpcmVjdGl2ZSwge2Rlc2NlbmRhbnRzOiB0cnVlfSkgcmVEcmF3YWJsZUNvbXBvbmVudHM7XG5cbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLmN1cnJlbnQnKVxuICAgIGdldCBpc0N1cnJlbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFjdGl2ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IGlzVmFsaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5nRm9ybS52YWxpZDtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IGVuYWJsZU5leHQoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5kaXNhYmxlbmV4dDtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IGVuYWJsZURvbmUoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5kaXNhYmxlZG9uZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IGVuYWJsZVByZXYoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5kaXNhYmxlcHJldmlvdXM7XG4gICAgfVxuXG4gICAgcHVibGljIHNldCBhY3RpdmUobnY6IGJvb2xlYW4pIHtcbiAgICAgICAgY29uc3QgaXNBY3RpdmUgPSB0aGlzLmFjdGl2ZTtcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBTVEVQX1NUQVRVUy5DVVJSRU5UO1xuICAgICAgICBpZiAobnYgJiYgIWlzQWN0aXZlKSB7XG4gICAgICAgICAgICB0aGlzLmludm9rZUV2ZW50Q2FsbGJhY2soJ2xvYWQnKTtcbiAgICAgICAgICAgIHRoaXMucmVkcmF3Q2hpbGRyZW4oKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgYWN0aXZlKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5zdGF0dXMgPT09IFNURVBfU1RBVFVTLkNVUlJFTlQ7XG4gICAgfVxuXG4gICAgcHVibGljIHNldCBkb25lKG52OiBib29sZWFuKSB7XG4gICAgICAgIGlmIChudikge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBTVEVQX1NUQVRVUy5DT01QTEVURUQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0IGRvbmUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLnN0YXR1cyA9PT0gU1RFUF9TVEFUVVMuQ09NUExFVEVEO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXQgZGlzYWJsZWQobnY6IGJvb2xlYW4pIHtcbiAgICAgICAgaWYgKG52KSB7XG4gICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFNURVBfU1RBVFVTLkRJU0FCTEVEO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGdldCBkaXNhYmxlZCgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhdHVzID09PSBTVEVQX1NUQVRVUy5ESVNBQkxFRDtcbiAgICB9XG5cbiAgICBjb25zdHJ1Y3Rvcihpbmo6IEluamVjdG9yLCBAU2VsZigpIHByaXZhdGUgbmdGb3JtOiBOZ0Zvcm0pIHtcbiAgICAgICAgc3VwZXIoaW5qLCBXSURHRVRfQ09ORklHKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgb25OZXh0KGluZGV4OiBudW1iZXIpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW52b2tlRXZlbnRDYWxsYmFjaygnbmV4dCcsIHtjdXJyZW50U3RlcDogdGhpcywgc3RlcEluZGV4OiBpbmRleH0pO1xuICAgIH1cblxuICAgIHB1YmxpYyBvblByZXYoaW5kZXg6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5pbnZva2VFdmVudENhbGxiYWNrKCdwcmV2Jywge2N1cnJlbnRTdGVwOiB0aGlzLCBzdGVwSW5kZXg6IGluZGV4fSk7XG4gICAgfVxuXG4gICAgcHVibGljIG9uU2tpcChpbmRleDogbnVtYmVyKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmludm9rZUV2ZW50Q2FsbGJhY2soJ3NraXAnLCB7Y3VycmVudFN0ZXA6IHRoaXMsIHN0ZXBJbmRleDogaW5kZXh9KTtcbiAgICB9XG5cbiAgICAvLyByZWRyYXcgYWxsIHRoZSBwcm9qZWN0ZWQgY29tcG9uZW50cyB3aGljaCBhcmUgcHJvamVjdGVkLlxuICAgIHByaXZhdGUgcmVkcmF3Q2hpbGRyZW4oKSB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMucmVEcmF3YWJsZUNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlRHJhd2FibGVDb21wb25lbnRzLmZvckVhY2goYyA9PiBjLnJlZHJhdygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgMTAwKTtcbiAgICB9XG59XG4iXX0=