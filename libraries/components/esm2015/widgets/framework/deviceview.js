import { isMobile, setCSS } from '@wm/core';
var CLASS_NAME;
(function (CLASS_NAME) {
    CLASS_NAME["LEFT_PANEL"] = "page-left-panel";
    CLASS_NAME["RIGHT_PANEL"] = "page-right-panel";
    CLASS_NAME["SWIPE_ELEM"] = "page-left-panel-icon";
    CLASS_NAME["CONTENT"] = "app-content-column";
    CLASS_NAME["HEADER"] = "page-header";
    CLASS_NAME["SEARCH"] = "app-search";
})(CLASS_NAME || (CLASS_NAME = {}));
/**
 * method returns jquery class selector for given roleName
 * @param roleName
 * @returns {string}
 */
const roleSelector = (roleName) => `[data-role='${roleName}']`;
const ɵ0 = roleSelector;
/*setup touch event handler*/
const bindTapEvtHandler = (selector, handler) => {
    /*
     * In Iphone safari browser, tap event of HammerJs is breaking
     * functionalities of other controls like input[type="range"].
     * So, replaced the hammer Js handler with click event handler.
     */
    $(selector).off('click.deviceview').on('click.deviceview', handler);
};
const ɵ1 = bindTapEvtHandler;
/**
 * hide the mobile toolbar actions
 */
const hidePageContainers = (leftNavEle, searchEle) => {
    if (isMobile()) {
        if (leftNavEle) {
            try {
                leftNavEle.widget.collapse();
            }
            catch (e) {
                //
            }
        }
        if (searchEle) {
            setCSS(searchEle, 'display', 'none');
        }
    }
};
const ɵ2 = hidePageContainers;
/**
 * binds the touch event for content
 */
const bindContentEvents = (leftNavEle, pageContainer, searchContainer, isTablet = false) => {
    if (!isTablet) {
        // touch content to hide nav pane and left panel
        bindTapEvtHandler(pageContainer, hidePageContainers.bind(this, leftNavEle, searchContainer));
    }
};
const ɵ3 = bindContentEvents;
const bindLeftPanelEvents = (leftNavEle, searchEle) => {
    // tap left to show/hide left panel
    bindTapEvtHandler(roleSelector(CLASS_NAME.SWIPE_ELEM), () => {
        if (leftNavEle) {
            leftNavEle.widget.toggle();
            // Hide search container when left panel is open
            if (leftNavEle.classList.contains('visible')) {
                if (searchEle) {
                    setCSS(searchEle, 'display', 'none');
                }
            }
        }
    });
};
const ɵ4 = bindLeftPanelEvents;
/**
 * binds the touch event for content
 */
const bindRightPanelEvents = (rightNavEle) => {
    bindTapEvtHandler(rightNavEle, hidePageContainers);
};
const ɵ5 = bindRightPanelEvents;
/**
 * toggles the search container
 */
const toggleSearchContainer = (searchEle, leftNavEle) => {
    if ($(searchEle).css('display') === 'none') {
        hidePageContainers(leftNavEle);
        setCSS(searchEle, 'display', 'inline-table');
    }
    else {
        hidePageContainers(leftNavEle, searchEle);
    }
};
const ɵ6 = toggleSearchContainer;
/**
 * Bind event with Search icon in header
 */
const bindSearchIconEvent = (searchElements, leftNavEle) => {
    $(searchElements).each((index, ele) => {
        const searchEle = $('<a class="app-header-action"><i class="wi wi-search"></i></a>');
        $(ele).before(searchEle);
        // Tap icon to show/hide search box
        bindTapEvtHandler(searchEle, () => toggleSearchContainer(ele, leftNavEle));
    });
};
const ɵ7 = bindSearchIconEvent;
export const updateDeviceView = (element, isTablet = false) => {
    const leftNavEle = element.querySelector(roleSelector(CLASS_NAME.LEFT_PANEL));
    const rightNavEle = element.querySelector(roleSelector(CLASS_NAME.RIGHT_PANEL));
    const headerEle = element.querySelector(roleSelector(CLASS_NAME.HEADER));
    const searchEle = headerEle && headerEle.querySelector(`.${CLASS_NAME.SEARCH}`);
    const pageEle = element.querySelector(`.${CLASS_NAME.CONTENT}`);
    bindContentEvents(leftNavEle, pageEle, searchEle, isTablet);
    if (leftNavEle) {
        bindLeftPanelEvents(leftNavEle, searchEle);
    }
    else {
        // remove the icon
        $(headerEle).find(roleSelector(CLASS_NAME.SWIPE_ELEM)).remove();
    }
    if (rightNavEle) {
        bindRightPanelEvents(rightNavEle);
    }
    if (searchEle) {
        bindSearchIconEvent(searchEle, leftNavEle);
    }
};
export { ɵ0, ɵ1, ɵ2, ɵ3, ɵ4, ɵ5, ɵ6, ɵ7 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGV2aWNldmlldy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B3bS9jb21wb25lbnRzLyIsInNvdXJjZXMiOlsid2lkZ2V0cy9mcmFtZXdvcmsvZGV2aWNldmlldy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUk1QyxJQUFLLFVBT0o7QUFQRCxXQUFLLFVBQVU7SUFDWCw0Q0FBOEIsQ0FBQTtJQUM5Qiw4Q0FBZ0MsQ0FBQTtJQUNoQyxpREFBbUMsQ0FBQTtJQUNuQyw0Q0FBOEIsQ0FBQTtJQUM5QixvQ0FBc0IsQ0FBQTtJQUN0QixtQ0FBcUIsQ0FBQTtBQUN6QixDQUFDLEVBUEksVUFBVSxLQUFWLFVBQVUsUUFPZDtBQUVEOzs7O0dBSUc7QUFDSCxNQUFNLFlBQVksR0FBRyxDQUFDLFFBQWdCLEVBQUUsRUFBRSxDQUFDLGVBQWUsUUFBUSxJQUFJLENBQUM7O0FBRXZFLDZCQUE2QjtBQUM3QixNQUFNLGlCQUFpQixHQUFHLENBQUMsUUFBUSxFQUFFLE9BQU8sRUFBRSxFQUFFO0lBQzVDOzs7O09BSUc7SUFDSCxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxDQUFDLGtCQUFrQixDQUFDLENBQUMsRUFBRSxDQUFDLGtCQUFrQixFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3hFLENBQUMsQ0FBQzs7QUFFRjs7R0FFRztBQUNILE1BQU0sa0JBQWtCLEdBQUcsQ0FBQyxVQUF1QixFQUFFLFNBQXVCLEVBQUUsRUFBRTtJQUM1RSxJQUFJLFFBQVEsRUFBRSxFQUFFO1FBQ1osSUFBSSxVQUFVLEVBQUU7WUFDWixJQUFJO2dCQUNDLFVBQWtCLENBQUMsTUFBTSxDQUFDLFFBQVEsRUFBRSxDQUFDO2FBQ3pDO1lBQUMsT0FBTyxDQUFDLEVBQUU7Z0JBQ1IsRUFBRTthQUNMO1NBQ0o7UUFDRCxJQUFJLFNBQVMsRUFBRTtZQUNYLE1BQU0sQ0FBQyxTQUFTLEVBQUUsU0FBUyxFQUFF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QUksU0FBUyxJQUFJLFNBQVMsQ0FBQyxhQUFhLENBQUMsSUFBSSxVQUFVLENBQUMsTUFBTSxFQUFFLENBQWdCLENBQUM7SUFDaEcsTUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLGFBQWEsQ0FBQyxJQUFJLFVBQVUsQ0FBQyxPQUFPLEVBQUUsQ0FBZ0IsQ0FBQztJQUUvRSxpQkFBaUIsQ0FBQyxVQUFVLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxRQUFRLENBQUMsQ0FBQztJQUU1RCxJQUFJLFVBQVUsRUFBRTtRQUNaLG1CQUFtQixDQUFDLFVBQVUsRUFBRSxTQUFTLENBQUMsQ0FBQztLQUM5QztTQUFNO1FBQ0gsa0JBQWtCO1FBQ2xCLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDO0tBQ25FO0lBRUQsSUFBSSxXQUFXLEVBQUU7UUFDYixvQkFBb0IsQ0FBQyxXQUFXLENBQUMsQ0FBQztLQUNyQztJQUVELElBQUksU0FBUyxFQUFFO1FBQ1gsbUJBQW1CLENBQUMsU0FBUyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0tBQzlDO0FBQ0wsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNNb2JpbGUsIHNldENTUyB9IGZyb20gJ0B3bS9jb3JlJztcblxuZGVjbGFyZSBjb25zdCAkO1xuXG5lbnVtIENMQVNTX05BTUUge1xuICAgIExFRlRfUEFORUwgPSAncGFnZS1sZWZ0LXBhbmVsJyxcbiAgICBSSUdIVF9QQU5FTCA9ICdwYWdlLXJpZ2h0LXBhbmVsJyxcbiAgICBTV0lQRV9FTEVNID0gJ3BhZ2UtbGVmdC1wYW5lbC1pY29uJyxcbiAgICBDT05URU5UID0gJ2FwcC1jb250ZW50LWNvbHVtbicsXG4gICAgSEVBREVSID0gJ3BhZ2UtaGVhZGVyJyxcbiAgICBTRUFSQ0ggPSAnYXBwLXNlYXJjaCdcbn1cblxuLyoqXG4gKiBtZXRob2QgcmV0dXJucyBqcXVlcnkgY2xhc3Mgc2VsZWN0b3IgZm9yIGdpdmVuIHJvbGVOYW1lXG4gKiBAcGFyYW0gcm9sZU5hbWVcbiAqIEByZXR1cm5zIHtzdHJpbmd9XG4gKi9cbmNvbnN0IHJvbGVTZWxlY3RvciA9IChyb2xlTmFtZTogc3RyaW5nKSA9PiBgW2RhdGEtcm9sZT0nJHtyb2xlTmFtZX0nXWA7XG5cbi8qc2V0dXAgdG91Y2ggZXZlbnQgaGFuZGxlciovXG5jb25zdCBiaW5kVGFwRXZ0SGFuZGxlciA9IChzZWxlY3RvciwgaGFuZGxlcikgPT4ge1xuICAgIC8qXG4gICAgICogSW4gSXBob25lIHNhZmFyaSBicm93c2VyLCB0YXAgZXZlbnQgb2YgSGFtbWVySnMgaXMgYnJlYWtpbmdcbiAgICAgKiBmdW5jdGlvbmFsaXRpZXMgb2Ygb3RoZXIgY29udHJvbHMgbGlrZSBpbnB1dFt0eXBlPVwicmFuZ2VcIl0uXG4gICAgICogU28sIHJlcGxhY2VkIHRoZSBoYW1tZXIgSnMgaGFuZGxlciB3aXRoIGNsaWNrIGV2ZW50IGhhbmRsZXIuXG4gICAgICovXG4gICAgJChzZWxlY3Rvcikub2ZmKCdjbGljay5kZXZpY2V2aWV3Jykub24oJ2NsaWNrLmRldmljZXZpZXcnLCBoYW5kbGVyKTtcbn07XG5cbi8qKlxuICogaGlkZSB0aGUgbW9iaWxlIHRvb2xiYXIgYWN0aW9uc1xuICovXG5jb25zdCBoaWRlUGFnZUNvbnRhaW5lcnMgPSAobGVmdE5hdkVsZTogSFRNTEVsZW1lbnQsIHNlYXJjaEVsZT86IEhUTUxFbGVtZW50KSA9PiB7XG4gICAgaWYgKGlzTW9iaWxlKCkpIHtcbiAgICAgICAgaWYgKGxlZnROYXZFbGUpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgKGxlZnROYXZFbGUgYXMgYW55KS53aWRnZXQuY29sbGFwc2UoKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvL1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChzZWFyY2hFbGUpIHtcbiAgICAgICAgICAgIHNldENTUyhzZWFyY2hFbGUsICdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbi8qKlxuICogYmluZHMgdGhlIHRvdWNoIGV2ZW50IGZvciBjb250ZW50XG4gKi9cbmNvbnN0IGJpbmRDb250ZW50RXZlbnRzID0gKGxlZnROYXZFbGU6IEhUTUxFbGVtZW50LCBwYWdlQ29udGFpbmVyOiBIVE1MRWxlbWVudCwgc2VhcmNoQ29udGFpbmVyOiBhbnksIGlzVGFibGV0ID0gZmFsc2UpID0+IHtcbiAgICBpZiAoIWlzVGFibGV0KSB7XG4gICAgICAgIC8vIHRvdWNoIGNvbnRlbnQgdG8gaGlkZSBuYXYgcGFuZSBhbmQgbGVmdCBwYW5lbFxuICAgICAgICBiaW5kVGFwRXZ0SGFuZGxlcihwYWdlQ29udGFpbmVyLCBoaWRlUGFnZUNvbnRhaW5lcnMuYmluZCh0aGlzLCBsZWZ0TmF2RWxlLCBzZWFyY2hDb250YWluZXIpKTtcbiAgICB9XG59O1xuXG5jb25zdCBiaW5kTGVmdFBhbmVsRXZlbnRzID0gKGxlZnROYXZFbGU6IEhUTUxFbGVtZW50LCBzZWFyY2hFbGU6IEhUTUxFbGVtZW50KSA9PiB7XG4gICAgLy8gdGFwIGxlZnQgdG8gc2hvdy9oaWRlIGxlZnQgcGFuZWxcbiAgICBiaW5kVGFwRXZ0SGFuZGxlcihyb2xlU2VsZWN0b3IoQ0xBU1NfTkFNRS5TV0lQRV9FTEVNKSwgKCkgPT4ge1xuICAgICAgICBpZiAobGVmdE5hdkVsZSkge1xuICAgICAgICAgICAgKGxlZnROYXZFbGUgYXMgYW55KS53aWRnZXQudG9nZ2xlKCk7XG5cbiAgICAgICAgICAgIC8vIEhpZGUgc2VhcmNoIGNvbnRhaW5lciB3aGVuIGxlZnQgcGFuZWwgaXMgb3BlblxuICAgICAgICAgICAgaWYgKGxlZnROYXZFbGUuY2xhc3NMaXN0LmNvbnRhaW5zKCd2aXNpYmxlJykpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VhcmNoRWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldENTUyhzZWFyY2hFbGUsICdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbn07XG5cbi8qKlxuICogYmluZHMgdGhlIHRvdWNoIGV2ZW50IGZvciBjb250ZW50XG4gKi9cbmNvbnN0IGJpbmRSaWdodFBhbmVsRXZlbnRzID0gKHJpZ2h0TmF2RWxlOiBIVE1MRWxlbWVudCkgPT4ge1xuICAgIGJpbmRUYXBFdnRIYW5kbGVyKHJpZ2h0TmF2RWxlLCBoaWRlUGFnZUNvbnRhaW5lcnMpO1xufTtcblxuXG4vKipcbiAqIHRvZ2dsZXMgdGhlIHNlYXJjaCBjb250YWluZXJcbiAqL1xuY29uc3QgdG9nZ2xlU2VhcmNoQ29udGFpbmVyID0gKHNlYXJjaEVsZTogSFRNTEVsZW1lbnQsIGxlZnROYXZFbGU6IEhUTUxFbGVtZW50KSA9PiB7XG4gICAgaWYgKCQoc2VhcmNoRWxlKS5jc3MoJ2Rpc3BsYXknKSA9PT0gJ25vbmUnKSB7XG4gICAgICAgIGhpZGVQYWdlQ29udGFpbmVycyhsZWZ0TmF2RWxlKTtcbiAgICAgICAgc2V0Q1NTKHNlYXJjaEVsZSwgJ2Rpc3BsYXknLCAnaW5saW5lLXRhYmxlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaGlkZVBhZ2VDb250YWluZXJzKGxlZnROYXZFbGUsIHNlYXJjaEVsZSk7XG4gICAgfVxufTtcblxuLyoqXG4gKiBCaW5kIGV2ZW50IHdpdGggU2VhcmNoIGljb24gaW4gaGVhZGVyXG4gKi9cbmNvbnN0IGJpbmRTZWFyY2hJY29uRXZlbnQgPSAoc2VhcmNoRWxlbWVudHMsIGxlZnROYXZFbGU6IEhUTUxFbGVtZW50KSA9PiB7XG5cbiAgICAkKHNlYXJjaEVsZW1lbnRzKS5lYWNoKChpbmRleCwgZWxlOiBIVE1MRWxlbWVudCkgPT4ge1xuICAgICAgICBjb25zdCBzZWFyY2hFbGUgPSAkKCc8YSBjbGFzcz1cImFwcC1oZWFkZXItYWN0aW9uXCI+PGkgY2xhc3M9XCJ3aSB3aS1zZWFyY2hcIj48L2k+PC9hPicpIGFzIEpRdWVyeTxIVE1MRWxlbWVudD47XG4gICAgICAgICQoZWxlKS5iZWZvcmUoc2VhcmNoRWxlKTtcbiAgICAgICAgLy8gVGFwIGljb24gdG8gc2hvdy9oaWRlIHNlYXJjaCBib3hcbiAgICAgICAgYmluZFRhcEV2dEhhbmRsZXIoc2VhcmNoRWxlLCAoKSA9PiB0b2dnbGVTZWFyY2hDb250YWluZXIoZWxlLCBsZWZ0TmF2RWxlKSk7XG4gICAgfSk7XG5cbn07XG5cbmV4cG9ydCBjb25zdCB1cGRhdGVEZXZpY2VWaWV3ICA9IChlbGVtZW50OiBIVE1MRWxlbWVudCwgaXNUYWJsZXQgPSBmYWxzZSkgPT4ge1xuXG4gICAgY29uc3QgbGVmdE5hdkVsZSA9IGVsZW1lbnQucXVlcnlTZWxlY3Rvcihyb2xlU2VsZWN0b3IoQ0xBU1NfTkFNRS5MRUZUX1BBTkVMKSkgYXMgSFRNTEVsZW1lbnQ7XG4gICAgY29uc3QgcmlnaHROYXZFbGUgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3Iocm9sZVNlbGVjdG9yKENMQVNTX05BTUUuUklHSFRfUEFORUwpKSBhcyBIVE1MRWxlbWVudDtcbiAgICBjb25zdCBoZWFkZXJFbGUgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3Iocm9sZVNlbGVjdG9yKENMQVNTX05BTUUuSEVBREVSKSkgYXMgSFRNTEVsZW1lbnQ7XG4gICAgY29uc3Qgc2VhcmNoRWxlID0gIGhlYWRlckVsZSAmJiBoZWFkZXJFbGUucXVlcnlTZWxlY3RvcihgLiR7Q0xBU1NfTkFNRS5TRUFSQ0h9YCkgYXMgSFRNTEVsZW1lbnQ7XG4gICAgY29uc3QgcGFnZUVsZSA9IGVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7Q0xBU1NfTkFNRS5DT05URU5UfWApIGFzIEhUTUxFbGVtZW50O1xuXG4gICAgYmluZENvbnRlbnRFdmVudHMobGVmdE5hdkVsZSwgcGFnZUVsZSwgc2VhcmNoRWxlLCBpc1RhYmxldCk7XG5cbiAgICBpZiAobGVmdE5hdkVsZSkge1xuICAgICAgICBiaW5kTGVmdFBhbmVsRXZlbnRzKGxlZnROYXZFbGUsIHNlYXJjaEVsZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gcmVtb3ZlIHRoZSBpY29uXG4gICAgICAgICQoaGVhZGVyRWxlKS5maW5kKHJvbGVTZWxlY3RvcihDTEFTU19OQU1FLlNXSVBFX0VMRU0pKS5yZW1vdmUoKTtcbiAgICB9XG5cbiAgICBpZiAocmlnaHROYXZFbGUpIHtcbiAgICAgICAgYmluZFJpZ2h0UGFuZWxFdmVudHMocmlnaHROYXZFbGUpO1xuICAgIH1cblxuICAgIGlmIChzZWFyY2hFbGUpIHtcbiAgICAgICAgYmluZFNlYXJjaEljb25FdmVudChzZWFyY2hFbGUsIGxlZnROYXZFbGUpO1xuICAgIH1cbn07XG4iXX0=