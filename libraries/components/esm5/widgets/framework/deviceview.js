var _this = this;
import { isMobile, setCSS } from '@wm/core';
var CLASS_NAME;
(function (CLASS_NAME) {
    CLASS_NAME["LEFT_PANEL"] = "page-left-panel";
    CLASS_NAME["RIGHT_PANEL"] = "page-right-panel";
    CLASS_NAME["SWIPE_ELEM"] = "page-left-panel-icon";
    CLASS_NAME["CONTENT"] = "app-content-column";
    CLASS_NAME["HEADER"] = "page-header";
    CLASS_NAME["SEARCH"] = "app-search";
})(CLASS_NAME || (CLASS_NAME = {}));
/**
 * method returns jquery class selector for given roleName
 * @param roleName
 * @returns {string}
 */
var roleSelector = function (roleName) { return "[data-role='" + roleName + "']"; };
var ɵ0 = roleSelector;
/*setup touch event handler*/
var bindTapEvtHandler = function (selector, handler) {
    /*
     * In Iphone safari browser, tap event of HammerJs is breaking
     * functionalities of other controls like input[type="range"].
     * So, replaced the hammer Js handler with click event handler.
     */
    $(selector).off('click.deviceview').on('click.deviceview', handler);
};
var ɵ1 = bindTapEvtHandler;
/**
 * hide the mobile toolbar actions
 */
var hidePageContainers = function (leftNavEle, searchEle) {
    if (isMobile()) {
        if (leftNavEle) {
            try {
                leftNavEle.widget.collapse();
            }
            catch (e) {
                //
            }
        }
        if (searchEle) {
            setCSS(searchEle, 'display', 'none');
        }
    }
};
var ɵ2 = hidePageContainers;
/**
 * binds the touch event for content
 */
var bindContentEvents = function (leftNavEle, pageContainer, searchContainer, isTablet) {
    if (isTablet === void 0) { isTablet = false; }
    if (!isTablet) {
        // touch content to hide nav pane and left panel
        bindTapEvtHandler(pageContainer, hidePageContainers.bind(_this, leftNavEle, searchContainer));
    }
};
var ɵ3 = bindContentEvents;
var bindLeftPanelEvents = function (leftNavEle, searchEle) {
    // tap left to show/hide left panel
    bindTapEvtHandler(roleSelector(CLASS_NAME.SWIPE_ELEM), function () {
        if (leftNavEle) {
            leftNavEle.widget.toggle();
            // Hide search container when left panel is open
            if (leftNavEle.classList.contains('visible')) {
                if (searchEle) {
                    setCSS(searchEle, 'display', 'none');
                }
            }
        }
    });
};
var ɵ4 = bindLeftPanelEvents;
/**
 * binds the touch event for content
 */
var bindRightPanelEvents = function (rightNavEle) {
    bindTapEvtHandler(rightNavEle, hidePageContainers);
};
var ɵ5 = bindRightPanelEvents;
/**
 * toggles the search container
 */
var toggleSearchContainer = function (searchEle, leftNavEle) {
    if ($(searchEle).css('display') === 'none') {
        hidePageContainers(leftNavEle);
        setCSS(searchEle, 'display', 'inline-table');
    }
    else {
        hidePageContainers(leftNavEle, searchEle);
    }
};
var ɵ6 = toggleSearchContainer;
/**
 * Bind event with Search icon in header
 */
var bindSearchIconEvent = function (searchElements, leftNavEle) {
    $(searchElements).each(function (index, ele) {
        var searchEle = $('<a class="app-header-action"><i class="wi wi-search"></i></a>');
        $(ele).before(searchEle);
        // Tap icon to show/hide search box
        bindTapEvtHandler(searchEle, function () { return toggleSearchContainer(ele, leftNavEle); });
    });
};
var ɵ7 = bindSearchIconEvent;
export var updateDeviceView = function (element, isTablet) {
    if (isTablet === void 0) { isTablet = false; }
    var leftNavEle = element.querySelector(roleSelector(CLASS_NAME.LEFT_PANEL));
    var rightNavEle = element.querySelector(roleSelector(CLASS_NAME.RIGHT_PANEL));
    var headerEle = element.querySelector(roleSelector(CLASS_NAME.HEADER));
    var searchEle = headerEle && headerEle.querySelector("." + CLASS_NAME.SEARCH);
    var pageEle = element.querySelector("." + CLASS_NAME.CONTENT);
    bindContentEvents(leftNavEle, pageEle, searchEle, isTablet);
    if (leftNavEle) {
        bindLeftPanelEvents(leftNavEle, searchEle);
    }
    else {
        // remove the icon
        $(headerEle).find(roleSelector(CLASS_NAME.SWIPE_ELEM)).remove();
    }
    if (rightNavEle) {
        bindRightPanelEvents(rightNavEle);
    }
    if (searchEle) {
        bindSearchIconEvent(searchEle, leftNavEle);
    }
};
export { ɵ0, ɵ1, ɵ2, ɵ3, ɵ4, ɵ5, ɵ6, ɵ7 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGV2aWNldmlldy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B3bS9jb21wb25lbnRzLyIsInNvdXJjZXMiOlsid2lkZ2V0cy9mcmFtZXdvcmsvZGV2aWNldmlldy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxpQkFxSUE7QUFySUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFJNUMsSUFBSyxVQU9KO0FBUEQsV0FBSyxVQUFVO0lBQ1gsNENBQThCLENBQUE7SUFDOUIsOENBQWdDLENBQUE7SUFDaEMsaURBQW1DLENBQUE7SUFDbkMsNENBQThCLENBQUE7SUFDOUIsb0NBQXNCLENBQUE7SUFDdEIsbUNBQXFCLENBQUE7QUFDekIsQ0FBQyxFQVBJLFVBQVUsS0FBVixVQUFVLFFBT2Q7QUFFRDs7OztHQUlHO0FBQ0gsSUFBTSxZQUFZLEdBQUcsVUFBQyxRQUFnQixJQUFLLE9BQUEsaUJBQWUsUUFBUSxPQUFJLEVBQTNCLENBQTJCLENBQUM7O0FBRXZFLDZCQUE2QjtBQUM3QixJQUFNLGlCQUFpQixHQUFHLFVBQUMsUUFBUSxFQUFFLE9BQU87SUFDeEM7Ozs7T0FJRztJQUNILENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxFQUFFLENBQUMsa0JBQWtCLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDeEUsQ0FBQyxDQUFDOztBQUVGOztHQUVHO0FBQ0gsSUFBTSxrQkFBa0IsR0FBRyxVQUFDLFVBQXVCLEVBQUUsU0FBdUI7SUFDeEUsSUFBSSxRQUFRLEVBQUUsRUFBRTtRQUNaLElBQUksVUFBVSxFQUFFO1lBQ1osSUFBSTtnQkFDQyxVQUFrQixDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsQ0FBQzthQUN6QztZQUFDLE9BQU8sQ0FBQyxFQUFFO2dCQUNSLEVBQUU7YUFDTDtTQUNKO1FBQ0QsSUFBSSxTQUFTLEVBQUU7WUFDWCxNQUFNLENBQUMsU0FBUyxFQUFFLFNBQVMsRUFB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LENBQUMsTUFBUSxDQUFnQixDQUFDO0lBQ2hHLElBQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxhQUFhLENBQUMsTUFBSSxVQUFVLENBQUMsT0FBUyxDQUFnQixDQUFDO0lBRS9FLGlCQUFpQixDQUFDLFVBQVUsRUFBRSxPQUFPLEVBQUUsU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBRTVELElBQUksVUFBVSxFQUFFO1FBQ1osbUJBQW1CLENBQUMsVUFBVSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0tBQzlDO1NBQU07UUFDSCxrQkFBa0I7UUFDbEIsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUM7S0FDbkU7SUFFRCxJQUFJLFdBQVcsRUFBRTtRQUNiLG9CQUFvQixDQUFDLFdBQVcsQ0FBQyxDQUFDO0tBQ3JDO0lBRUQsSUFBSSxTQUFTLEVBQUU7UUFDWCxtQkFBbUIsQ0FBQyxTQUFTLEVBQUUsVUFBVSxDQUFDLENBQUM7S0FDOUM7QUFDTCxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc01vYmlsZSwgc2V0Q1NTIH0gZnJvbSAnQHdtL2NvcmUnO1xuXG5kZWNsYXJlIGNvbnN0ICQ7XG5cbmVudW0gQ0xBU1NfTkFNRSB7XG4gICAgTEVGVF9QQU5FTCA9ICdwYWdlLWxlZnQtcGFuZWwnLFxuICAgIFJJR0hUX1BBTkVMID0gJ3BhZ2UtcmlnaHQtcGFuZWwnLFxuICAgIFNXSVBFX0VMRU0gPSAncGFnZS1sZWZ0LXBhbmVsLWljb24nLFxuICAgIENPTlRFTlQgPSAnYXBwLWNvbnRlbnQtY29sdW1uJyxcbiAgICBIRUFERVIgPSAncGFnZS1oZWFkZXInLFxuICAgIFNFQVJDSCA9ICdhcHAtc2VhcmNoJ1xufVxuXG4vKipcbiAqIG1ldGhvZCByZXR1cm5zIGpxdWVyeSBjbGFzcyBzZWxlY3RvciBmb3IgZ2l2ZW4gcm9sZU5hbWVcbiAqIEBwYXJhbSByb2xlTmFtZVxuICogQHJldHVybnMge3N0cmluZ31cbiAqL1xuY29uc3Qgcm9sZVNlbGVjdG9yID0gKHJvbGVOYW1lOiBzdHJpbmcpID0+IGBbZGF0YS1yb2xlPScke3JvbGVOYW1lfSddYDtcblxuLypzZXR1cCB0b3VjaCBldmVudCBoYW5kbGVyKi9cbmNvbnN0IGJpbmRUYXBFdnRIYW5kbGVyID0gKHNlbGVjdG9yLCBoYW5kbGVyKSA9PiB7XG4gICAgLypcbiAgICAgKiBJbiBJcGhvbmUgc2FmYXJpIGJyb3dzZXIsIHRhcCBldmVudCBvZiBIYW1tZXJKcyBpcyBicmVha2luZ1xuICAgICAqIGZ1bmN0aW9uYWxpdGllcyBvZiBvdGhlciBjb250cm9scyBsaWtlIGlucHV0W3R5cGU9XCJyYW5nZVwiXS5cbiAgICAgKiBTbywgcmVwbGFjZWQgdGhlIGhhbW1lciBKcyBoYW5kbGVyIHdpdGggY2xpY2sgZXZlbnQgaGFuZGxlci5cbiAgICAgKi9cbiAgICAkKHNlbGVjdG9yKS5vZmYoJ2NsaWNrLmRldmljZXZpZXcnKS5vbignY2xpY2suZGV2aWNldmlldycsIGhhbmRsZXIpO1xufTtcblxuLyoqXG4gKiBoaWRlIHRoZSBtb2JpbGUgdG9vbGJhciBhY3Rpb25zXG4gKi9cbmNvbnN0IGhpZGVQYWdlQ29udGFpbmVycyA9IChsZWZ0TmF2RWxlOiBIVE1MRWxlbWVudCwgc2VhcmNoRWxlPzogSFRNTEVsZW1lbnQpID0+IHtcbiAgICBpZiAoaXNNb2JpbGUoKSkge1xuICAgICAgICBpZiAobGVmdE5hdkVsZSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAobGVmdE5hdkVsZSBhcyBhbnkpLndpZGdldC5jb2xsYXBzZSgpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlYXJjaEVsZSkge1xuICAgICAgICAgICAgc2V0Q1NTKHNlYXJjaEVsZSwgJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuLyoqXG4gKiBiaW5kcyB0aGUgdG91Y2ggZXZlbnQgZm9yIGNvbnRlbnRcbiAqL1xuY29uc3QgYmluZENvbnRlbnRFdmVudHMgPSAobGVmdE5hdkVsZTogSFRNTEVsZW1lbnQsIHBhZ2VDb250YWluZXI6IEhUTUxFbGVtZW50LCBzZWFyY2hDb250YWluZXI6IGFueSwgaXNUYWJsZXQgPSBmYWxzZSkgPT4ge1xuICAgIGlmICghaXNUYWJsZXQpIHtcbiAgICAgICAgLy8gdG91Y2ggY29udGVudCB0byBoaWRlIG5hdiBwYW5lIGFuZCBsZWZ0IHBhbmVsXG4gICAgICAgIGJpbmRUYXBFdnRIYW5kbGVyKHBhZ2VDb250YWluZXIsIGhpZGVQYWdlQ29udGFpbmVycy5iaW5kKHRoaXMsIGxlZnROYXZFbGUsIHNlYXJjaENvbnRhaW5lcikpO1xuICAgIH1cbn07XG5cbmNvbnN0IGJpbmRMZWZ0UGFuZWxFdmVudHMgPSAobGVmdE5hdkVsZTogSFRNTEVsZW1lbnQsIHNlYXJjaEVsZTogSFRNTEVsZW1lbnQpID0+IHtcbiAgICAvLyB0YXAgbGVmdCB0byBzaG93L2hpZGUgbGVmdCBwYW5lbFxuICAgIGJpbmRUYXBFdnRIYW5kbGVyKHJvbGVTZWxlY3RvcihDTEFTU19OQU1FLlNXSVBFX0VMRU0pLCAoKSA9PiB7XG4gICAgICAgIGlmIChsZWZ0TmF2RWxlKSB7XG4gICAgICAgICAgICAobGVmdE5hdkVsZSBhcyBhbnkpLndpZGdldC50b2dnbGUoKTtcblxuICAgICAgICAgICAgLy8gSGlkZSBzZWFyY2ggY29udGFpbmVyIHdoZW4gbGVmdCBwYW5lbCBpcyBvcGVuXG4gICAgICAgICAgICBpZiAobGVmdE5hdkVsZS5jbGFzc0xpc3QuY29udGFpbnMoJ3Zpc2libGUnKSkge1xuICAgICAgICAgICAgICAgIGlmIChzZWFyY2hFbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0Q1NTKHNlYXJjaEVsZSwgJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBiaW5kcyB0aGUgdG91Y2ggZXZlbnQgZm9yIGNvbnRlbnRcbiAqL1xuY29uc3QgYmluZFJpZ2h0UGFuZWxFdmVudHMgPSAocmlnaHROYXZFbGU6IEhUTUxFbGVtZW50KSA9PiB7XG4gICAgYmluZFRhcEV2dEhhbmRsZXIocmlnaHROYXZFbGUsIGhpZGVQYWdlQ29udGFpbmVycyk7XG59O1xuXG5cbi8qKlxuICogdG9nZ2xlcyB0aGUgc2VhcmNoIGNvbnRhaW5lclxuICovXG5jb25zdCB0b2dnbGVTZWFyY2hDb250YWluZXIgPSAoc2VhcmNoRWxlOiBIVE1MRWxlbWVudCwgbGVmdE5hdkVsZTogSFRNTEVsZW1lbnQpID0+IHtcbiAgICBpZiAoJChzZWFyY2hFbGUpLmNzcygnZGlzcGxheScpID09PSAnbm9uZScpIHtcbiAgICAgICAgaGlkZVBhZ2VDb250YWluZXJzKGxlZnROYXZFbGUpO1xuICAgICAgICBzZXRDU1Moc2VhcmNoRWxlLCAnZGlzcGxheScsICdpbmxpbmUtdGFibGUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBoaWRlUGFnZUNvbnRhaW5lcnMobGVmdE5hdkVsZSwgc2VhcmNoRWxlKTtcbiAgICB9XG59O1xuXG4vKipcbiAqIEJpbmQgZXZlbnQgd2l0aCBTZWFyY2ggaWNvbiBpbiBoZWFkZXJcbiAqL1xuY29uc3QgYmluZFNlYXJjaEljb25FdmVudCA9IChzZWFyY2hFbGVtZW50cywgbGVmdE5hdkVsZTogSFRNTEVsZW1lbnQpID0+IHtcblxuICAgICQoc2VhcmNoRWxlbWVudHMpLmVhY2goKGluZGV4LCBlbGU6IEhUTUxFbGVtZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IHNlYXJjaEVsZSA9ICQoJzxhIGNsYXNzPVwiYXBwLWhlYWRlci1hY3Rpb25cIj48aSBjbGFzcz1cIndpIHdpLXNlYXJjaFwiPjwvaT48L2E+JykgYXMgSlF1ZXJ5PEhUTUxFbGVtZW50PjtcbiAgICAgICAgJChlbGUpLmJlZm9yZShzZWFyY2hFbGUpO1xuICAgICAgICAvLyBUYXAgaWNvbiB0byBzaG93L2hpZGUgc2VhcmNoIGJveFxuICAgICAgICBiaW5kVGFwRXZ0SGFuZGxlcihzZWFyY2hFbGUsICgpID0+IHRvZ2dsZVNlYXJjaENvbnRhaW5lcihlbGUsIGxlZnROYXZFbGUpKTtcbiAgICB9KTtcblxufTtcblxuZXhwb3J0IGNvbnN0IHVwZGF0ZURldmljZVZpZXcgID0gKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBpc1RhYmxldCA9IGZhbHNlKSA9PiB7XG5cbiAgICBjb25zdCBsZWZ0TmF2RWxlID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKHJvbGVTZWxlY3RvcihDTEFTU19OQU1FLkxFRlRfUEFORUwpKSBhcyBIVE1MRWxlbWVudDtcbiAgICBjb25zdCByaWdodE5hdkVsZSA9IGVsZW1lbnQucXVlcnlTZWxlY3Rvcihyb2xlU2VsZWN0b3IoQ0xBU1NfTkFNRS5SSUdIVF9QQU5FTCkpIGFzIEhUTUxFbGVtZW50O1xuICAgIGNvbnN0IGhlYWRlckVsZSA9IGVsZW1lbnQucXVlcnlTZWxlY3Rvcihyb2xlU2VsZWN0b3IoQ0xBU1NfTkFNRS5IRUFERVIpKSBhcyBIVE1MRWxlbWVudDtcbiAgICBjb25zdCBzZWFyY2hFbGUgPSAgaGVhZGVyRWxlICYmIGhlYWRlckVsZS5xdWVyeVNlbGVjdG9yKGAuJHtDTEFTU19OQU1FLlNFQVJDSH1gKSBhcyBIVE1MRWxlbWVudDtcbiAgICBjb25zdCBwYWdlRWxlID0gZWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtDTEFTU19OQU1FLkNPTlRFTlR9YCkgYXMgSFRNTEVsZW1lbnQ7XG5cbiAgICBiaW5kQ29udGVudEV2ZW50cyhsZWZ0TmF2RWxlLCBwYWdlRWxlLCBzZWFyY2hFbGUsIGlzVGFibGV0KTtcblxuICAgIGlmIChsZWZ0TmF2RWxlKSB7XG4gICAgICAgIGJpbmRMZWZ0UGFuZWxFdmVudHMobGVmdE5hdkVsZSwgc2VhcmNoRWxlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyByZW1vdmUgdGhlIGljb25cbiAgICAgICAgJChoZWFkZXJFbGUpLmZpbmQocm9sZVNlbGVjdG9yKENMQVNTX05BTUUuU1dJUEVfRUxFTSkpLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIGlmIChyaWdodE5hdkVsZSkge1xuICAgICAgICBiaW5kUmlnaHRQYW5lbEV2ZW50cyhyaWdodE5hdkVsZSk7XG4gICAgfVxuXG4gICAgaWYgKHNlYXJjaEVsZSkge1xuICAgICAgICBiaW5kU2VhcmNoSWNvbkV2ZW50KHNlYXJjaEVsZSwgbGVmdE5hdkVsZSk7XG4gICAgfVxufTtcbiJdfQ==