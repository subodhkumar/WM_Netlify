{"version":3,"file":"index.js.map","sources":["ng://@wm/runtime/dynamic/app/components/page-wrapper.component.ts","ng://@wm/runtime/dynamic/app/app.routes.ts","ng://@wm/runtime/dynamic/app/services/app-js-provider.service.ts","ng://@wm/runtime/dynamic/app/services/app-resource-manager.service.ts","ng://@wm/runtime/dynamic/app/services/app-variables-provider.service.ts","ng://@wm/runtime/dynamic/app/services/component-ref-provider.service.ts","ng://@wm/runtime/dynamic/app/services/prefab-config-provider.service.ts","ng://@wm/runtime/dynamic/app/app.module.ts","ng://@wm/runtime/dynamic/main.ts","ng://@wm/runtime/dynamic/index.ts"],"sourcesContent":["import {\n    ApplicationRef,\n    Component,\n    ElementRef,\n    Injector,\n    NgZone,\n    OnDestroy,\n    OnInit,\n    ViewContainerRef,\n    HostListener\n} from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\n\nimport { Subscription } from 'rxjs';\n\nimport { AbstractSpinnerService, App, noop} from '@wm/core';\nimport { MetadataService } from '@wm/variables';\nimport { SecurityService } from '@wm/security';\nimport { AppManagerService, ComponentRefProvider, ComponentType } from '@wm/runtime/base';\n\n@Component({\n    selector: 'app-page-outlet',\n    template: '<div></div>'\n})\nexport class PageWrapperComponent implements OnInit, OnDestroy {\n\n    subscription: Subscription;\n\n    constructor(\n        private injector: Injector,\n        private route: ActivatedRoute,\n        private vcRef: ViewContainerRef,\n        private appRef: ApplicationRef,\n        private metadataService: MetadataService,\n        private securityService: SecurityService,\n        private appManager: AppManagerService,\n        private app: App,\n        private ngZone: NgZone,\n        private elRef: ElementRef,\n        private spinnerService: AbstractSpinnerService,\n        private componentRefProvider: ComponentRefProvider,\n        private router: Router\n    ) {}\n\n    getTargetNode() {\n        return this.elRef.nativeElement;\n    }\n\n    resetViewContainer() {\n        this.vcRef.clear();\n        const $target = this.getTargetNode();\n        $target.innerHTML = '';\n    }\n\n    renderPage(pageName) {\n        const $target = this.getTargetNode();\n\n        this.appManager.loadAppVariables()\n            .then(async () => {\n                const pageComponentFactoryRef = await this.componentRefProvider.getComponentFactoryRef(pageName, ComponentType.PAGE);\n                if (pageComponentFactoryRef) {\n                    const instance = this.vcRef.createComponent(pageComponentFactoryRef, 0, this.injector);\n                    $target.appendChild(instance.location.nativeElement);\n                }\n                if (this.vcRef.length > 1) {\n                    this.vcRef.remove(1);\n                }\n            });\n    }\n\n    renderPrefabPreviewPage() {\n        this.router.navigate(['prefab-preview']);\n    }\n\n    /**\n     * canDeactivate is called before a route change.\n     * This will internally call onBeforePageLeave method present\n     * at page level and app level in the application and decide\n     * whether to change route or not based on return value.\n     */\n    @HostListener('window:beforeunload')\n    canDeactivate() {\n        let retVal;\n        // Calling onBeforePageLeave method present at page level\n        retVal = this.app.activePage && this.app.activePage.onBeforePageLeave();\n        // Calling onBeforePageLeave method present at app level only if page level method return true\n        // or if there is no page level method\n        if (retVal !== false ) {\n            retVal =  (this.app.onBeforePageLeave || noop)(this.app.activePageName, this.app.activePage);\n        }\n        return retVal === undefined ? true : retVal;\n    }\n\n    ngOnInit() {\n        if (this.app.isPrefabType) {\n            // there is only one route\n            this.renderPrefabPreviewPage();\n        } else {\n            $(this.getTargetNode()).find('>div:first').remove();\n            this.subscription = this.route.params.subscribe(({pageName}: any) => {\n                this.ngZone.run(() => {\n                    if (pageName) {\n                        this.renderPage(pageName);\n                    }\n                });\n            });\n        }\n    }\n\n    ngOnDestroy() {\n        this.vcRef.clear();\n        if (this.subscription) {\n            this.subscription.unsubscribe();\n        }\n    }\n}\n","import { AppJSResolve, MetadataResolve } from '@wm/runtime/base';\nimport { SecurityConfigResolve, PrefabPreviewComponent, CanDeactivatePageGuard, EmptyPageComponent } from '@wm/runtime/base';\n\nimport { PageWrapperComponent } from './components/page-wrapper.component';\n\nconst appDependenciesResolve = {\n    securityConfig: SecurityConfigResolve,\n    metadata: MetadataResolve,\n    appJS: AppJSResolve\n};\n\nexport const routes = [\n    {\n        path: '',\n        pathMatch: 'full',\n        resolve: appDependenciesResolve,\n        component: EmptyPageComponent\n    },\n    {\n        path: 'prefab-preview',\n        pathMatch: 'full',\n        resolve: appDependenciesResolve,\n        component: PrefabPreviewComponent\n    },\n    {\n        path: ':pageName',\n        pathMatch: 'full',\n        resolve: appDependenciesResolve,\n        component: PageWrapperComponent,\n        canDeactivate: [CanDeactivatePageGuard]\n    }\n];\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\n\nimport { AppJSProvider } from '@wm/runtime/base';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class AppJSProviderService extends AppJSProvider {\n    constructor(private $http: HttpClient) {\n        super();\n    }\n\n    public getAppScriptFn(): Promise<Function> {\n        return this.$http.get('./app.js', {responseType: 'text'})\n            .toPromise()\n            .then(script => new Function('App', 'Utils', 'Injector', script));\n    }\n}\n","import { Injectable } from '@angular/core';\n\nimport { AbstractHttpService, App } from '@wm/core';\n\nconst cache = new Map<string, string>();\n\n@Injectable()\nexport class AppResourceManagerService {\n\n    get(url: string, useCache?: boolean): string | any {\n        const cachedResponse = cache.get(url);\n\n        if (cachedResponse) {\n            return Promise.resolve(cachedResponse);\n        }\n\n        return this.$http.get(url).then(response => {\n            if (useCache) {\n                cache.set(url, response);\n            }\n            return response;\n        });\n    }\n\n    public clearCache() {\n        cache.clear();\n    }\n\n    constructor(private $http: AbstractHttpService) {}\n}\n","import { Injectable } from '@angular/core';\nimport { AppVariablesProvider } from '@wm/runtime/base';\nimport { AppResourceManagerService } from './app-resource-manager.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class AppVariablesProviderService extends AppVariablesProvider {\n    constructor(private resourceManager: AppResourceManagerService) {\n        super();\n    }\n\n    public async getAppVariables(): Promise<any> {\n        return this.resourceManager.get('./app.variables.json');\n    }\n}\n","import {\n    Compiler,\n    Component,\n    CUSTOM_ELEMENTS_SCHEMA,\n    Injectable,\n    Injector,\n    NgModule,\n    NO_ERRORS_SCHEMA,\n    ViewEncapsulation\n} from '@angular/core';\n\nimport { App, getValidJSON, UserDefinedExecutionContext } from '@wm/core';\nimport { transpile, scopeComponentStyles } from '@wm/transpiler';\nimport {\n    AppManagerService,\n    BasePageComponent,\n    BasePartialComponent,\n    BasePrefabComponent,\n    ComponentRefProvider,\n    ComponentType,\n    RuntimeBaseModule,\n    getPrefabMinJsonUrl\n} from '@wm/runtime/base';\n\nimport { AppResourceManagerService } from './app-resource-manager.service';\n\ninterface IPageMinJSON {\n    markup: string;\n    script: string;\n    styles: string;\n    variables: string;\n    config?: string;\n}\n\ndeclare const window: any;\n\nconst fragmentCache = new Map<string, any>();\n\nwindow.resourceCache = fragmentCache;\n\nconst componentFactoryRefCache = new Map<ComponentType, Map<string, any>>();\n\ncomponentFactoryRefCache.set(ComponentType.PAGE, new Map<string, any>());\ncomponentFactoryRefCache.set(ComponentType.PARTIAL, new Map<string, any>());\ncomponentFactoryRefCache.set(ComponentType.PREFAB, new Map<string, any>());\n\nconst _decodeURIComponent = (str: string) => decodeURIComponent(str.replace(/\\+/g, ' '));\n\nconst getFragmentUrl = (fragmentName: string, type: ComponentType) => {\n    if (type === ComponentType.PAGE || type === ComponentType.PARTIAL) {\n        return `./pages/${fragmentName}/page.min.json`;\n    } else if (type === ComponentType.PREFAB) {\n        return getPrefabMinJsonUrl(fragmentName);\n    }\n};\n\nconst scriptCache = new Map<string, Function>();\nconst execScript = (\n    script: string,\n    identifier: string,\n    ctx: string,\n    instance: any,\n    app: any,\n    utils: any\n) => {\n    let fn = scriptCache.get(identifier);\n    if (!fn) {\n        fn = new Function(ctx, 'App', 'Utils', script);\n        scriptCache.set(identifier, fn);\n    }\n    fn(instance, app, utils);\n};\n\nclass BaseDynamicComponent {\n    init() {}\n}\n\nconst getDynamicModule = (componentRef: any) => {\n    @NgModule({\n        declarations: [componentRef],\n        imports: [\n            RuntimeBaseModule\n        ],\n        schemas: [CUSTOM_ELEMENTS_SCHEMA, NO_ERRORS_SCHEMA]\n    })\n    class DynamicModule {}\n\n    return DynamicModule;\n};\n\nconst getDynamicComponent = (\n    componentName,\n    type: ComponentType,\n    template: string,\n    css: string,\n    script: any,\n    variables: string,\n) => {\n\n    const componentDef = {\n        template,\n        styles: [css],\n        encapsulation: ViewEncapsulation.None\n    };\n\n    let BaseClass: any = BaseDynamicComponent;\n    let selector = '';\n    let context = '';\n\n    switch (type) {\n        case ComponentType.PAGE:\n            BaseClass = BasePageComponent;\n            selector = `app-page-${componentName}`;\n            context = 'Page';\n            break;\n        case ComponentType.PARTIAL:\n            BaseClass = BasePartialComponent;\n            selector = `app-partial-${componentName}`;\n            context = 'Partial';\n            break;\n        case ComponentType.PREFAB:\n            BaseClass = BasePrefabComponent;\n            selector = `app-prefab-${componentName}`;\n            context = 'Prefab';\n            break;\n    }\n\n    @Component({\n        ...componentDef,\n        selector,\n        providers: [\n            {\n                provide: UserDefinedExecutionContext,\n                useExisting: DynamicComponent\n            }\n        ]\n    })\n    class DynamicComponent extends BaseClass {\n        pageName;\n        partialName;\n        prefabName;\n\n        constructor(public injector: Injector) {\n            super();\n\n            switch (type) {\n                case ComponentType.PAGE:\n                    this.pageName = componentName;\n                    break;\n                case ComponentType.PARTIAL:\n                    this.partialName = componentName;\n                    break;\n                case ComponentType.PREFAB:\n                    this.prefabName = componentName;\n                    break;\n            }\n\n            super.init();\n        }\n\n        evalUserScript(instance: any, appContext: any, utils: any) {\n            execScript(script, selector, context, instance, appContext, utils);\n        }\n\n        getVariables() {\n            return JSON.parse(variables);\n        }\n    }\n\n    return DynamicComponent;\n};\n\n@Injectable()\nexport class ComponentRefProviderService extends ComponentRefProvider {\n\n    private loadResourcesOfFragment(componentName, componentType): Promise<IPageMinJSON> {\n        const url = getFragmentUrl(componentName, componentType);\n\n        const resource = fragmentCache.get(url);\n\n        if (resource) {\n            return Promise.resolve(resource);\n        }\n\n        return this.resouceMngr.get(url, true)\n            .then(({markup, script, styles, variables}: IPageMinJSON) => {\n                const response = {\n                    markup: transpile(_decodeURIComponent(markup)),\n                    script: _decodeURIComponent(script),\n                    styles: scopeComponentStyles(componentName, componentType, _decodeURIComponent(styles)),\n                    variables: getValidJSON(_decodeURIComponent(variables))\n                };\n                fragmentCache.set(url, response);\n\n                return response;\n            }, e => {\n                const status = e.details.status;\n                const errorMsgMap = {\n                    404 : this.app.appLocale.MESSAGE_PAGE_NOT_FOUND || 'The page you are trying to reach is not available',\n                    403 : this.app.appLocale.LABEL_ACCESS_DENIED || 'Access Denied'\n                };\n                return Promise.reject(errorMsgMap[status]);\n            });\n    }\n\n    constructor(\n        private resouceMngr: AppResourceManagerService,\n        private app: App,\n        private appManager: AppManagerService,\n        private compiler: Compiler\n    ) {\n        super();\n    }\n\n    public async getComponentFactoryRef(componentName: string, componentType: ComponentType): Promise<any> {\n        // check in the cache.\n        const componentFactoryMap = componentFactoryRefCache.get(componentType);\n        let componentFactoryRef;\n        if (componentFactoryMap) {\n            componentFactoryRef = componentFactoryMap.get(componentName);\n\n            if (componentFactoryRef) {\n                return componentFactoryRef;\n            }\n        }\n\n        return this.loadResourcesOfFragment(componentName, componentType)\n            .then(({markup, script, styles, variables})  => {\n\n                const componentDef = getDynamicComponent(componentName, componentType, markup, styles, script, JSON.stringify(variables));\n                const moduleDef = getDynamicModule(componentDef);\n\n                componentFactoryRef = this.compiler\n                    .compileModuleAndAllComponentsSync(moduleDef)\n                    .componentFactories\n                    .filter(factory => factory.componentType === componentDef)[0];\n\n                componentFactoryRefCache.get(componentType).set(componentName, componentFactoryRef);\n\n                return componentFactoryRef;\n            }, (err) => {\n                if (err) {\n                    this.appManager.notifyApp(\n                        err,\n                        'error'\n                    );\n                }\n            });\n    }\n\n    // clears the cache map\n    public clearComponentFactoryRefCache() {\n        this.resouceMngr.clearCache();\n        fragmentCache.clear();\n        componentFactoryRefCache.forEach(map => {\n            map.clear();\n        });\n    }\n}\n","import { Injectable } from '@angular/core';\n\nimport { getPrefabConfigUrl, PrefabConfigProvider } from '@wm/runtime/base';\n\nimport { AppResourceManagerService } from './app-resource-manager.service';\n\nconst cache = new Map<string, any>();\n@Injectable()\nexport class PrefabConfigProviderService extends PrefabConfigProvider {\n\n    constructor(private resourceMngr: AppResourceManagerService) {\n        super();\n    }\n\n    public getConfig(prefabName: string): Promise<any> {\n        const config = cache.get(prefabName);\n        if (config) {\n            return Promise.resolve(config);\n        }\n\n        return this.resourceMngr.get(getPrefabConfigUrl(prefabName))\n            .then(_config => {\n                cache.set(prefabName, _config);\n                return _config;\n            });\n    }\n}\n","import { Injector, NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport { HttpClientModule, HttpClientXsrfModule } from '@angular/common/http';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\n\nimport { ToastrModule } from 'ngx-toastr';\n\nimport { App, getWmProjectProperties } from '@wm/core';\n\nimport {\n    AppComponent,\n    AppJSProvider,\n    AppVariablesProvider,\n    ComponentRefProvider,\n    PrefabConfigProvider,\n    WM_MODULES_FOR_ROOT,\n    PartialRefProvider\n} from '@wm/runtime/base';\n\nimport { routes } from './app.routes';\nimport { PageWrapperComponent } from './components/page-wrapper.component';\nimport { AppJSProviderService } from './services/app-js-provider.service';\nimport { AppVariablesProviderService } from './services/app-variables-provider.service';\nimport { ComponentRefProviderService } from './services/component-ref-provider.service';\nimport { PrefabConfigProviderService } from './services/prefab-config-provider.service';\nimport { AppResourceManagerService } from './services/app-resource-manager.service';\n\nexport const routerModule = RouterModule.forRoot(routes, {useHash: true, scrollPositionRestoration: 'top'});\nexport const toastrModule = ToastrModule.forRoot({maxOpened: 1, autoDismiss: true });\nexport const httpClientXsrfModule = HttpClientXsrfModule.withOptions({\n    cookieName: 'wm_xsrf_token',\n    headerName: getWmProjectProperties().xsrf_header_name\n});\n\n@NgModule({\n    declarations: [\n        PageWrapperComponent\n    ],\n    imports: [\n        BrowserModule,\n        CommonModule,\n        RouterModule,\n        HttpClientModule,\n        BrowserAnimationsModule,\n\n        routerModule,\n        toastrModule,\n        httpClientXsrfModule,\n\n        WM_MODULES_FOR_ROOT\n    ],\n    providers: [\n        AppResourceManagerService,\n        {provide: AppJSProvider, useClass: AppJSProviderService},\n        {provide: AppVariablesProvider, useClass: AppVariablesProviderService},\n        {provide: ComponentRefProvider, useClass: ComponentRefProviderService},\n        {provide: PartialRefProvider, useClass: ComponentRefProviderService},\n        {provide: PrefabConfigProvider, useClass: PrefabConfigProviderService}\n    ],\n    bootstrap: [AppComponent]\n})\nexport class AppModule {\n    constructor(private app: App, private inj: Injector, private componentRefProvider: ComponentRefProvider) {\n        if (window['cordova']) {\n            // clear the cached urls on logout, to load the Login Page and not the Main Page as app reload(window.location.reload) is not invoked in mobile\n            this.app.subscribe('userLoggedOut', this.componentRefProvider.clearComponentFactoryRefCache.bind(this.componentRefProvider));\n        }\n    }\n}\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\n\ndeclare const _;\nconst DEBUG_MODE = 'debugMode';\n\nif (sessionStorage.getItem(DEBUG_MODE) !== 'true') {\n    enableProdMode();\n}\n\nconsole.time('bootstrap');\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    new Promise( resolve => {\n        if (window['cordova']) {\n            document.addEventListener('deviceready', resolve);\n        } else {\n            resolve();\n        }\n    }).then(() => platformBrowserDynamic().bootstrapModule(AppModule))\n        .then(() => console.timeEnd('bootstrap'), err => console.log(err));\n});\n\n(window as any).debugMode = function(on) {\n    if (_.isEmpty(on)) {\n        on = true;\n    }\n    const value = on ? 'true' : 'false';\n    if (sessionStorage.getItem(DEBUG_MODE) !== value) {\n        sessionStorage.setItem(DEBUG_MODE, value);\n        window.location.reload();\n    }\n};\n\nexport default () => {};\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n\nexport {routes as Éµa} from './app/app.routes';\nexport {PageWrapperComponent as Éµb} from './app/components/page-wrapper.component';\nexport {AppJSProviderService as Éµd} from './app/services/app-js-provider.service';\nexport {AppResourceManagerService as Éµc} from './app/services/app-resource-manager.service';\nexport {AppVariablesProviderService as Éµe} from './app/services/app-variables-provider.service';\nexport {ComponentRefProviderService as Éµf} from './app/services/component-ref-provider.service';\nexport {PrefabConfigProviderService as Éµg} from './app/services/prefab-config-provider.service';"],"names":["cache"],"mappings":"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"}
