{"version":3,"file":"index.js.map","sources":["ng://@wm/oAuth/oAuth.utils.ts","ng://@wm/oAuth/oAuth.service.ts","ng://@wm/oAuth/oAuth.module.ts","ng://@wm/oAuth/index.ts"],"sourcesContent":["import { _WM_APP_PROJECT, hasCordova, isIE } from '@wm/core';\n\ndeclare const moment, _;\n\nconst accessTokenSuffix = '.access_token';\nconst isWaveLens = false;\n\nexport const parseConfig = (serviceParams: any): any => {\n\n    let val, param, config;\n    const urlParams = serviceParams.urlParams;\n\n    config = {\n        url: 'services/oauth2/:providerId/authorizationUrl',\n        method: 'GET'\n    };\n\n    /*To handle dynamic urls, append the serviceParams.config.url with the static url(i.e., config.url)*/\n    if (serviceParams.config) {\n        config.url = (serviceParams.config.url || '') + config.url;\n        config.method = serviceParams.config.method || config.method;\n        config.headers = config.headers || {};\n\n        // TODO[Shubham] - change to for - of\n        for (const key in serviceParams.config.headers) {\n            val = serviceParams.config.headers[key];\n            config.headers[key] = val;\n        }\n    }\n    /* check for url parameters to replace the url */\n    if (urlParams) {\n        for (param in urlParams) {\n            if (urlParams.hasOwnProperty(param)) {\n                val = urlParams[param];\n                if (!_.isUndefined(val) && val !== null) {\n                    config.url = config.url.replace(new RegExp(':' + param, 'g'), val);\n                }\n            }\n        }\n    }\n\n    /* check for data */\n    if (serviceParams.params) {\n        config.params = serviceParams.params;\n    }\n    /* check for data */\n    if (!_.isUndefined(serviceParams.data)) {\n        config.data = serviceParams.data;\n    }\n    /* check for data parameters, written to support old service calls (.json calls) */\n    if (serviceParams.dataParams) {\n        config.data.params = serviceParams.dataParams;\n    }\n    /* check for headers */\n    if (serviceParams.headers) {\n        config.headers = serviceParams.headers;\n    }\n\n    /* set extra config flags */\n    config.byPassResult    = serviceParams.byPassResult;\n    config.isDirectCall    = serviceParams.isDirectCall;\n    config.isExtURL        = serviceParams.isExtURL;\n    config.preventMultiple = serviceParams.preventMultiple;\n    config.responseType    = serviceParams.responseType;\n\n    return config;\n};\n\nconst listeners = {},\n    ACCESSTOKEN_PLACEHOLDERS = {\n        'STUDIO': 'WM_STUDIO_',\n        'RUN': 'WM_RUN_'\n    },\n    newWindowProps = 'width=400,height=600';\n\n/**\n * This function remove the accessToken for a provider\n * @param provider\n */\nexport const removeAccessToken = (provider) => {\n    const accessTokenKey = getAccessTokenPlaceholder(provider);\n    sessionStorage.removeItem(accessTokenKey);\n};\n\n/**\n * This function returns the accesstoken placeholder based on the studio or run mode for the project\n * @param provider\n * @returns {*}\n */\nfunction getAccessTokenPlaceholder(provider) {\n    let accessTokenKey;\n    accessTokenKey = ACCESSTOKEN_PLACEHOLDERS.RUN + _WM_APP_PROJECT.id + '_' + provider + accessTokenSuffix;\n    return accessTokenKey;\n}\n\n/**\n * This function performs the fake local storage update, so the IE gets the latest token instead of returning the cached localStorageValue\n */\nfunction performFakeLocalStorageUpdate() {\n    const dummy_key = 'dummy_key';\n    localStorage.setItem(dummy_key, dummy_key);\n    localStorage.removeItem(dummy_key);\n}\n\n/**\n * This function sets the accessToken\n * @param provider\n * @param accesstoken\n */\nfunction setAccessToken(provider, accesstoken) {\n    const accessTokenKey = getAccessTokenPlaceholder(provider);\n    sessionStorage.setItem(accessTokenKey, accesstoken);\n}\n\n/**\n * this is a callback function to check if the authentication is done and invokes the successCallback\n * @param providerId\n * @param successCallback\n * @param evt\n */\nfunction checkAuthenticationStatus(providerId, successCallback, removeProviderConfigCallBack, evt) {\n    const accessTokenKey = providerId + accessTokenSuffix,\n        accessToken = localStorage.getItem(accessTokenKey);\n    if (evt && evt.origin !== window.location.origin) {\n        return;\n    }\n    if (accessToken) {\n        removeProviderConfigCallBack(providerId);\n        localStorage.removeItem(accessTokenKey);\n        setAccessToken(providerId, accessToken);\n        window.removeEventListener('message', listeners[providerId]);\n        setTimeout(() => {\n            delete listeners[providerId];\n            if (successCallback) {\n                successCallback(accessToken);\n            }\n        });\n    }\n}\n\n/**\n * this function keeps on checking the accesstoken in the LocalStorage and updates it accordingly\n * @param providerId\n * @param onSuccess\n * @param onError\n * @param startTime\n * @param loginObj\n */\nfunction checkAccessTokenInWindow(providerId, onSuccess, onError, startTime, loginObj, removeProviderConfigCallBack) {\n    performFakeLocalStorageUpdate();\n    const currentTime = moment.duration(moment().format('HH:mm'), 'HH:mm'),\n        timeDiff = currentTime.subtract(startTime),\n        accessToken = getAccessToken(providerId, true);\n    if (accessToken) {\n        loginObj.accesstoken_retrieved = true;\n        setAccessToken(providerId, accessToken);\n        localStorage.removeItem(providerId + accessTokenSuffix);\n        removeProviderConfigCallBack(providerId);\n        if (onSuccess) {\n            onSuccess();\n        }\n    } else if (timeDiff.minutes() > 1 && onSuccess && !loginObj.accesstoken_retrieved) {\n        onSuccess('error');\n    } else {\n        setTimeout(() => {\n            checkAccessTokenInWindow(providerId, onSuccess, onError, startTime, loginObj, removeProviderConfigCallBack);\n        }, 3000);\n    }\n}\n\n/**\n * checks for the window existence i.e if the window is manually closed by the user or any such\n * @param oAuthWindow\n * @param provider\n * @param callback\n */\nfunction checkForWindowExistence(oAuthWindow, provider, callback) {\n    if (oAuthWindow && listeners[provider]) {\n        if (!oAuthWindow.closed) { // .closed is supported across major browser vendors however for IE the user has to enable protected mode from security options\n            setTimeout(checkForWindowExistence.bind(undefined, oAuthWindow, provider, callback), 3000);\n        } else {\n            window.removeEventListener('message', listeners[provider]);\n            delete listeners[provider];\n            if (callback) {\n                callback('error');\n            }\n        }\n    }\n}\n/**\n * this functions handles the logic related to the window operations in IE\n * @param url\n * @param providerId\n * @param onSuccess\n * @param onError\n */\nfunction handleLoginForIE(url, providerId, onSuccess, onError, removeProviderConfigCallBack) {\n    const loginObj = {\n        'accesstoken_retrieved': false\n    };\n    window.open(url, '_blank', newWindowProps);\n    checkAccessTokenInWindow(providerId, onSuccess, onError, moment.duration(moment().format('HH:mm'), 'HH:mm'), loginObj, removeProviderConfigCallBack);\n}\n\n/**\n * this function adds the listener on the window and assigns the listener\n * @param provider\n * @param callback\n */\nfunction onAuthWindowOpen(provider, callback, removeProviderConfigCallBack) {\n    listeners[provider] = checkAuthenticationStatus.bind(undefined, provider, callback, removeProviderConfigCallBack);\n    window.addEventListener('message', listeners[provider], false);\n}\n\n/**\n * this function is a callback function which enables the listener and checks for the window existence\n * @param providerId\n * @param onSuccess\n * @param url\n */\nfunction postGetAuthorizationURL(url, providerId, onSuccess, removeProviderConfigCallBack) {\n    let oAuthWindow;\n\n     if (hasCordova()) {\n         window.open(url, '_system');\n         window['OAuthInMobile'](providerId).then(accessToken => {\n             const key = providerId + accessTokenSuffix;\n             if (accessToken) {\n                 localStorage.setItem(key, accessToken);\n                 checkAuthenticationStatus(providerId, onSuccess, removeProviderConfigCallBack, null);\n             } else {\n                 onSuccess('error');\n             }\n         });\n     } else {\n         oAuthWindow = window.open(url, '_blank', newWindowProps);\n         onAuthWindowOpen(providerId, onSuccess, removeProviderConfigCallBack);\n         checkForWindowExistence(oAuthWindow, providerId, onSuccess);\n     }\n}\n\n/**\n * function to get the authorization url\n * @param params provider id for which the auth url has to be fetched\n * @param successCallback callback to be invoked upon successful fetch of the providers\n * @param failureCallback callback to be invoked upon error\n * @returns {*}\n */\nfunction getAuthorizationUrl(params, http) {\n    const action = 'getAuthorizationUrl',\n        serviceSettings = parseConfig({\n            target: 'oauthConfiguration',\n            action: action,\n            urlParams: {\n                projectId: _WM_APP_PROJECT.id,\n                providerId: params.providerId\n            },\n            params: {\n                'requestSourceType': params.requestSourceType\n            }\n        });\n    return http.send(serviceSettings);\n}\n\n/**\n * this function retrieves the accessToken based on the run/studiomode\n * @param provider\n * @returns {*}\n */\nexport const getAccessToken = (provider, checkLocalStorage) => {\n    const accessTokenKey = getAccessTokenPlaceholder(provider);\n    if (checkLocalStorage) {\n        return localStorage.getItem(provider + accessTokenSuffix);\n    }\n    return sessionStorage.getItem(accessTokenKey);\n};\n\n\n/**\n * this function is used to perform the authorization by opening the window and having active listeners\n * @param url\n * @param providerId\n * @param onSuccess\n * @returns {*}\n */\nexport const performAuthorization = (url, providerId, onSuccess, onError, http, addProviderConfigCallBack, removeProviderConfigCallBack) => {\n    let requestSourceType = 'WEB';\n    if (url) {\n        if (isIE()) { // handling for IE\n            handleLoginForIE(url, providerId, onSuccess, onError, removeProviderConfigCallBack);\n        } else {\n            postGetAuthorizationURL(url, providerId, onSuccess, removeProviderConfigCallBack);\n        }\n    } else {\n        if (isWaveLens) {\n            requestSourceType = 'WAVELENS';\n        } else if (hasCordova()) {\n            requestSourceType = 'MOBILE';\n        }\n        return getAuthorizationUrl({\n            'providerId': providerId,\n            'requestSourceType': requestSourceType\n        }, http).then((response) => {\n            addProviderConfigCallBack({\n                name: providerId,\n                url: response.body,\n                invoke: () => {\n                    if (isIE()) { // handling for IE\n                        handleLoginForIE(response, providerId, onSuccess, onError, removeProviderConfigCallBack);\n                    } else {\n                        postGetAuthorizationURL(response.body, providerId, onSuccess, removeProviderConfigCallBack);\n                    }\n                }\n            });\n        });\n    }\n};\n","import { Injectable } from '@angular/core';\n\nimport { Observable, Subject } from 'rxjs';\n\nimport { AbstractHttpService } from '@wm/core';\n\nimport { getAccessToken, performAuthorization, removeAccessToken } from './oAuth.utils';\n\ndeclare const _;\n\n@Injectable()\nexport class OAuthService {\n    constructor(private httpService: AbstractHttpService) {}\n\n    providers = new Subject();\n\n    providersConfig = [];\n\n    getOAuthProvidersAsObservable(): Observable<any> {\n        return this.providers.asObservable();\n    }\n\n    addProviderConfig(provider) {\n        if (!(_.find(this.providersConfig, {'name' : provider.name}))) {\n            this.providersConfig.push(provider);\n        }\n        this.providers.next(this.providersConfig);\n    }\n\n    removeProviderConfig(providerId) {\n        _.remove(this.providersConfig, provider => provider.name === providerId);\n        this.providers.next(this.providersConfig);\n    }\n\n    perfromOAuthorization(url, providerId, onSuccess, onError) {\n        performAuthorization(url, providerId, onSuccess, onError, this.httpService, this.addProviderConfig.bind(this), this.removeProviderConfig.bind(this));\n    }\n\n    getAccessToken(provider, checkLocalStorage) {\n        return getAccessToken(provider, checkLocalStorage);\n    }\n\n    removeAccessToken(provider) {\n        removeAccessToken(provider);\n    }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\n\nimport { OAuthService } from './oAuth.service';\n\n@NgModule({})\nexport class OAuthModule {\n\n    static forRoot(): ModuleWithProviders {\n        return {\n            ngModule: OAuthModule,\n            providers: [OAuthService]\n        };\n    }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}
