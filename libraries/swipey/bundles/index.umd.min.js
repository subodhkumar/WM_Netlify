!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define("@wm/swipey",["exports"],n):n(t.swipey={})}(this,function(t){"use strict";window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimaitonFrame||function(t){window.setTimeout(t,1e3/60)},function(p){var l,h,a={NONE:0,HORIZONTAL:1,LEFT_TO_RIGHT:2,RIGHT_TO_LEFT:3,VERTICAL:4,TOP_TO_DOWN:5,DOWN_TO_TOP:6},f=Math.abs,s=Math.max,u=p('<div style="background-color:rgba(0, 0, 0, 0);position: fixed; top: 0;width:100vw; height: 100vh;z-index: 100000;"></div>'),c=[],d=[],t=function(e){p.each(c,function(t,n){return n(e)})},n=function(e){p.each(d,function(t,n){return n(e)}),c.length=0,d.length=0};function e(t,n,e){(t.__zone_symbol__addEventListener||t.addEventListener).call(t,n,e)}function o(t,e,i){var o=function(t){for(var n=e;n;)t.push({$ele:p(n),last:{scrollLeft:n.iscroll?n.iscroll.x:n.scrollLeft,scrollTop:n.iscroll?n.iscroll.y:n.scrollTop}}),n=n.parentElement;return t}([]);this.hasSrcolled=function(){return i===p.fn.swipey.DIRECTIONS.VERTICAL?function n(){var t;return p.each(o,function(){this.$ele[0].iscroll?isNaN(this.$ele[0].iscroll.y)||0===this.$ele[0].iscroll.y||(t=!0):0!==this.$ele[0].scrollTop&&(t=!0)}),t}():i===p.fn.swipey.DIRECTIONS.HORIZONTAL?function e(){var t;return p.each(o,function(){this.$ele[0].iscroll?isNaN(this.$ele[0].iscroll.x)||0===this.$ele[0].iscroll.x||(t=!0):0!==this.$ele[0].scrollLeft&&(t=!0)}),t}():void 0}}function w(t){return t.originalEvent&&t.originalEvent.touches&&t.originalEvent.touches[0]||t&&t.touches&&t.touches[0]||t}function g(t,n,e){var i,o,r=0;return e===a.HORIZONTAL?r=n.x-t.x:e===a.LEFT_TO_RIGHT?r=s(n.x-t.x,0):e===a.RIGHT_TO_LEFT?r=s(t.x-n.x,0):e===a.VERTICAL?r=n.y-t.y:e===a.TOP_TO_DOWN?r=s(n.y-t.y,0):e===a.DOWN_TO_TOP?r=s(t.y-n.y,0):(i=n.x-t.x,o=n.y-t.y,r=s(f(i),f(o)),(i<0&&f(i)===r||o<0&&f(o)===r)&&(r=-r)),r}function b(t,n){var e=w(t);e&&n.data.path.push({x:e.pageX,y:e.pageY}),h.push(function(){l.onSwipeEnd(t,n.data),n.onSwipeEnd.call(n.target,t,n.data)}),h.process()}function r(t,n){var e,i,o=w(t),r=n.data.path[0],a={x:o.pageX,y:o.pageY};return i=g(r,a,n.direction),n.data.length=i<0?-1:1,n.lastDistance=n.data.length,n.data.path=[a],n.data.totalLength=f(n.data.length),n.data.startTime=Date.now(),!1!==n.onSwipeStart.call(n.target,t,n.data)&&(u.appendTo(p("body")),e=function(t){u.remove(),b(t,n)},(c=[]).push(function(t){!function d(n,e){var t,i,o=w(n),r=e.data.path[0],a={x:o.pageX,y:o.pageY},s=g(r,a,e.direction),u=[];if(e.renderInProgress=!1,s!==e.lastDistance){t=30*(s<e.lastDistance?-1:1),i=s-e.lastDistance;for(var c=t;0<t&&c<=i||t<0&&i<=c;c+=t)u.push(c+e.lastDistance);i%t!=0&&u.push(i%f(t)+(0===u.length?e.lastDistance:u[u.length-1])),e.lastDistance=s,p.each(u,function(){var t=this;h.push(function(){e.data.length=t,e.data.totalLength+=f(t),e.data.velocity=f(e.data.totalLength/(Date.now()-e.data.startTime)),e.data.path.push(a),!1===e.onSwipe.call(e.target,n,e.data)&&b(n,e),l.onSwipe(n,e.data)})}),h.process()}}(t,n)}),(d=[]).push(e),l.onSwipeStart(t,n.data),!0)}function m(t,n){var e=n.data.path[0],i={x:t.pageX,y:t.pageY},o=g(e,i,n.direction);return f(o)>n.threshold&&function r(t,n,e){if(e===a.HORIZONTAL){if(Math.abs((n.y-t.y)/(n.x-t.x))<=.36397023426)return!0}else if(e===a.VERTICAL&&2.74747741945<=Math.abs((n.y-t.y)/(n.x-t.x)))return!0;return!1}(e,i,n.direction)}function i(e){var t=e.bindEvents,n="";_.includes(t,"touch")?n+=" touchstart":_.includes(t,"mouse")&&(n+=" mousedown"),n&&e.target.on(n,function(t){var n=w(t);n&&function i(t,n){var e;n.scrollObserver=new o(event.currentTarget,event.target,n.direction),e=function(t){if(m(w(t),n)&&(n.scrollObserver.hasSrcolled()||r(t,n)))return!1},c.push(e),n.data={path:[{x:t.pageX,y:t.pageY}]}}(n,e)})}e(document,"mousemove",t),e(document,"touchmove",t),e(document,"mouseup",n),e(document,"touchcancel",n),e(document,"touchend",n),h=new function v(){var n=[],e=!1;function i(){if(0<n.length){try{n.shift()()}catch(t){console.error("Function invocation failed",t)}window.requestAnimationFrame(i)}else e=!1}this.push=function(t){n.push(t)},this.process=function(){e||(e=!0,i())}},p.fn.swipey=function(t){return this.each(function(){i(p.extend({direction:a.NONE,target:p(this),bindEvents:["touch","mouse"],swipeTarget:document,threshold:30,onSwipeStart:p.noop,onSwipe:p.noop,onSwipeEnd:p.noop},t))}),this},l={onSwipeStart:function(t,n){p.fn.swipey.trace&&(p("body").append('<svg height="100vh" width="100vw"    style="position : fixed;top: 0;left: 0; width:100vw; height: 100vh; z-index:10000" id ="canvas">       <path stroke="rgba(0, 0, 0, 0.5)" stroke-linecap="round" stroke-width="20" fill-opacity="0"            stroke-opacity="0.8" d="M'+n.path[0].x+" "+n.path[0].y+' " />   </svg>'),n.tracer={pathd:p("#canvas path")})},onSwipe:function(t,n){if(n.tracer){var e=n.tracer.pathd.attr("d"),i=n.path[n.path.length-1];n.tracer.pathd.attr("d",e+" L"+i.x+" "+i.y+" ")}},onSwipeEnd:function(t,n){if(n.tracer){var e=n.path[0],i=[e,{y:e.y-50},{x:e.x+50},{y:e.y+50}],o=0;_.forEach(n.path,function(t){var n;o!==i.length&&(!(n=i[o]).x||n.x<=t.x)&&(!n.y||n.y<=t.y)&&o++}),setTimeout(function(){p("body >#canvas").remove()},500)}}},p.fn.swipey.DIRECTIONS=a}(jQuery),function(c){var a,s=/\$\{\{[a-zA-Z\+-/%\.\*\s\(\)\d,\\'"\$_]*\}\}/;function e(t){var n,e=[];if(a=a||function r(){return c.fn.swipeAnimation.expressionEvaluator?c.fn.swipeAnimation.expressionEvaluator:window.exprEval&&window.exprEval.Parser?function(t){var n=(new window.exprEval.Parser).parse(t);return function(t){return n.evaluate(t)}}:void 0}(),_.isFunction(t))return t;if(a){for(;null!==(n=s.exec(t));){var i=n[0],o=t.substring(0,n.index);t=t.substring(n.index+i.length),i=i.substring(3,i.length-2),e.push(o),e.push(a(i).bind({}))}return e.push(t),function(){var n=arguments;return _.map(e,function(t){return _.isFunction(t)?t.apply(undefined,n):t}).join("")}}}function d(t,n,e){return _.isFunction(t)?t.apply(n,e):t}function p(t,n,e){var i=0,o=d(n.bounds,t,e);return _.isUndefined(o.center)||(i=o.center),_.isUndefined(o.lower)||(o.lower=o.lower+i),_.isUndefined(o.upper)||(o.upper=o.upper+i),o}function l(t){_.forEach(t.animation,function(t){(_.isFunction(t.target)||t.targetFn)&&(t.targetFn=_.isUndefined(t.targetFn)?t.target:t.targetFn,t.target=t.targetFn())})}function h(){this.setSettings=function(t,n){n.data("swipeAnimationDefaults",t)},this.getSettings=function(t){return t.data("swipeAnimationDefaults")}}function f(t,e,i,n,o,r){_.forEach(t.animation,function(n){n.target&&(1<n.target.length?n.target.each(function(t){e.$i=t,c(this).css(_.mapValues(n.css,function(t,n){return t(e)}))}):(e.$i=0,n.target.css(_.mapValues(n.css,function(t,n){return t(e)}))),n.target.css({transition:"all ease-out "+i+"ms"}),n.target.one("webkitTransitionEnd transitionend",function(){n.target.css({transition:""})}))}),setTimeout(function(){window.requestAnimationFrame(function(){e.$D===e.bounds.lower?t.onLower.call(n):e.$D===e.bounds.upper&&t.onUpper.call(n),t.onAnimation(r,o)})},i)}var n={gotoUpper:function(){i(this,"upper",arguments[1])},gotoLower:function(t){i(this,"lower",arguments[1])}};function i(t,n,e){var i,o=(new h).getSettings(t),r={},a=p(t,o);l(o),e=e||300,i=d(o.context,t),(r=_.extend({},i)).$d=0,r.$D="lower"===n?a.lower:a.upper,r.bounds=a,f(o,r,e,t)}function o(a,s){var u={$D:0},i={max:Math.max,min:Math.min,abs:Math.abs};if(!_.isArray(s.animation)){var t=s.animation.target||a,n=s.animation.css||s.animation;delete n[a],s.animation=[{target:t,css:n}]}_.forEach(s.animation,function(t){t.css=_.mapValues(t.css,function(t,n){return e(t)})}),(new h).setSettings(s,a),a.swipey({direction:s.direction,threshold:s.threshold,bindEvents:s.bindEvents,target:s.target,onSwipeStart:function(t,n){var e;if(u.$d=0,u.bounds=p(this,s,[t,n.length]),_.isUndefined(u.bounds.center)?u.$D=0:u.$D=u.bounds.center,e=u.$D+n.length,u.bounds.strictLower=!(!1===u.bounds.strict||!1===u.bounds.strictLower),u.bounds.strictUpper=!(!1===u.bounds.strict||!1===u.bounds.strictUpper),!s.enableGestures()||u.bounds.strictLower&&(_.isUndefined(u.bounds.lower)&&n.length<0||!_.isUndefined(u.bounds.lower)&&u.bounds.lower>e)||u.bounds.strictUpper&&(_.isUndefined(u.bounds.upper)&&0<n.length||!_.isUndefined(u.bounds.upper)&&u.bounds.upper<e))return!1;u.vc=function r(){var e=0,i=0,o=0;return{addDistance:function(t){var n=Date.now();return 10<Math.abs(t-e)&&n!==i&&(o=(t-e)/(n-i),e=t,i=n),o=o<0?Math.min(o,-1):Math.max(o,1),this},getVelocity:function(){return o},getTime:function(t){return Math.abs(t/o)}}}(),u.context=_.extend(i,d(s.context,a)),u.localState=_.extend({},u.context),l(s),_.forEach(s.animation,function(t){t.target&&t.target.css({transition:"none"})})},onSwipe:function(t,n){var e=u.localState,i=u.$D+n.length;e.$d=n.length,e.$D=u.$D,u.bounds.strictLower&&!_.isUndefined(u.bounds.lower)&&u.bounds.lower>i?e.$d=u.bounds.lower-u.$D:u.bounds.strictUpper&&!_.isUndefined(u.bounds.upper)&&u.bounds.upper<i&&(e.$d=u.bounds.upper-u.$D),u.vc.addDistance(n.length),_.forEach(s.animation,function(n){n.target&&(1<n.target.length?n.target.each(function(t){e.$i=t,c(this).css(_.mapValues(n.css,function(t,n){return t(e)}))}):(e.$i=0,n.target.css(_.mapValues(n.css,function(t,n){return t(e)}))))})},onSwipeEnd:function(t,n){var e,i=u.localState,o=u.$D+n.length,r=u.vc.getVelocity();i.$d=n.length,i.$D=u.$D,!_.isUndefined(u.bounds.lower)&&r<=0&&u.$D>o?i.$D=u.bounds.lower:!_.isUndefined(u.bounds.upper)&&0<=r&&u.$D<o&&(i.$D=u.bounds.upper),i.$d=0,i.bounds=u.bounds,u.$D=i.$D,e=u.vc.getTime(i.$D-o),f(s,i,e,a,o,t)}})}c.fn.swipeAnimation=function(t){return n[t]?n[t].apply(this,arguments):(this.each(function(){o(c(this),c.extend({direction:c.fn.swipey.DIRECTIONS.HORIZONTAL,target:c(this),threshold:30,enableGestures:function(){return!0},bindEvents:["touch"],bounds:{},context:{},animation:{},onLower:c.noop,onUpper:c.noop,onAnimation:c.noop},t))}),this)}}(jQuery);var n=function(){function t(){this._isGesturesEnabled=!0}return t.prototype.bindEvents=function(){return["touch"]},t.prototype.bounds=function(t,n){return{}},t.prototype.context=function(){return{}},t.prototype.direction=function(){return $.fn.swipey.DIRECTIONS.HORIZONTAL},t.prototype.setGesturesEnabled=function(t){this._isGesturesEnabled=t},t.prototype.isGesturesEnabled=function(){return this._isGesturesEnabled},t.prototype.goToLower=function(t){this._$ele.swipeAnimation("gotoLower",t)},t.prototype.goToUpper=function(t){this._$ele.swipeAnimation("gotoUpper",t)},t.prototype.onAnimation=function(t,n){},t.prototype.onUpper=function(){},t.prototype.onLower=function(){},t.prototype.threshold=function(){return 30},t.prototype.init=function(t,n){(this._$ele=t).swipeAnimation({animation:this.animation(),target:n,bounds:this.bounds.bind(this),bindEvents:this.bindEvents(),context:this.context.bind(this),direction:this.direction(),enableGestures:this.isGesturesEnabled.bind(this),onAnimation:this.onAnimation.bind(this),onLower:this.onLower.bind(this),onUpper:this.onUpper.bind(this),threshold:this.threshold()})},t}();t.SwipeAnimation=n,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.min.js.map