import { isNumberType, FormWidgetType, DataType, isMobileApp, isAndroid } from '@wm/core';
var VIEW_MODE_OPTIONS = {
    DEFAULT: 'default',
    LABEL: 'label'
};
export var EDIT_MODE = {
    QUICK_EDIT: 'quickedit',
    INLINE: 'inline',
    FORM: 'form',
    DIALOG: 'dialog'
};
// Method to set the header config of the data table
export var setHeaderConfig = function (headerConfig, config, field) {
    _.forEach(headerConfig, function (cols) {
        if (cols.isGroup) {
            if (cols.field === field) {
                cols.columns.push(config);
            }
            else {
                setHeaderConfig(cols.columns, config, field);
            }
        }
    });
};
export var setHeaderConfigForTable = function (headerConfig, config, fieldName) {
    if (fieldName) {
        setHeaderConfig(headerConfig, config, fieldName);
    }
    else {
        headerConfig.push(config);
    }
};
export var getRowOperationsColumn = function () {
    return {
        'field': 'rowOperations',
        'type': 'custom',
        'displayName': 'Actions',
        'width': '120px',
        'readonly': true,
        'sortable': false,
        'searchable': false,
        'resizable': false,
        'selectable': false,
        'show': true,
        'operations': [],
        'opConfig': {},
        'pcDisplay': true,
        'mobileDisplay': true,
        'include': true,
        'isRowOperation': true
    };
};
/**
 * Returns caption and widget bootstrap classes for the field
 */
export var getFieldLayoutConfig = function (captionWidth, captionPosition, os) {
    var captionCls = '', widgetCls = '';
    captionPosition = captionPosition || 'top';
    if (captionPosition === 'top') {
        if ((os && os === 'android') || !isMobileApp() || isAndroid()) { // Is android or not a mobile application
            captionCls = widgetCls = 'col-xs-12';
        }
        else if (isMobileApp()) { // Is a mobile application and not android
            captionCls = 'col-xs-4';
            widgetCls = 'col-xs-8';
        }
    }
    else if (captionWidth) {
        // handling itemsperrow containing string of classes
        _.forEach(_.split(captionWidth, ' '), function (cls) {
            var keys = _.split(cls, '-'), tier = keys[0];
            var _captionWidth, widgetWidth;
            _captionWidth = parseInt(keys[1], 10);
            widgetWidth = 12 - _captionWidth;
            widgetWidth = widgetWidth <= 0 ? 12 : widgetWidth;
            captionCls += ' ' + 'col-' + tier + '-' + _captionWidth;
            widgetCls += ' ' + 'col-' + tier + '-' + widgetWidth;
        });
    }
    return {
        'captionCls': captionCls,
        'widgetCls': widgetCls
    };
};
export var getDefaultViewModeWidget = function (widget) {
    if (_.includes(['checkbox', 'toggle', 'rating'], widget)) {
        return VIEW_MODE_OPTIONS.DEFAULT;
    }
    return VIEW_MODE_OPTIONS.LABEL;
};
var parseBooleanValue = function (value) {
    if (value === 'true') {
        return true;
    }
    if (value === 'false') {
        return false;
    }
    if (/^\d+$/.test(value)) { // Check if the value is a string of number type like '123'
        return +value;
    }
    return value;
};
var ɵ0 = parseBooleanValue;
export var parseValueByType = function (value, type, widget) {
    if (widget) {
        if (widget === FormWidgetType.NUMBER || widget === FormWidgetType.SLIDER || widget === FormWidgetType.CURRENCY) {
            return isNaN(Number(value)) ? null : Number(value);
        }
        if (widget === FormWidgetType.CHECKBOX || widget === FormWidgetType.TOGGLE) {
            return parseBooleanValue(value);
        }
        return value;
    }
    if (isNumberType(type)) {
        return isNaN(Number(value)) ? null : Number(value);
    }
    if (type === DataType.BOOLEAN) {
        return parseBooleanValue(value);
    }
    return value;
};
var fieldTypeWidgetTypeMap = {
    'integer': ['number', 'text', 'select', 'checkboxset', 'radioset', 'rating', 'slider', 'currency', 'autocomplete', 'chips'],
    'big_integer': ['number', 'text', 'select', 'checkboxset', 'radioset', 'rating', 'slider', 'currency', 'autocomplete', 'chips'],
    'short': ['number', 'text', 'select', 'checkboxset', 'radioset', 'slider', 'currency', 'autocomplete', 'chips'],
    'float': ['number', 'text', 'select', 'checkboxset', 'radioset', 'slider', 'currency', 'autocomplete', 'chips'],
    'big_decimal': ['number', 'text', 'select', 'checkboxset', 'radioset', 'slider', 'currency', 'autocomplete', 'chips'],
    'number': ['number', 'text', 'select', 'checkboxset', 'radioset', 'slider', 'currency', 'autocomplete', 'chips'],
    'double': ['number', 'text', 'select', 'checkboxset', 'radioset', 'slider', 'currency', 'autocomplete', 'chips'],
    'long': ['number', 'text', 'select', 'checkboxset', 'radioset', 'rating', 'slider', 'currency', 'autocomplete', 'chips'],
    'byte': ['number', 'text', 'select', 'checkboxset', 'radioset', 'slider', 'currency', 'autocomplete', 'chips'],
    'string': ['text', 'number', 'textarea', 'password', 'richtext', 'select', 'checkboxset', 'radioset', 'date', 'time', 'timestamp', 'switch', 'currency', 'autocomplete', 'chips', 'colorpicker'],
    'character': ['text', 'number', 'textarea', 'password', 'richtext', 'select', 'checkboxset', 'radioset', 'switch', 'currency', 'autocomplete', 'chips'],
    'text': ['text', 'number', 'textarea', 'password', 'richtext', 'select', 'checkboxset', 'radioset', 'date', 'time', 'timestamp', 'switch', 'currency', 'autocomplete', 'chips', 'colorpicker'],
    'date': ['date', 'text', 'number', 'select', 'checkboxset', 'radioset', 'autocomplete', 'chips'],
    'time': ['time', 'text', 'number', 'select', 'checkboxset', 'radioset', 'autocomplete', 'chips'],
    'timestamp': ['timestamp', 'text', 'number', 'select', 'checkboxset', 'radioset', 'autocomplete', 'chips'],
    'datetime': ['datetime', 'text', 'select', 'checkboxset', 'radioset', 'autocomplete', 'chips'],
    'boolean': ['checkbox', 'radioset', 'toggle', 'select'],
    'list': ['select', 'radioset', 'checkboxset', 'switch', 'autocomplete', 'chips'],
    'clob': ['text', 'textarea', 'richtext'],
    'blob': ['upload'],
    'file': ['upload'],
    'custom': ['text', 'number', 'textarea', 'password', 'checkbox', 'toggle', 'slider', 'richtext', 'currency', 'switch',
        'select', 'checkboxset', 'radioset', 'date', 'time', 'timestamp', 'rating', 'datetime', 'autocomplete', 'chips', 'colorpicker']
};
// Get widgets applicable to the given type
export var getFieldTypeWidgetTypesMap = function () {
    return fieldTypeWidgetTypeMap;
};
// Get filter widget applicable to the given type
export var getDataTableFilterWidget = function (type) {
    var widget = fieldTypeWidgetTypeMap[type] && fieldTypeWidgetTypeMap[type][0];
    if (type === DataType.BOOLEAN) {
        widget = FormWidgetType.SELECT;
    }
    if (_.includes([FormWidgetType.TEXT, FormWidgetType.NUMBER, FormWidgetType.SELECT, FormWidgetType.AUTOCOMPLETE,
        FormWidgetType.DATE, FormWidgetType.TIME, FormWidgetType.DATETIME], widget)) {
        return widget;
    }
    return FormWidgetType.TEXT;
};
/**
 * @ngdoc function
 * @name wm.widgets.live.getEditModeWidget
 * @methodOf wm.widgets.live.LiveWidgetUtils
 * @function
 *
 * @description
 * This function returns the default widget for grid
 *
 * @param {object} colDef field definition
 */
export var getEditModeWidget = function (colDef) {
    if (colDef['related-entity-name'] && colDef['primary-key']) {
        return FormWidgetType.SELECT;
    }
    return (fieldTypeWidgetTypeMap[colDef.type] && fieldTypeWidgetTypeMap[colDef.type][0]) || FormWidgetType.TEXT;
};
/**
 * @ngdoc function
 * @name wm.widgets.live.LiveWidgetUtils#getDefaultValue
 * @methodOf wm.widgets.live.LiveWidgetUtils
 * @function
 *
 * @description
 * return the formatted default value
 *
 * @param {string} value value to be formatted
 * @param {string} type column type of the value
 */
export var getDefaultValue = function (value, type, widget) {
    if (widget) {
        if (widget === FormWidgetType.NUMBER || widget === FormWidgetType.SLIDER || widget === FormWidgetType.CURRENCY) {
            return isNaN(Number(value)) ? null : Number(value);
        }
        if (widget === FormWidgetType.CHECKBOX || widget === FormWidgetType.TOGGLE) {
            return parseBooleanValue(value);
        }
        return value;
    }
    if (isNumberType(type)) {
        return isNaN(Number(value)) ? null : Number(value);
    }
    if (type === DataType.BOOLEAN) {
        return parseBooleanValue(value);
    }
    return value;
};
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS11dGlscy5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B3bS9jb21wb25lbnRzLyIsInNvdXJjZXMiOlsidXRpbHMvbGl2ZS11dGlscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsWUFBWSxFQUFFLGNBQWMsRUFBRSxRQUFRLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUkxRixJQUFPLGlCQUFpQixHQUFHO0lBQ3ZCLE9BQU8sRUFBRyxTQUFTO0lBQ25CLEtBQUssRUFBRyxPQUFPO0NBQ2xCLENBQUM7QUFFRixNQUFNLENBQUMsSUFBTSxTQUFTLEdBQUc7SUFDckIsVUFBVSxFQUFHLFdBQVc7SUFDeEIsTUFBTSxFQUFHLFFBQVE7SUFDakIsSUFBSSxFQUFHLE1BQU07SUFDYixNQUFNLEVBQUcsUUFBUTtDQUNwQixDQUFDO0FBRUYsb0RBQW9EO0FBQ3BELE1BQU0sQ0FBQyxJQUFNLGVBQWUsR0FBRyxVQUFDLFlBQVksRUFBRSxNQUFNLEVBQUUsS0FBSztJQUN2RCxDQUFDLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRSxVQUFBLElBQUk7UUFDeEIsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO1lBQ2QsSUFBSSxJQUFJLENBQUMsS0FBSyxLQUFLLEtBQUssRUFBRTtnQkFDdEIsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7YUFDN0I7aUJBQU07Z0JBQ0gsZUFBZSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLEtBQUssQ0FBQyxDQUFDO2FBQ2hEO1NBQ0o7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxJQUFNLHVCQUF1QixHQUFHLFVBQUMsWUFBWSxFQUFFLE1BQU0sRUFBRSxTQUFTO0lBQ25FLElBQUksU0FBUyxFQUFFO1FBQ1gsZUFBZSxDQUFDLFlBQVksRUFBRSxNQUFNLEVBQUUsU0FBUyxDQUFDLENB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LFFBQVEsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLGFBQWEsRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxVQUFVLEVBQUUsY0FBYyxFQUFFLE9BQU8sQ0FBQztJQUMvSCxNQUFNLEVBQVMsQ0FBQyxRQUFRLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxhQUFhLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxVQUFVLEVBQUUsY0FBYyxFQUFFLE9BQU8sQ0FBQztJQUNySCxRQUFRLEVBQU8sQ0FBQyxNQUFNLEVBQUUsUUFBUSxFQUFHLFVBQVUsRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxhQUFhLEVBQUUsVUFBVSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLFFBQVEsRUFBRSxVQUFVLEVBQUUsY0FBYyxFQUFFLE9BQU8sRUFBRSxhQUFhLENBQUM7SUFDdE0sV0FBVyxFQUFJLENBQUMsTUFBTSxFQUFFLFFBQVEsRUFBRyxVQUFVLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsYUFBYSxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsVUFBVSxFQUFFLGNBQWMsRUFBRSxPQUFPLENBQUM7SUFDMUosTUFBTSxFQUFTLENBQUMsTUFBTSxFQUFFLFFBQVEsRUFBRyxVQUFVLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRSxRQUFRLEVBQUUsYUFBYSxFQUFFLFVBQVUsRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxRQUFRLEVBQUUsVUFBVSxFQUFFLGNBQWMsRUFBRSxPQUFPLEVBQUUsYUFBYSxDQUFDO0lBQ3RNLE1BQU0sRUFBUyxDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxhQUFhLEVBQUUsVUFBVSxFQUFFLGNBQWMsRUFBRSxPQUFPLENBQUM7SUFDdkcsTUFBTSxFQUFTLENBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLGFBQWEsRUFBRSxVQUFVLEVBQUUsY0FB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LE9BQU8sS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUN0RDtRQUNELElBQUksTUFBTSxLQUFLLGNBQWMsQ0FBQyxRQUFRLElBQUksTUFBTSxLQUFLLGNBQWMsQ0FBQyxNQUFNLEVBQUU7WUFDeEUsT0FBTyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztTQUNuQztRQUNELE9BQU8sS0FBSyxDQUFDO0tBQ2hCO0lBQ0QsSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDcEIsT0FBTyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQ3REO0lBQ0QsSUFBSSxJQUFJLEtBQUssUUFBUSxDQUFDLE9BQU8sRUFBRTtRQUMzQixPQUFPLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQ25DO0lBQ0QsT0FBTyxLQUFLLENBQUM7QUFDakIsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNOdW1iZXJUeXBlLCBGb3JtV2lkZ2V0VHlwZSwgRGF0YVR5cGUsIGlzTW9iaWxlQXBwLCBpc0FuZHJvaWQgfSBmcm9tICdAd20vY29yZSc7XG5cbmRlY2xhcmUgY29uc3QgXztcblxuY29uc3QgIFZJRVdfTU9ERV9PUFRJT05TID0ge1xuICAgIERFRkFVTFQgOiAnZGVmYXVsdCcsXG4gICAgTEFCRUwgOiAnbGFiZWwnXG59O1xuXG5leHBvcnQgY29uc3QgRURJVF9NT0RFID0ge1xuICAgIFFVSUNLX0VESVQgOiAncXVpY2tlZGl0JyxcbiAgICBJTkxJTkUgOiAnaW5saW5lJyxcbiAgICBGT1JNIDogJ2Zvcm0nLFxuICAgIERJQUxPRyA6ICdkaWFsb2cnXG59O1xuXG4vLyBNZXRob2QgdG8gc2V0IHRoZSBoZWFkZXIgY29uZmlnIG9mIHRoZSBkYXRhIHRhYmxlXG5leHBvcnQgY29uc3Qgc2V0SGVhZGVyQ29uZmlnID0gKGhlYWRlckNvbmZpZywgY29uZmlnLCBmaWVsZCk6IHZvaWQgPT4ge1xuICAgIF8uZm9yRWFjaChoZWFkZXJDb25maWcsIGNvbHMgPT4ge1xuICAgICAgICBpZiAoY29scy5pc0dyb3VwKSB7XG4gICAgICAgICAgICBpZiAoY29scy5maWVsZCA9PT0gZmllbGQpIHtcbiAgICAgICAgICAgICAgICBjb2xzLmNvbHVtbnMucHVzaChjb25maWcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZXRIZWFkZXJDb25maWcoY29scy5jb2x1bW5zLCBjb25maWcsIGZpZWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IHNldEhlYWRlckNvbmZpZ0ZvclRhYmxlID0gKGhlYWRlckNvbmZpZywgY29uZmlnLCBmaWVsZE5hbWUpOiB2b2lkID0+IHtcbiAgICBpZiAoZmllbGROYW1lKSB7XG4gICAgICAgIHNldEhlYWRlckNvbmZpZyhoZWFkZXJDb25maWcsIGNvbmZpZywgZmllbGROYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBoZWFkZXJDb25maWcucHVzaChjb25maWcpO1xuICAgIH1cbn07XG5cbmV4cG9ydCBjb25zdCBnZXRSb3dPcGVyYXRpb25zQ29sdW1uID0gKCk6IGFueSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgJ2ZpZWxkJyAgICAgICAgIDogJ3Jvd09wZXJhdGlvbnMnLFxuICAgICAgICAndHlwZScgICAgICAgICAgOiAnY3VzdG9tJyxcbiAgICAgICAgJ2Rpc3BsYXlOYW1lJyAgIDogJ0FjdGlvbnMnLFxuICAgICAgICAnd2lkdGgnICAgICAgICAgOiAnMTIwcHgnLFxuICAgICAgICAncmVhZG9ubHknICAgICAgOiB0cnVlLFxuICAgICAgICAnc29ydGFibGUnICAgICAgOiBmYWxzZSxcbiAgICAgICAgJ3NlYXJjaGFibGUnICAgIDogZmFsc2UsXG4gICAgICAgICdyZXNpemFibGUnICAgICA6IGZhbHNlLFxuICAgICAgICAnc2VsZWN0YWJsZScgICAgOiBmYWxzZSxcbiAgICAgICAgJ3Nob3cnICAgICAgICAgIDogdHJ1ZSxcbiAgICAgICAgJ29wZXJhdGlvbnMnICAgIDogW10sXG4gICAgICAgICdvcENvbmZpZycgICAgICA6IHt9LFxuICAgICAgICAncGNEaXNwbGF5JyAgICAgOiB0cnVlLFxuICAgICAgICAnbW9iaWxlRGlzcGxheScgOiB0cnVlLFxuICAgICAgICAnaW5jbHVkZScgICAgICAgOiB0cnVlLFxuICAgICAgICAnaXNSb3dPcGVyYXRpb24nOiB0cnVlXG4gICAgfTtcbn07XG5cbi8qKlxuICogUmV0dXJucyBjYXB0aW9uIGFuZCB3aWRnZXQgYm9vdHN0cmFwIGNsYXNzZXMgZm9yIHRoZSBmaWVsZFxuICovXG5leHBvcnQgY29uc3QgZ2V0RmllbGRMYXlvdXRDb25maWcgPSAoY2FwdGlvbldpZHRoLCBjYXB0aW9uUG9zaXRpb24sIG9zKTogYW55ID0+IHtcbiAgICBsZXQgY2FwdGlvbkNscyA9ICcnLFxuICAgICAgICB3aWRnZXRDbHMgPSAnJztcblxuICAgIGNhcHRpb25Qb3NpdGlvbiA9IGNhcHRpb25Qb3NpdGlvbiB8fCAndG9wJztcblxuICAgIGlmIChjYXB0aW9uUG9zaXRpb24gPT09ICd0b3AnKSB7XG4gICAgICAgIGlmICgob3MgJiYgb3MgPT09ICdhbmRyb2lkJykgfHwgIWlzTW9iaWxlQXBwKCkgfHwgaXNBbmRyb2lkKCkpIHsgLy8gSXMgYW5kcm9pZCBvciBub3QgYSBtb2JpbGUgYXBwbGljYXRpb25cbiAgICAgICAgICAgIGNhcHRpb25DbHMgPSB3aWRnZXRDbHMgPSAnY29sLXhzLTEyJztcbiAgICAgICAgfSBlbHNlIGlmIChpc01vYmlsZUFwcCgpKSB7IC8vIElzIGEgbW9iaWxlIGFwcGxpY2F0aW9uIGFuZCBub3QgYW5kcm9pZFxuICAgICAgICAgICAgY2FwdGlvbkNscyA9ICdjb2wteHMtNCc7XG4gICAgICAgICAgICB3aWRnZXRDbHMgPSAnY29sLXhzLTgnO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChjYXB0aW9uV2lkdGgpIHtcbiAgICAgICAgLy8gaGFuZGxpbmcgaXRlbXNwZXJyb3cgY29udGFpbmluZyBzdHJpbmcgb2YgY2xhc3Nlc1xuICAgICAgICBfLmZvckVhY2goXy5zcGxpdChjYXB0aW9uV2lkdGgsICcgJyksIGZ1bmN0aW9uIChjbHMpIHtcbiAgICAgICAgICAgIGNvbnN0IGtleXMgPSBfLnNwbGl0KGNscywgJy0nKSxcbiAgICAgICAgICAgICAgICB0aWVyID0ga2V5c1swXTtcbiAgICAgICAgICAgIGxldCBfY2FwdGlvbldpZHRoLFxuICAgICAgICAgICAgICAgIHdpZGdldFdpZHRoO1xuICAgICAgICAgICAgX2NhcHRpb25XaWR0aCA9IHBhcnNlSW50KGtleXNbMV0sIDEwKTtcbiAgICAgICAgICAgIHdpZGdldFdpZHRoICA9IDEyIC0gX2NhcHRpb25XaWR0aDtcbiAgICAgICAgICAgIHdpZGdldFdpZHRoICA9IHdpZGdldFdpZHRoIDw9IDAgPyAxMiA6IHdpZGdldFdpZHRoO1xuICAgICAgICAgICAgY2FwdGlvbkNscyArPSAnICcgKyAnY29sLScgKyB0aWVyICsgJy0nICsgX2NhcHRpb25XaWR0aDtcbiAgICAgICAgICAgIHdpZGdldENscyAgKz0gJyAnICsgJ2NvbC0nICsgdGllciArICctJyArIHdpZGdldFdpZHRoO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgJ2NhcHRpb25DbHMnIDogY2FwdGlvbkNscyxcbiAgICAgICAgJ3dpZGdldENscycgIDogd2lkZ2V0Q2xzXG4gICAgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXREZWZhdWx0Vmlld01vZGVXaWRnZXQgPSB3aWRnZXQgPT4ge1xuICAgIGlmIChfLmluY2x1ZGVzKFsnY2hlY2tib3gnLCAndG9nZ2xlJywgJ3JhdGluZyddLCB3aWRnZXQpKSB7XG4gICAgICAgIHJldHVybiBWSUVXX01PREVfT1BUSU9OUy5ERUZBVUxUO1xuICAgIH1cbiAgICByZXR1cm4gVklFV19NT0RFX09QVElPTlMuTEFCRUw7XG59O1xuXG5jb25zdCBwYXJzZUJvb2xlYW5WYWx1ZSA9IHZhbHVlID0+IHtcbiAgICBpZiAodmFsdWUgPT09ICd0cnVlJykge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgaWYgKHZhbHVlID09PSAnZmFsc2UnKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKC9eXFxkKyQvLnRlc3QodmFsdWUpKSB7IC8vIENoZWNrIGlmIHRoZSB2YWx1ZSBpcyBhIHN0cmluZyBvZiBudW1iZXIgdHlwZSBsaWtlICcxMjMnXG4gICAgICAgIHJldHVybiArdmFsdWU7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbn07XG5cbmV4cG9ydCBjb25zdCBwYXJzZVZhbHVlQnlUeXBlID0gKHZhbHVlLCB0eXBlLCB3aWRnZXQpID0+IHtcbiAgICBpZiAod2lkZ2V0KSB7XG4gICAgICAgIGlmICh3aWRnZXQgPT09IEZvcm1XaWRnZXRUeXBlLk5VTUJFUiB8fCB3aWRnZXQgPT09IEZvcm1XaWRnZXRUeXBlLlNMSURFUiB8fCB3aWRnZXQgPT09IEZvcm1XaWRnZXRUeXBlLkNVUlJFTkNZKSB7XG4gICAgICAgICAgICByZXR1cm4gaXNOYU4oTnVtYmVyKHZhbHVlKSkgPyBudWxsIDogTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAod2lkZ2V0ID09PSBGb3JtV2lkZ2V0VHlwZS5DSEVDS0JPWCB8fCB3aWRnZXQgPT09IEZvcm1XaWRnZXRUeXBlLlRPR0dMRSkge1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlQm9vbGVhblZhbHVlKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIGlmIChpc051bWJlclR5cGUodHlwZSkpIHtcbiAgICAgICAgcmV0dXJuIGlzTmFOKE51bWJlcih2YWx1ZSkpID8gbnVsbCA6IE51bWJlcih2YWx1ZSk7XG4gICAgfVxuICAgIGlmICh0eXBlID09PSBEYXRhVHlwZS5CT09MRUFOKSB7XG4gICAgICAgIHJldHVybiBwYXJzZUJvb2xlYW5WYWx1ZSh2YWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbn07XG5cbmNvbnN0IGZpZWxkVHlwZVdpZGdldFR5cGVNYXAgPSB7XG4gICAgJ2ludGVnZXInICAgIDogWydudW1iZXInLCAndGV4dCcsICdzZWxlY3QnLCAnY2hlY2tib3hzZXQnLCAncmFkaW9zZXQnLCAncmF0aW5nJywgJ3NsaWRlcicsICdjdXJyZW5jeScsICdhdXRvY29tcGxldGUnLCAnY2hpcHMnXSxcbiAgICAnYmlnX2ludGVnZXInOiBbJ251bWJlcicsICd0ZXh0JywgJ3NlbGVjdCcsICdjaGVja2JveHNldCcsICdyYWRpb3NldCcsICdyYXRpbmcnLCAnc2xpZGVyJywgJ2N1cnJlbmN5JywgJ2F1dG9jb21wbGV0ZScsICdjaGlwcyddLFxuICAgICdzaG9ydCcgICAgICA6IFsnbnVtYmVyJywgJ3RleHQnLCAnc2VsZWN0JywgJ2NoZWNrYm94c2V0JywgJ3JhZGlvc2V0JywgJ3NsaWRlcicsICdjdXJyZW5jeScsICdhdXRvY29tcGxldGUnLCAnY2hpcHMnXSxcbiAgICAnZmxvYXQnICAgICAgOiBbJ251bWJlcicsICd0ZXh0JywgJ3NlbGVjdCcsICdjaGVja2JveHNldCcsICdyYWRpb3NldCcsICdzbGlkZXInLCAnY3VycmVuY3knLCAnYXV0b2NvbXBsZXRlJywgJ2NoaXBzJ10sXG4gICAgJ2JpZ19kZWNpbWFsJzogWydudW1iZXInLCAndGV4dCcsICdzZWxlY3QnLCAnY2hlY2tib3hzZXQnLCAncmFkaW9zZXQnLCAnc2xpZGVyJywgJ2N1cnJlbmN5JywgJ2F1dG9jb21wbGV0ZScsICdjaGlwcyddLFxuICAgICdudW1iZXInICAgICA6IFsnbnVtYmVyJywgJ3RleHQnLCAnc2VsZWN0JywgJ2NoZWNrYm94c2V0JywgJ3JhZGlvc2V0JywgJ3NsaWRlcicsICdjdXJyZW5jeScsICdhdXRvY29tcGxldGUnLCAnY2hpcHMnXSxcbiAgICAnZG91YmxlJyAgICAgOiBbJ251bWJlcicsICd0ZXh0JywgJ3NlbGVjdCcsICdjaGVja2JveHNldCcsICdyYWRpb3NldCcsICdzbGlkZXInLCAnY3VycmVuY3knLCAnYXV0b2NvbXBsZXRlJywgJ2NoaXBzJ10sXG4gICAgJ2xvbmcnICAgICAgIDogWydudW1iZXInLCAndGV4dCcsICdzZWxlY3QnLCAnY2hlY2tib3hzZXQnLCAncmFkaW9zZXQnLCAncmF0aW5nJywgJ3NsaWRlcicsICdjdXJyZW5jeScsICdhdXRvY29tcGxldGUnLCAnY2hpcHMnXSxcbiAgICAnYnl0ZScgICAgICAgOiBbJ251bWJlcicsICd0ZXh0JywgJ3NlbGVjdCcsICdjaGVja2JveHNldCcsICdyYWRpb3NldCcsICdzbGlkZXInLCAnY3VycmVuY3knLCAnYXV0b2NvbXBsZXRlJywgJ2NoaXBzJ10sXG4gICAgJ3N0cmluZycgICAgIDogWyd0ZXh0JywgJ251bWJlcicsICAndGV4dGFyZWEnLCAncGFzc3dvcmQnLCAncmljaHRleHQnLCAnc2VsZWN0JywgJ2NoZWNrYm94c2V0JywgJ3JhZGlvc2V0JywgJ2RhdGUnLCAndGltZScsICd0aW1lc3RhbXAnLCAnc3dpdGNoJywgJ2N1cnJlbmN5JywgJ2F1dG9jb21wbGV0ZScsICdjaGlwcycsICdjb2xvcnBpY2tlciddLFxuICAgICdjaGFyYWN0ZXInICA6IFsndGV4dCcsICdudW1iZXInLCAgJ3RleHRhcmVhJywgJ3Bhc3N3b3JkJywgJ3JpY2h0ZXh0JywgJ3NlbGVjdCcsICdjaGVja2JveHNldCcsICdyYWRpb3NldCcsICdzd2l0Y2gnLCAnY3VycmVuY3knLCAnYXV0b2NvbXBsZXRlJywgJ2NoaXBzJ10sXG4gICAgJ3RleHQnICAgICAgIDogWyd0ZXh0JywgJ251bWJlcicsICAndGV4dGFyZWEnLCAncGFzc3dvcmQnLCAncmljaHRleHQnLCAnc2VsZWN0JywgJ2NoZWNrYm94c2V0JywgJ3JhZGlvc2V0JywgJ2RhdGUnLCAndGltZScsICd0aW1lc3RhbXAnLCAnc3dpdGNoJywgJ2N1cnJlbmN5JywgJ2F1dG9jb21wbGV0ZScsICdjaGlwcycsICdjb2xvcnBpY2tlciddLFxuICAgICdkYXRlJyAgICAgICA6IFsnZGF0ZScsICd0ZXh0JywgJ251bWJlcicsICdzZWxlY3QnLCAnY2hlY2tib3hzZXQnLCAncmFkaW9zZXQnLCAnYXV0b2NvbXBsZXRlJywgJ2NoaXBzJ10sXG4gICAgJ3RpbWUnICAgICAgIDogWyd0aW1lJywgJ3RleHQnLCAnbnVtYmVyJywgJ3NlbGVjdCcsICdjaGVja2JveHNldCcsICdyYWRpb3NldCcsICdhdXRvY29tcGxldGUnLCAnY2hpcHMnXSxcbiAgICAndGltZXN0YW1wJyAgOiBbJ3RpbWVzdGFtcCcsICd0ZXh0JywgJ251bWJlcicsICdzZWxlY3QnLCAnY2hlY2tib3hzZXQnLCAncmFkaW9zZXQnLCAnYXV0b2NvbXBsZXRlJywgJ2NoaXBzJ10sXG4gICAgJ2RhdGV0aW1lJyAgIDogWydkYXRldGltZScsICd0ZXh0JywgJ3NlbGVjdCcsICdjaGVja2JveHNldCcsICdyYWRpb3NldCcsICdhdXRvY29tcGxldGUnLCAnY2hpcHMnXSxcbiAgICAnYm9vbGVhbicgICAgOiBbJ2NoZWNrYm94JywgJ3JhZGlvc2V0JywgJ3RvZ2dsZScsICdzZWxlY3QnXSxcbiAgICAnbGlzdCcgICAgICAgOiBbJ3NlbGVjdCcsICdyYWRpb3NldCcsICdjaGVja2JveHNldCcsICdzd2l0Y2gnLCAnYXV0b2NvbXBsZXRlJywgJ2NoaXBzJ10sXG4gICAgJ2Nsb2InICAgICAgIDogWyd0ZXh0JywgJ3RleHRhcmVhJywgJ3JpY2h0ZXh0J10sXG4gICAgJ2Jsb2InICAgICAgIDogWyd1cGxvYWQnXSxcbiAgICAnZmlsZScgICAgICAgOiBbJ3VwbG9hZCddLFxuICAgICdjdXN0b20nICAgICA6IFsndGV4dCcsICdudW1iZXInLCAgJ3RleHRhcmVhJywgJ3Bhc3N3b3JkJywgJ2NoZWNrYm94JywgJ3RvZ2dsZScsICdzbGlkZXInLCAncmljaHRleHQnLCAnY3VycmVuY3knLCAnc3dpdGNoJyxcbiAgICAgICAgJ3NlbGVjdCcsICdjaGVja2JveHNldCcsICdyYWRpb3NldCcsICdkYXRlJywgJ3RpbWUnLCAndGltZXN0YW1wJywgJ3JhdGluZycsICdkYXRldGltZScsICdhdXRvY29tcGxldGUnLCAnY2hpcHMnLCAnY29sb3JwaWNrZXInXVxufTtcblxuLy8gR2V0IHdpZGdldHMgYXBwbGljYWJsZSB0byB0aGUgZ2l2ZW4gdHlwZVxuZXhwb3J0IGNvbnN0IGdldEZpZWxkVHlwZVdpZGdldFR5cGVzTWFwID0gKCkgPT4ge1xuICAgIHJldHVybiBmaWVsZFR5cGVXaWRnZXRUeXBlTWFwO1xufTtcblxuLy8gR2V0IGZpbHRlciB3aWRnZXQgYXBwbGljYWJsZSB0byB0aGUgZ2l2ZW4gdHlwZVxuZXhwb3J0IGNvbnN0IGdldERhdGFUYWJsZUZpbHRlcldpZGdldCA9IHR5cGUgPT4ge1xuICAgIGxldCB3aWRnZXQgPSBmaWVsZFR5cGVXaWRnZXRUeXBlTWFwW3R5cGVdICYmIGZpZWxkVHlwZVdpZGdldFR5cGVNYXBbdHlwZV1bMF07XG4gICAgaWYgKHR5cGUgPT09IERhdGFUeXBlLkJPT0xFQU4pIHtcbiAgICAgICAgd2lkZ2V0ID0gRm9ybVdpZGdldFR5cGUuU0VMRUNUO1xuICAgIH1cbiAgICBpZiAoXy5pbmNsdWRlcyhbRm9ybVdpZGdldFR5cGUuVEVYVCwgRm9ybVdpZGdldFR5cGUuTlVNQkVSLCBGb3JtV2lkZ2V0VHlwZS5TRUxFQ1QsIEZvcm1XaWRnZXRUeXBlLkFVVE9DT01QTEVURSxcbiAgICAgICAgICAgIEZvcm1XaWRnZXRUeXBlLkRBVEUsIEZvcm1XaWRnZXRUeXBlLlRJTUUsIEZvcm1XaWRnZXRUeXBlLkRBVEVUSU1FXSwgd2lkZ2V0KSkge1xuICAgICAgICByZXR1cm4gd2lkZ2V0O1xuICAgIH1cbiAgICByZXR1cm4gRm9ybVdpZGdldFR5cGUuVEVYVDtcbn07XG5cbi8qKlxuICogQG5nZG9jIGZ1bmN0aW9uXG4gKiBAbmFtZSB3bS53aWRnZXRzLmxpdmUuZ2V0RWRpdE1vZGVXaWRnZXRcbiAqIEBtZXRob2RPZiB3bS53aWRnZXRzLmxpdmUuTGl2ZVdpZGdldFV0aWxzXG4gKiBAZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFRoaXMgZnVuY3Rpb24gcmV0dXJucyB0aGUgZGVmYXVsdCB3aWRnZXQgZm9yIGdyaWRcbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gY29sRGVmIGZpZWxkIGRlZmluaXRpb25cbiAqL1xuZXhwb3J0IGNvbnN0IGdldEVkaXRNb2RlV2lkZ2V0ID0gY29sRGVmID0+IHtcbiAgICBpZiAoY29sRGVmWydyZWxhdGVkLWVudGl0eS1uYW1lJ10gJiYgY29sRGVmWydwcmltYXJ5LWtleSddKSB7XG4gICAgICAgIHJldHVybiBGb3JtV2lkZ2V0VHlwZS5TRUxFQ1Q7XG4gICAgfVxuICAgIHJldHVybiAoZmllbGRUeXBlV2lkZ2V0VHlwZU1hcFtjb2xEZWYudHlwZV0gJiYgZmllbGRUeXBlV2lkZ2V0VHlwZU1hcFtjb2xEZWYudHlwZV1bMF0pIHx8IEZvcm1XaWRnZXRUeXBlLlRFWFQ7XG59O1xuXG4vKipcbiAqIEBuZ2RvYyBmdW5jdGlvblxuICogQG5hbWUgd20ud2lkZ2V0cy5saXZlLkxpdmVXaWRnZXRVdGlscyNnZXREZWZhdWx0VmFsdWVcbiAqIEBtZXRob2RPZiB3bS53aWRnZXRzLmxpdmUuTGl2ZVdpZGdldFV0aWxzXG4gKiBAZnVuY3Rpb25cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIHJldHVybiB0aGUgZm9ybWF0dGVkIGRlZmF1bHQgdmFsdWVcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdmFsdWUgdmFsdWUgdG8gYmUgZm9ybWF0dGVkXG4gKiBAcGFyYW0ge3N0cmluZ30gdHlwZSBjb2x1bW4gdHlwZSBvZiB0aGUgdmFsdWVcbiAqL1xuZXhwb3J0IGNvbnN0IGdldERlZmF1bHRWYWx1ZSA9ICh2YWx1ZSwgdHlwZSwgd2lkZ2V0KSA9PiB7XG4gICAgaWYgKHdpZGdldCkge1xuICAgICAgICBpZiAod2lkZ2V0ID09PSBGb3JtV2lkZ2V0VHlwZS5OVU1CRVIgfHwgd2lkZ2V0ID09PSBGb3JtV2lkZ2V0VHlwZS5TTElERVIgfHwgd2lkZ2V0ID09PSBGb3JtV2lkZ2V0VHlwZS5DVVJSRU5DWSkge1xuICAgICAgICAgICAgcmV0dXJuIGlzTmFOKE51bWJlcih2YWx1ZSkpID8gbnVsbCA6IE51bWJlcih2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHdpZGdldCA9PT0gRm9ybVdpZGdldFR5cGUuQ0hFQ0tCT1ggfHwgd2lkZ2V0ID09PSBGb3JtV2lkZ2V0VHlwZS5UT0dHTEUpIHtcbiAgICAgICAgICAgIHJldHVybiBwYXJzZUJvb2xlYW5WYWx1ZSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBpZiAoaXNOdW1iZXJUeXBlKHR5cGUpKSB7XG4gICAgICAgIHJldHVybiBpc05hTihOdW1iZXIodmFsdWUpKSA/IG51bGwgOiBOdW1iZXIodmFsdWUpO1xuICAgIH1cbiAgICBpZiAodHlwZSA9PT0gRGF0YVR5cGUuQk9PTEVBTikge1xuICAgICAgICByZXR1cm4gcGFyc2VCb29sZWFuVmFsdWUodmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWU7XG59O1xuIl19