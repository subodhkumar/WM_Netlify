{"version":3,"sources":["ng://@wm/variables/constants/variables.constants.ts","node_modules/tslib/tslib.es6.js","ng://@wm/variables/util/variable/variables.utils.ts","ng://@wm/variables/util/file-upload.util.ts","ng://@wm/variables/manager/variable/base-variable.manager.ts","ng://@wm/variables/manager/variable/model-variable.manager.ts","ng://@wm/variables/util/notify-promise.ts","ng://@wm/variables/util/oAuth.utils.ts","ng://@wm/variables/util/variable/service-variable.utils.ts","ng://@wm/variables/util/inflight-queue.ts","ng://@wm/variables/manager/variable/service-variable.manager.ts","ng://@wm/variables/util/variable/live-variable.utils.ts","ng://@wm/variables/util/variable/live-variable.http.utils.ts","ng://@wm/variables/manager/variable/live-variable.manager.ts","ng://@wm/variables/manager/action/base-action.manager.ts","ng://@wm/variables/manager/action/navigation-action.manager.ts","ng://@wm/variables/util/action/navigation-action.utils.ts","ng://@wm/variables/manager/action/notification-action.manager.ts","ng://@wm/variables/manager/action/login-action.manager.ts","ng://@wm/variables/manager/action/logout-action.manager.ts","ng://@wm/variables/manager/action/timer-action.manager.ts","ng://@wm/variables/manager/variable/device-variable-manager.ts","ng://@wm/variables/manager/variable/web-socket-variable.manager.ts","ng://@wm/variables/factory/variable-manager.factory.ts","ng://@wm/variables/manager/variable/device-variable-service.ts","ng://@wm/variables/util/dataset-util.ts","ng://@wm/variables/model/base-variable.ts","ng://@wm/variables/model/variable/api-aware-variable.ts","ng://@wm/variables/model/variable/device-variable.ts","ng://@wm/variables/model/variable/live-variable.ts","ng://@wm/variables/model/base-action.ts","ng://@wm/variables/model/action/navigation-action.ts","ng://@wm/variables/model/variable/model-variable.ts","ng://@wm/variables/model/variable/service-variable.ts","ng://@wm/variables/model/action/notification-action.ts","ng://@wm/variables/model/action/login-action.ts","ng://@wm/variables/model/action/logout-action.ts","ng://@wm/variables/model/action/timer-action.ts","ng://@wm/variables/model/variable/web-socket-variable.ts","ng://@wm/variables/factory/variable.factory.ts","ng://@wm/variables/service/metadata-service/metadata.service.ts","ng://@wm/variables/service/variables.service.ts","ng://@wm/variables/variables.module.ts"],"names":["CONSTANTS","hasCordova","window","undefined","isWaveLens","isStudioMode","isRunMode","XSRF_COOKIE_NAME","DEFAULT_TIMER_DELAY","WIDGET_DOESNT_EXIST","VARIABLE_CONSTANTS","CATEGORY","MODEL","LIVE","SERVICE","WEBSOCKET","NAVIGATION","NOTIFICATION","TIMER","LOGIN","LOGOUT","DEVICE","EVENTS","EVENT","CAN_UPDATE","BEFORE","BEFORE_UPDATE","PREPARE_SETDATA","RESULT","ERROR","ABORT","PROGRESS","CLICK","HIDE","OK","CANCEL","CLOSE","TIMER_FIRE","SUCCESS","BEFORE_OPEN","OPEN","BEFORE_SEND","MESSAGE_RECEIVE","BEFORE_CLOSE","OWNER","APP","PAGE","REST_SUPPORTED_SERVICES","PAGINATION_PARAMS","REST_SERVICE","BASE_PATH_KEY","RELATIVE_PATH_KEY","OAUTH_PROVIDER_KEY","AUTH_HDR_KEY","SECURITY_DEFN","BASIC","OAUTH2","AUTH_TYPE","OAUTH","NONE","CONTENT_TYPE_KEY","ACCESSTOKEN_PLACEHOLDER","LEFT","RIGHT","ERR_TYPE","NO_ACCESSTOKEN","NO_CREDENTIALS","METADATA_MISSING","USER_UNAUTHORISED","REQUIRED_FIELD_MISSING","ERR_MSG","UNCLOAKED_HEADERS","PREFIX","AUTH_HDR_VAL","CLOAK_HEADER_KEY","SERVICE_TYPE","JAVA","REST","SOAP","FEED","DATA","SECURITY","CONTROLLER_TYPE","QUERY","PROCEDURE","HTTP_STATUS_CODE","CORS_FAILURE","UNAUTHORIZED","FORBIDDEN","EXPORT_TYPES_MAP","EXCEL","CSV","DEFAULT_VAR","WS_CONSTANTS","NON_BODY_HTTP_METHODS","CONTENT_TYPES","FORM_URL_ENCODED","MULTIPART_FORMDATA","OCTET_STREAM","DB_CONSTANTS","DATABASE_MATCH_MODES","like","start","startignorecase","end","endignorecase","anywhere","anywhereignorecase","exact","exactignorecase","notequals","notequalsignorecase","between","in","notin","lessthan","lessthanequal","greaterthan","greaterthanequal","null","isnotnull","empty","isnotempty","nullorempty","DATABASE_EMPTY_MATCH_MODES","DATABASE_RANGE_MATCH_MODES","DATABASE_NULL_EMPTY_MATCH","NULL","IS_NOT_NULL","EMPTY","IS_NOT_EMPTY","NULL_OR_EMPTY","DATABASE_MATCH_MODES_WITH_QUERY","LIKE","STARTING_WITH","STARTING_WITH_IGNORECASE","ENDING_WITH","ENDING_WITH_IGNORECASE","CONTAINING","CONTAINING_IGNORECASE","EQUALS","EQUALS_IGNORECASE","NOT_EQUALS","NOT_EQUALS_IGNORECASE","BETWEEN","IN","NOTIN","LESS_THAN","LESS_THAN_OR_EQUALS","GREATER_THAN","GREATER_THAN_OR_EQUALS","DATABASE_STRING_MODES","SWAGGER_CONSTANTS","WM_DATA_JSON","WM_HTTP_JSON","VARIABLE_URLS","DATABASE","searchTableData","url","method","searchTableDataWithQuery","headers","Content-Type","readTableData","insertTableData","insertMultiPartTableData","updateTableData","updateMultiPartTableData","deleteTableData","updateCompositeTableData","periodUpdateCompositeTableData","updateMultiPartCompositeTableData","deleteCompositeTableData","periodDeleteCompositeTableData","getDistinctDataByFields","exportTableData","readTableRelatedData","executeNamedQuery","executeCustomQuery","executeAggregateQuery","executeNamedProcedure","countTableDataWithQuery","oauthConfiguration","getAuthorizationUrl","$rootScope","project","deployedUrl","id","projectName","isApplicationType","extendStatics","Object","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","HTTP_EVENT_TYPE","UPLOAD_STATUS","exportTypesMap","DOT_EXPR_REX","internalBoundNodeMap","Map","timers","_invoke","variable","op","debouncedFn","retVal","cancelFn","_","noop","has","get","cancel","debounce","Promise","catch","set","processVariablePostBindUpdate","nodeName","nodeVal","nodeType","noUpdate","category","operation","forEach","val","key","filterFields","value","type","autoUpdate","isUndefined","isFunction","listRecords","inputFields","invoke","setDependency","ref","appManager","httpService","metadataService","navigationService","routerService","toasterService","oauthService","securityService","dialogService","initiateCallback","data","options","skipDefaultNotification","errorVariable","eventValues","callBackScope","_context","Actions","getMessage","isString","message","fn","$parseEvent","dataFilter","inputData","triggerOnTimeout","success","setTimeout","triggerFn","downloadFilefromResponse","response","error","matches","blob","URL","downloadUrl","filename","disposition","indexOf","exec","replace","Blob","navigator","msSaveBlob","webkitURL","createObjectURL","reader_1","a","document","createElement","download","FileReader","onloadend","result","open","location","href","onload","bind","onerror","readAsDataURL","body","appendChild","click","revokeObjectURL","serviceName","setParamsFromURL","queryParams","params","split","param","decodeURIComponent","join","slice","downloadThroughIframe","requestParams","iFrameElement","formEl","paramElement","IFRAME_NAME","FORM_NAME","CONTENT_TYPE","encType","pickBy","$","length","first","remove","attr","target","action","enctype","substring","dataParams","includes","toUpper","name","append","contents","find","submit","downloadThroughAnchor","config","send","responseType","then","err","fileName","exportFormat","fileExtension","currentTimestamp","Date","now","last","isXsrfEnabled","localStorage","getItem","getTargetObj","obj","root","rootNode","test","substr","lastIndexOf","findValueOf","getTargetNodeKey","pop","setValueToNode","targetNodeKey","targetObj","updateInternalNodes","internalNodes","boundInternalNodes","keys","findInternalNodeBound","filter","node","processBindObject","scope","destroyFn","registerDestroyListener","stringStartsWith","$watch","newVal","oldVal","getClonedObject","isObject","processBinding","context","bindSource","bindTarget","bindMap","simulateFileDownload","notify","extension","successCb","errorCb","isEmpty","setInput","lastKey","paramObj","getBlob","contentType","isNumber","parseInt","paramVal","paramKey","isFileUploadSupported","File","FileList","getEvaluatedOrderBy","varOrder","optionsOrder","optionFields","varOrderBy","map","order","trim","orderBy","formatExportExpression","fieldDefs","fieldDef","expression","debounceVariableCall","getDateTimeFormatForType","DEFAULT_FORMATS","_formatDate","dateValue","epoch","isDate","getTime","isNaN","moment","valueOf","DataType","TIMESTAMP","TIME","toDateString","getPipe","transform","formatDate","toLower","extractType","isArray","BaseVariableManager","initBinding","notifyInflight","status","active","httpCall","_this","resolve","reject","_observable","sendCallAsObservable","subscribe","isPlatformSessionTimeout","_401Subscriber","asObservable","e","prepareCallbackOptions","xhrObj","moreOptions","extend","checkEmptyObject","ModelVariableManager","tslib_1.__extends","removeFirstEmptyObject","dataSet","NotifyPromise","notifyQueue","fn1","cleanUp","p1","res","rej","superThen","onResolve","onReject","onNotify","reason","push","_super","AjaxFileTransferObject","file","transferFn","promise","abortFn","call","FileTransferObject","size","QUEUED","IN_PROGRESS","onSuccess","onError","onProgress","self","event","progress","Math","round","loaded","total","finally","onFinal","abort","ABORTED","uploadWithAjax","fd","cloneFD","FormData","iterate","fileObject","appendFileToFormData","paramName","content","request","upload","UploadProgress","uploadProgress","Response","_uploadProgress","getAccessToken","provider","checkLoaclStorage","getFormData","formData","paramValue","paramType","paramContentType","JSON","stringify","processRequestBody","requestBody","missingParams","readOnly","required","isDateTimeType","ServiceVariableUtils","constructRequestParams","operationInfo","field","bodyInfo","pathParamRex","uname","pswd","isProxyCall","paramValueInfo","securityDefnObj","accessToken","withCredentials","_headers","CLOAK_PREFIX","directPath","relativePath","basePath","isBodyTypeQueryProcedure","controller","operationType","requiredParamMissing","authDetails","getFormDataObj","securityDefinitions","btoa","proxySettings","web","mobile","httpMethod","methodType","parameters","setParamsOfChildNode","children","serviceType","sampleValue","isDefined","parameterType","toUpperCase","isNull","encodeURIComponent","RegExp","concat","consumes","skipCloakHeaders","getPrefabName","projectID","isDirectCall","isExtURL","isFileUploadRequest","service","excludePaginationParams","$queue","InflightQueue","requestsQueue","addToQueue","param2","processes","rejectProcess","process","clear","delete","nextProcess","inFlightBehavior","i","splice","ServiceVariableManager","apply","arguments","fileUploadResponse","fileUploadCount","totalFilesCount","successFileUploadCount","failedFileUploadCount","processErrorResponse","errMsg","errorCB","skipNotification","methodInfo","getMethodInfo","advancedOptions","removeAccessToken","canUpdate","processSuccessResponse","newDataSet","pagination","jsonParsedResponse","getValidJSON","xmlToJson","isResponsePageable","isPageable","omit","rawData","transformationColumns","transformData","forceRunMode","skipDataSetUpdate","defineProperty","$invokeWatchers","uploadFileInFormData","files","fileParamName","notifyApp","getAppLocale","MESSAGE_FILE_UPLOAD_SUCCESS","MESSAGE_FILE_UPLOAD_ERROR","_progressObservable","next","handleAuthError","info","pushToSessionFailureRequests","handle401","handleRequestMetaError","providerId","perfromOAuthorization","console","warn","wmTransformedData","columnsArray","dataArray","dataField","transformedData","datum","index","column","columnIndex","serviceDef","getByOperationId","operationId","isOAuthTypeService","maxResults","page","isFileUploadInProgress","dataBindings","filesStatus","dataBinding","uploadFile","fileParamCount","fileArr","promArr","inputField","input","values","o","all","successHandler","errorHandler","output","uploadPromise","produces","exportType","skipToggleState","getErrMessage","details","inputParams","fields","hasIn","isValidWebURL","getInputParms","wmServiceOperationInfo","$file","unsubscribe","defineFirstLastRecord","isList","configurable","head","getQueryParams","searchValue","searchRecords","searchKey","query","pagesize","onBeforeservicecall","LiveVariableUtils","isCompositeKey","primaryKey","isNoPrimaryKey","getCompositeIDURL","primaryKeysData","compositeId","hasBlob","getPrimaryKey","propertiesMap","primaryFields","columns","isPrimaryKey","isRelated","relatedFieldName","fieldName","processBlobColumns","responseData","primaryKeys","blobCols","endsWith","_prefabName","liveSource","col","compositeKeysData","getHibernateOrSqlType","entityName","relatedCols","relatedCol","relatedColumnName","entity","relatedEntityName","getSqlType","isRelatedFieldMany","columnsCount","isStringType","getSQLFieldType","getAttributeName","attrName","getFilterCondition","filterCondition","getFilterOption","fieldOptions","attributeName","filterOption","fieldValue","matchModes","fieldRequired","fieldType","matchMode","firstLevelValues_1","subFieldValue","subFieldName","attributeValue","attributeType","searchWithQuery","isVariableFilter","reduce","getFilterOptions","filterOptions","each","isNil","wrapInLowerCase","ignoreCase","isField","encodeAndAddQuotes","skipEncode","encodedValue","isNumberType","getParamValue","dbModes","getSearchQuery","operator","matchModeExpr","isValArray","processFilterFields","rules","rule","secondvalue","toLowerCase","getSearchField","some","getIgnoreCase","generateSearchQuery","condition","searchField","prepareTableOptionsForFilterExps","clonedFields","orderByFields","clonedObj","filterExpressions","filterExpr","filterRules","logicalOp","filterObj","filterName","ruleObj","tempRules","sort","prepareTableOptions","optionsQuery","getFieldType","relatedField","prepareFormData","variableDetails","rowObject","rowData","clone","colValue","colName","traverseFilterExpressions","traverseCallbackFn","filExpObj","getFilterExprFields","isRequiredFieldAbsent","parentFilExpObj","getWhereClauseGenerator","updatedFilterFields","modifier","parseConfig","serviceParams","urlParams","byPassResult","preventMultiple","generateConnectionParams","connectionParams","requestData","dataModelName","queryName","procedureName","procedureParams","removeExtraSlashes","initiateAction","successCallback","failureCallback","noproxy","LVService","emptyArr","LiveVariableManager","getDataFilterObj","clonedFilterFields","getFilterFields","getCriteria","filterField","criterian","criteria","initFilterExpressionBinding","filterSubscription","processFilterExpBindNode","update","updateDataset","setVariableOptions","_options","handleError","opt","errorDetails","makeCall","dbOperation","reqParams","getEntityData","tableOptions","dbOperationOptions","getEntitySuccess","getEntityError","dataObj","updateFilterFields","designMaxResults","advancedOptions_1","performCUD","doCUD","dbName","prevData","columnName","onCUDerror","onCUDsuccess","isFormDataSupported","prevCompositeKeysData","row","attrValue","period","charAt","dbOperations","aggregateData","aggregateDataSuccess","aggregateDataError","aggregations","errorMsg","insertRecord","updateRecord","deleteRecord","setFilter","existingCriteria","getExistingCriteria","downloadSuccess","downloadError","exportSize","getRelatedTablePrimaryKeys","getRelatedTableData","getRelatedTableDataSuccess","getRelatedTableDataError","relatedTable","relatedTables","table","relationName","selfRelatedCols","_clonedFields","parse","filterExpQuery","assign","getDistinctDataByFieldsSuccess","getDistinctDataByFieldsError","groupByFields","getAggregatedData","deployedURL","getDeployedURL","prepareRequestParams","searchKeys","formFields","limit","orderby","upgradeInputDataToFilterExpressions","clonedRules","cloneDeep","valueObj","filteredObj","downgradeFilterExpressionsToInputData","BaseActionManager","NavigationActionManager","viewName","pageName","goToPrevious","goToPage","transition","pageTransitions","$event","tabName","accordionName","segmentName","goToView","NVUtils.navigate","NotificationActionManager","onToasterClick","onToasterHide","notifyViaToaster","toaster","class","text","title","positionClass","position","toasterPosition","partialPage","duration","showCustom","timeOut","partialParams","_binddataSet","show","enableHtml","onClick","onTap","onHide","onHidden","notifyViaDialog","commonPageDialogId","capitalize","dialogId","owner","notification","okButtonText","cancelButtonText","alerttype","onOk","close","onCancel","onClose","setMessage","getOkButtonText","setOkButtonText","getToasterDuration","setToasterDuration","getToasterClass","setToasterClass","getToasterPosition","setToasterPosition","getAlertType","setAlertType","getCancelButtonText","setCancelButtonText","LoginActionManager","validate","remembermeKey","old_key","isBoolean","migrateOldParams","loginParams","paramMigrationMap","usernametext","username","passwordtext","password","remembermecheck","rememberme","login","loginInfo","lastLoggedInUsername","appLogin","reloadAppData","useDefaultSuccessHandler","isSameUserReloggedIn","executeSessionFailureRequests","redirectPage","getCurrentRouteQueryParam","noRedirect","queryParamsObj","getRedirectedRouteQueryParams","redirectTo","securityConfig","sessionTimeoutLoginMode","navigate","reload","LogoutActionManager","logout","msg","isAuthenticated","appLogout","redirectUrl","TimerActionManager","trigger","_promise","repeatTimer","repeating","delay","setInterval","clearInterval","clearTimeout","DeviceVariableManager","serviceRegistry","registerService","WebSocketVariableManager","scope_var_socket_map","PROPERTY","DATA_UPDATE_STRATEGY","DATA_LIMIT","REFRESH","PREPEND","APPEND","shouldAppendData","shouldAppendLast","getDataLimit","dataLimit","getURL","prefabName","opInfo","_onSocketError","_onSocketMessage","evt","dataLength","shouldAddToLast","insertIdx","shift","_onBeforeSend","_onBeforeSocketClose","_onBeforeSocketOpen","_onSocketOpen","_socketConnected","freeSocket","_onSocketClose","getSocket","_socket","isInsecureContentRequest","$WebSocket","onOpen","onMessage","socket","shouldClose","managerMap","typeToManagerMap","Variable","Action","wm.Variable","wm.ServiceVariable","wm.LiveVariable","wm.NavigationVariable","wm.NotificationVariable","wm.LoginVariable","wm.LogoutVariable","wm.TimerVariable","wm.DeviceVariable","wm.WebSocketVariable","VariableManagerFactory","DeviceVariableService","operations","dataBindings_1","entries","model","DatasetUtil","isValidDataset","getValue","setValue","setItem","findIndex","addItem","removeItem","exactMatch","isEqual","getValidDataset","getCount","BaseVariable","execute","returnVal","DataSource","Operation","GET_NAME","GET_UNIQUE_IDENTIFIER","_id","GET_CONTEXT_IDENTIFIER","ADD_ITEM","item","SET_ITEM","prevItem","REMOVE_ITEM","getData","setData","clearData","ApiAwareVariable","getManager","DeviceVariable","init","LiveVariable","IS_API_AWARE","SUPPORTS_CRUD","SUPPORTS_DISTINCT_API","IS_PAGEABLE","SUPPORTS_SERVER_FILTER","GET_OPERATION_TYPE","GET_RELATED_PRIMARY_KEYS","GET_ENTITY_NAME","LIST_RECORDS","UPDATE_RECORD","INSERT_RECORD","DELETE_RECORD","INVOKE","UPDATE","GET_RELATED_TABLE_DATA","GET_DISTINCT_DATA_BY_FIELDS","GET_AGGREGATED_DATA","GET_MATCH_MODE","DOWNLOAD","GET_PROPERTIES_MAP","GET_PRIMARY_KEY","GET_BLOB_URL","primaryValue","GET_OPTIONS","SEARCH_RECORDS","GET_REQUEST_PARAMS","getRequestParams","GET_PAGING_OPTIONS","IS_UPDATE_REQUIRED","IS_BOUND_TO_LOCALE","_downgradeInputData","_upgradeInputData","setOrderBy","createRecord","BaseAction","NavigationAction","ModelVariable","isBoundToLocale","GET_DEFAULT_LOCALE","getDefaultLocale","getSelectedLocale","ServiceVariable","SET_INPUT","isUpdateRequired","hasData","NotificationAction","NOTIFY","clearMessage","classText","LoginAction","LogoutAction","TimerAction","fire","WebSocketVariable","VariableFactory","variableInstance","__cloneable__","MetadataService","$http","CONTEXT_APP","isLoaded","metadataMap","load","Injectable","AbstractHttpService","VariablesService","oAuthService","bulkCancel","collection","triggerStartUpdate","startUpdate","register","variablesJson","varInstance","variableInstances","Variables","callback","variableName","destroy","registerDependency","AbstractNavigationService","Router","AbstractToasterService","OAuthService","SecurityService","AbstractDialogService","toastrModule","ToastrModule","forRoot","maxOpened","autoDismiss","VariablesModule","ngModule","providers","Location","provide","LocationStrategy","useClass","HashLocationStrategy","NgModule","args","imports","CommonModule","HttpClientModule","HttpServiceModule","OAuthModule","SecurityModule","declarations"],"mappings":"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","sourcesContent":["export const CONSTANTS = {\n    hasCordova: window['cordova'] !== undefined,\n    isWaveLens: window['WaveLens'] !== undefined,\n    isStudioMode: false,\n    isRunMode: true,\n    XSRF_COOKIE_NAME: 'wm_xsrf_token',\n    DEFAULT_TIMER_DELAY: 500,\n    WIDGET_DOESNT_EXIST : 'The widget you\\'re trying to navigate to doesn\\'t exist on this page'\n};\nexport const VARIABLE_CONSTANTS = {\n    CATEGORY: {\n        MODEL: 'wm.Variable',\n        LIVE: 'wm.LiveVariable',\n        SERVICE: 'wm.ServiceVariable',\n        WEBSOCKET: 'wm.WebSocketVariable',\n        NAVIGATION: 'wm.NavigationVariable',\n        NOTIFICATION: 'wm.NotificationVariable',\n        TIMER: 'wm.TimerVariable',\n        LOGIN: 'wm.LoginVariable',\n        LOGOUT: 'wm.LogoutVariable',\n        DEVICE: 'wm.DeviceVariable'\n    },\n    EVENTS: ['onBefore',\n        'onBeforeUpdate',\n        'onResult',\n        'onBeforeOpen',\n        'onOpen',\n        'onBeforeMessageSend',\n        'onMessageReceive',\n        'onProgress',\n        'onError',\n        'onBeforeDatasetReady',\n        'onCanUpdate',\n        'onClick',\n        'onHide',\n        'onOk',\n        'onCancel',\n        'onBeforeClose',\n        'onClose',\n        'onTimerFire',\n        'onSuccess',\n        'onOnline',\n        'onOffline'],\n    EVENT: {\n        'CAN_UPDATE': 'onCanUpdate',\n        'BEFORE': 'onBefore',\n        'BEFORE_UPDATE': 'onBeforeUpdate',\n        'PREPARE_SETDATA': 'onBeforeDatasetReady',\n        'RESULT': 'onResult',\n        'ERROR': 'onError',\n        'ABORT': 'onAbort',\n        'PROGRESS': 'onProgress',\n        'CLICK': 'onClick',\n        'HIDE': 'onHide',\n        'OK': 'onOk',\n        'CANCEL': 'onCancel',\n        'CLOSE': 'onClose',\n        'TIMER_FIRE': 'onTimerFire',\n        'SUCCESS': 'onSuccess',\n        'BEFORE_OPEN': 'onBeforeOpen',\n        'OPEN': 'onOpen',\n        'BEFORE_SEND': 'onBeforeMessageSend',\n        'MESSAGE_RECEIVE': 'onMessageReceive',\n        'BEFORE_CLOSE': 'onBeforeClose'\n    },\n    OWNER: {\n        'APP': 'App',\n        'PAGE': 'Page'\n    },\n    REST_SUPPORTED_SERVICES: ['JavaService', 'SoapService', 'FeedService', 'RestService', 'SecurityServiceType', 'DataService', 'WebSocketService'],\n    PAGINATION_PARAMS: ['page', 'size', 'sort'],\n    REST_SERVICE: {\n        'BASE_PATH_KEY': 'x-WM-BASE_PATH',\n        'RELATIVE_PATH_KEY': 'x-WM-RELATIVE_PATH',\n        'OAUTH_PROVIDER_KEY': 'x-WM-PROVIDER_ID',\n        'AUTH_HDR_KEY': 'Authorization',\n        'SECURITY_DEFN': {\n            'BASIC': 'basic',\n            'OAUTH2': 'oauth2',\n        },\n        'AUTH_TYPE': {\n            'BASIC': 'BASIC',\n            'OAUTH': 'OAUTH2',\n            'NONE': 'NONE',\n        },\n        'CONTENT_TYPE_KEY': 'x-WM-CONTENT_TYPE',\n        'ACCESSTOKEN_PLACEHOLDER': {\n            'LEFT': '',\n            'RIGHT': '.access_token'\n        },\n        ERR_TYPE: {\n            NO_ACCESSTOKEN: 'missing_accesstoken',\n            NO_CREDENTIALS: 'no_credentials',\n            METADATA_MISSING: 'metadata_missing',\n            USER_UNAUTHORISED: 'user_unauthorised',\n            REQUIRED_FIELD_MISSING: 'required_field_missing',\n        },\n        ERR_MSG: {\n            NO_ACCESSTOKEN: 'Access token missing',\n            NO_CREDENTIALS: 'No credentials present',\n            METADATA_MISSING: 'Metadata missing',\n            USER_UNAUTHORISED: 'Unauthorized User',\n            REQUIRED_FIELD_MISSING: 'Required field(s) missing: \"${0}\"'\n        },\n        UNCLOAKED_HEADERS: ['CONTENT-TYPE', 'ACCEPT', 'CONTENT-LENGTH', 'ACCEPT-ENCODING', 'ACCEPT-LANGUAGE'],\n        PREFIX: {\n            AUTH_HDR_VAL: {\n                BASIC: 'Basic',\n                OAUTH: 'Bearer'\n            },\n            CLOAK_HEADER_KEY: 'X-WM-'\n        }\n    },\n    SERVICE_TYPE: {\n        JAVA: 'JavaService',\n        REST: 'RestService',\n        SOAP: 'SoapService',\n        FEED: 'FeedService',\n        DATA: 'DataService',\n        SECURITY: 'SecurityServiceType',\n        WEBSOCKET: 'WebSocketService',\n    },\n    CONTROLLER_TYPE: {\n        QUERY: 'QueryExecution',\n        PROCEDURE: 'ProcedureExecution'\n    },\n    HTTP_STATUS_CODE: {\n        CORS_FAILURE: -1,\n        UNAUTHORIZED: 401,\n        FORBIDDEN: 403\n    },\n    EXPORT_TYPES_MAP: {\n        'EXCEL' : '.xlsx',\n        'CSV' : '.csv'},\n    DEFAULT_VAR : {\n        'NOTIFICATION' : 'appNotification'\n    }\n};\n\nexport const WS_CONSTANTS = {\n    NON_BODY_HTTP_METHODS: ['GET', 'HEAD'],\n    CONTENT_TYPES: {\n        FORM_URL_ENCODED: 'application/x-www-form-urlencoded',\n        MULTIPART_FORMDATA: 'multipart/form-data',\n        OCTET_STREAM: 'application/octet-stream'\n    }\n};\n\nexport const DB_CONSTANTS = {\n    'DATABASE_MATCH_MODES': {\n        'like'             : 'LIKE',\n        'start'            : 'STARTING_WITH',\n        'startignorecase'  : 'STARTING_WITH_IGNORECASE',\n        'end'              : 'ENDING_WITH',\n        'endignorecase'    : 'ENDING_WITH_IGNORECASE',\n        'anywhere'         : 'CONTAINING',\n        'anywhereignorecase': 'CONTAINING_IGNORECASE',\n        'exact'            : 'EQUALS',\n        'exactignorecase'  : 'EQUALS_IGNORECASE',\n        'notequals'        : 'NOT_EQUALS',\n        \"notequalsignorecase\": \"NOT_EQUALS_IGNORECASE\",\n        'between'          : 'BETWEEN',\n        'in'               : 'IN',\n        \"notin\"            : \"NOTIN\",\n        'lessthan'         : 'LESS_THAN',\n        'lessthanequal'    : 'LESS_THAN_OR_EQUALS',\n        'greaterthan'      : 'GREATER_THAN',\n        'greaterthanequal' : 'GREATER_THAN_OR_EQUALS',\n        'null'             : 'NULL',\n        'isnotnull'        : 'IS_NOT_NULL',\n        'empty'            : 'EMPTY',\n        'isnotempty'       : 'IS_NOT_EMPTY',\n        'nullorempty'      : 'NULL_OR_EMPTY'\n    },\n    'DATABASE_EMPTY_MATCH_MODES': ['NULL', 'IS_NOT_NULL', 'EMPTY', 'IS_NOT_EMPTY', 'NULL_OR_EMPTY'],\n    'DATABASE_RANGE_MATCH_MODES': ['IN', 'NOTIN', 'BETWEEN', 'LESS_THAN', 'LESS_THAN_OR_EQUALS', 'GREATER_THAN', 'GREATER_THAN_OR_EQUALS', 'NOT_EQUALS'],\n    'DATABASE_NULL_EMPTY_MATCH': {\n        'NULL'          : 'NULL',\n        'IS_NOT_NULL'   : 'IS_NOT_NULL',\n        'EMPTY'         : 'NULL',\n        'IS_NOT_EMPTY'  : 'IS_NOT_NULL',\n        'NULL_OR_EMPTY' : 'NULL'\n    },\n    'DATABASE_MATCH_MODES_WITH_QUERY': {\n        'LIKE'                   : '${0} like ${1}',\n        'STARTING_WITH'          : '${0} like ${1}',\n        'STARTING_WITH_IGNORECASE': '${0} like ${1}',\n        'ENDING_WITH'            : '${0} like ${1}',\n        'ENDING_WITH_IGNORECASE' : '${0} like ${1}',\n        'CONTAINING'             : '${0} like ${1}',\n        'CONTAINING_IGNORECASE'  : '${0} like ${1}',\n        'EQUALS'                 : '${0}=${1}',\n        'EQUALS_IGNORECASE'      : '${0}=${1}',\n        'NOT_EQUALS'             : '${0}!=${1}',\n        \"NOT_EQUALS_IGNORECASE\"  : \"${0}!=${1}\",\n        'BETWEEN'                : '${0} between ${1}',\n        'IN'                     : '${0} in ${1}',\n        'NOTIN'                  : \"${0} not in ${1}\",\n        'LESS_THAN'              : '${0}<${1}',\n        'LESS_THAN_OR_EQUALS'    : '${0}<=${1}',\n        'GREATER_THAN'           : '${0}>${1}',\n        'GREATER_THAN_OR_EQUALS' : '${0}>=${1}',\n        'NULL'                   : '${0} is null',\n        'IS_NOT_NULL'            : '${0} is not null',\n        'EMPTY'                  : '${0}=\\'\\'',\n        'IS_NOT_EMPTY'           : '${0}<>\\'\\'',\n        'NULL_OR_EMPTY'          : '${0} is null or ${0}=\\'\\''\n    },\n    'DATABASE_STRING_MODES': ['LIKE', 'STARTING_WITH', 'STARTING_WITH_IGNORECASE', 'ENDING_WITH', 'ENDING_WITH_IGNORECASE', 'CONTAINING', 'CONTAINING_IGNORECASE', 'EQUALS', 'EQUALS_IGNORECASE', 'NOT_EQUALS', \"NOT_EQUALS_IGNORECASE\"]\n};\n\nexport const SWAGGER_CONSTANTS = {\n    WM_DATA_JSON: 'wm_data_json',\n    WM_HTTP_JSON: 'wm_httpRequestDetails'\n};\n\nexport const VARIABLE_URLS = {\n    DATABASE: {\n    searchTableData: {\n        url: '/:service/:dataModelName/:entityName/search?page=:page&size=:size&:sort',\n            method: 'POST'\n    },\n    searchTableDataWithQuery: {\n        url: '/:service/:dataModelName/:entityName/filter?page=:page&size=:size&:sort',\n            method: 'POST',\n            headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n        }\n    },\n    readTableData: {\n        url: '/:service/:dataModelName/:entityName?page=:page&size=:size&:sort',\n            method: 'GET'\n    },\n    insertTableData: {\n        url: '/:service/:dataModelName/:entityName',\n            method: 'POST'\n    },\n    insertMultiPartTableData: {\n        url: '/:service/:dataModelName/:entityName',\n            method: 'POST',\n            headers: {}\n            // ,transformRequest: WM.identity\n    },\n    updateTableData: {\n        url: '/:service/:dataModelName/:entityName/:id',\n            method: 'PUT'\n    },\n    updateMultiPartTableData: {\n        url: '/:service/:dataModelName/:entityName/:id',\n            method: 'POST',\n            headers: {}\n            // ,transformRequest: WM.identity\n    },\n    deleteTableData: {\n        url: '/:service/:dataModelName/:entityName/:id',\n            method: 'DELETE'\n    },\n    updateCompositeTableData: {\n        url: '/:service/:dataModelName/:entityName/composite-id?:id',\n            method: 'PUT'\n    },\n    periodUpdateCompositeTableData: {\n        url: '/:service/:dataModelName/:entityName/composite-id/periods?:id',\n            method: 'PUT'\n    },\n    updateMultiPartCompositeTableData: {\n        url: '/:service/:dataModelName/:entityName/composite-id?:id',\n            method: 'POST',\n            headers: {}\n            // , transformRequest: WM.identity\n    },\n    deleteCompositeTableData: {\n        url: '/:service/:dataModelName/:entityName/composite-id?:id',\n            method: 'DELETE'\n    },\n    periodDeleteCompositeTableData: {\n        url: '/:service/:dataModelName/:entityName/composite-id/periods?:id',\n            method: 'DELETE'\n    },\n    getDistinctDataByFields: {\n        url: '/:service/:dataModelName/:entityName/aggregations?page=:page&size=:size&:sort',\n            method: 'POST'\n    },\n    exportTableData: {\n        url: '/services/:dataModelName/:entityName/export?:sort',\n            method: 'POST'\n    },\n    readTableRelatedData: {\n        url: '/:service/:dataModelName/:entityName/:id/:relatedFieldName?page=:page&size=:size&:sort',\n            method: 'GET'\n    },\n    executeNamedQuery: {\n        url: '/:service/:dataModelName/queryExecutor/queries/:queryName?page=:page&size=:size&:queryParams',\n            method: 'GET'\n    },\n    executeCustomQuery: {\n        url: '/:service/:dataModelName/queries/execute?page=:page&size=:size',\n            method: 'POST'\n    },\n    executeAggregateQuery: {\n        url: '/services/:dataModelName/:entityName/aggregations?page=:page&size=:size&sort=:sort',\n            method: 'POST'\n    },\n    executeNamedProcedure: {\n        url: '/:service/:dataModelName/procedureExecutor/procedure/execute/:procedureName?page=:page&size=:size&:procedureParams',\n            method: 'GET'\n    },\n    countTableDataWithQuery : {\n        url: '/:service/:dataModelName/:entityName/count',\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n        }\n    }\n},\n    oauthConfiguration : {\n        getAuthorizationUrl: {\n            url: 'services/oauth2/:providerId/authorizationUrl',\n                method: 'GET'\n        }\n    }\n};\n\nexport const $rootScope = {\n    project: {\n        deployedUrl: './',\n        id: 'temp_id'\n    },\n    projectName: 'test_project_name',\n    isApplicationType: true\n};\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [0, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; }; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator];\r\n    return m ? m.call(o) : typeof __values === \"function\" ? __values(o) : o[Symbol.iterator]();\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { extractType, DataType, DEFAULT_FORMATS, $parseEvent, $watch, findValueOf, getBlob, getClonedObject, stringStartsWith, triggerFn } from '@wm/core';\n\nimport { CONSTANTS, VARIABLE_CONSTANTS, WS_CONSTANTS } from '../../constants/variables.constants';\n\ndeclare const window, _, $, moment;\n\nconst exportTypesMap   = { 'EXCEL' : '.xlsx', 'CSV' : '.csv'};\n\nexport let appManager;\nexport let httpService;\nexport let metadataService;\nexport let navigationService;\nexport let routerService;\nexport let toasterService;\nexport let oauthService;\nexport let securityService;\nexport let dialogService;\n\nconst DOT_EXPR_REX = /^\\[(\"|')[\\w\\W]*(\\1)\\]$/,\n    internalBoundNodeMap = new Map(),\n    timers = new Map();\n\nconst _invoke = (variable, op) => {\n    let debouncedFn,\n        cancelFn = _.noop,\n        retVal;\n    if (timers.has(variable)) {\n        cancelFn = timers.get(variable).cancel;\n    }\n    cancelFn();\n    debouncedFn = _.debounce(function () {\n        retVal = variable[op]();\n        // handle promises to avoid uncaught promise errors in console\n        if (retVal instanceof Promise) {\n            retVal.catch(_.noop);\n        }\n    }, 100);\n    timers.set(variable, debouncedFn);\n    debouncedFn();\n};\n\nconst processVariablePostBindUpdate = (nodeName, nodeVal, nodeType, variable, noUpdate) => {\n    switch (variable.category) {\n        case VARIABLE_CONSTANTS.CATEGORY.LIVE:\n            if (variable.operation === 'read') {\n                if (nodeName === 'dataBinding') {\n                    _.forEach(nodeVal, function (val, key) {\n                        variable.filterFields[key] = {\n                            'value': val\n                        };\n                    });\n                } else {\n                    variable.filterFields[nodeName] = {\n                        'value': nodeVal,\n                        'type' : nodeType\n                    };\n                }\n                /* if auto-update set for the variable with read operation only, get its data */\n                if (variable.autoUpdate && !_.isUndefined(nodeVal) && _.isFunction(variable.listRecords) && !noUpdate) {\n                    _invoke(variable, 'listRecords');\n                }\n            } else {\n                if (nodeName === 'dataBinding') {\n                    variable.inputFields = nodeVal;\n                } else {\n                    variable.inputFields[nodeName] = nodeVal;\n                }\n                /* if auto-update set for the variable with read operation only, get its data */\n                if (variable.autoUpdate && !_.isUndefined(nodeVal) && _.isFunction(variable[variable.operation + 'Record']) && !noUpdate) {\n                    _invoke(variable, variable.operation + 'Record');\n                }\n            }\n            break;\n        case VARIABLE_CONSTANTS.CATEGORY.SERVICE:\n        case VARIABLE_CONSTANTS.CATEGORY.LOGIN:\n            if (variable.autoUpdate && !_.isUndefined(nodeVal) && _.isFunction(variable.invoke) && !noUpdate) {\n                _invoke(variable, 'invoke');\n            }\n            break;\n        case VARIABLE_CONSTANTS.CATEGORY.DEVICE:\n            variable[nodeName] = nodeVal;\n            if (variable.autoUpdate && !_.isUndefined(nodeVal) && _.isFunction(variable.invoke) && !noUpdate) {\n                _invoke(variable, 'invoke');\n            }\n            break;\n    }\n};\n\nexport const setDependency = (type: string, ref: any) => {\n    switch (type) {\n        case 'appManager':\n            appManager = ref;\n            break;\n        case 'http':\n            httpService = ref;\n            break;\n        case 'metadata':\n            metadataService = ref;\n            break;\n        case 'navigationService':\n            navigationService = ref;\n            break;\n        case 'router':\n            routerService = ref;\n            break;\n        case 'toaster':\n            toasterService =  ref;\n            break;\n        case 'oAuth':\n            oauthService =  ref;\n            break;\n        case 'security':\n            securityService =  ref;\n            break;\n        case 'dialog':\n            dialogService = ref;\n            break;\n    }\n};\n\nexport const initiateCallback = (type: string, variable: any, data: any, options?: any, skipDefaultNotification?: boolean) => {\n\n    /*checking if event is available and variable has event property and variable event property bound to function*/\n    const eventValues = variable[type],\n        callBackScope = variable._context;\n    let errorVariable;\n    /**\n     * For error event:\n     * trigger app level error handler.\n     * if no event is assigned, trigger default appNotification variable.\n     */\n   if (type === VARIABLE_CONSTANTS.EVENT.ERROR && !skipDefaultNotification) {\n        if (!eventValues) {\n            /* in case of error, if no event assigned, handle through default notification variable */\n            errorVariable = callBackScope.Actions[VARIABLE_CONSTANTS.DEFAULT_VAR.NOTIFICATION];\n            if (errorVariable) {\n                data = errorVariable.getMessage() || data;\n                data = _.isString(data) ? data : 'An error has occured. Please check the app logs.';\n                errorVariable.invoke({ 'message' : data}, undefined, undefined);\n                 // $rootScope.$evalAsync(function () {\n                    // $rootScope.$emit(\"invoke-service\", VARIABLE_CONSTANTS.DEFAULT_VAR.NOTIFICATION, {scope: callBackScope, message: response});\n                // });\n            }\n        }\n    }\n    // TODO: [Vibhu], check whether to support legacy event calling mechanism (ideally, it should have been migrated)\n    const fn = $parseEvent(variable[type]);\n    if (type === VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE) {\n        if (variable.category === 'wm.LiveVariable' && variable.operation === 'read') {\n            return fn(variable._context, {variable: variable, dataFilter: data});\n        } else {\n            return fn(variable._context, {variable: variable, inputData: data});\n        }\n    } else {\n        return fn(variable._context, {variable: variable, data: data, options: options});\n    }\n};\n\nconst triggerOnTimeout = (success) => {\n    setTimeout(() => { triggerFn(success); }, 500);\n};\n\nconst downloadFilefromResponse = (response, headers, success, error) => {\n    // check for a filename\n    let filename = '',\n        filenameRegex,\n        matches,\n        type,\n        blob,\n        URL,\n        downloadUrl,\n        popup;\n    const disposition = headers.get('Content-Disposition');\n    if (disposition && disposition.indexOf('attachment') !== -1) {\n        filenameRegex = /filename[^;=\\n]*=((['\"]).*?\\2|[^;\\n]*)/;\n        matches = filenameRegex.exec(disposition);\n        if (matches !== null && matches[1]) {\n            filename = matches[1].replace(/['\"]/g, '');\n        }\n    }\n\n    type = headers.get('Content-Type');\n    blob = new Blob([response], { type: type });\n\n    if (typeof window.navigator.msSaveBlob !== 'undefined') {\n        // IE workaround for \"HTML7007: One or more blob URLs were revoked by closing the blob for which they were created. These URLs will no longer resolve as the data backing the URL has been freed.\"\n        if (window.navigator.msSaveBlob(blob, filename)) {\n            triggerOnTimeout(success);\n        } else {\n            triggerFn(error);\n        }\n    } else {\n        URL         = window.URL || window.webkitURL;\n        downloadUrl = URL.createObjectURL(blob);\n\n        if (filename) {\n            // use HTML5 a[download] attribute to specify filename\n            const a = document.createElement('a');\n            let reader;\n            // safari doesn't support this yet\n            if (typeof a.download === 'undefined') {\n                reader = new FileReader();\n                reader.onloadend = function () {\n                    const url = reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\n                    popup = window.open(url, '_blank');\n                    if (!popup) {\n                        window.location.href = url;\n                    }\n                };\n                reader.onload = triggerOnTimeout.bind(undefined, success);\n                reader.onerror = error;\n                reader.readAsDataURL(blob);\n            } else {\n                a.href = downloadUrl;\n                a.download = filename;\n                document.body.appendChild(a);\n                a.click();\n                triggerOnTimeout(success);\n            }\n        } else {\n            popup = window.open(downloadUrl, '_blank');\n            if (!popup) {\n                window.location.href = downloadUrl;\n            }\n        }\n\n        setTimeout(() => { URL.revokeObjectURL(downloadUrl); }, 100); // cleanup\n    }\n};\n\nconst getService = (serviceName) => {\n    if (!serviceName) {\n        return;\n    }\n    return serviceName;\n    // Todo: Shubham, uncomment below code\n    /* /!* get a reference to the element where ng-app is defined *!/\n     let appEl = WM.element('[id=ng-app]'), injector;\n     if (appEl) {\n     try {\n     injector = appEl.injector(); // get the angular injector\n     if (injector) {\n     return injector.get(serviceName); // return the service\n     }\n     } catch (e) {\n     return undefined;\n     }\n     }*/\n};\n\n/**\n * Construct the form data params from the URL\n * @param queryParams\n * @param params\n */\nconst setParamsFromURL = (queryParams, params) => {\n    queryParams = _.split(queryParams, '&');\n    _.forEach(queryParams, function (param) {\n        param = _.split(param, '=');\n        params[param[0]] = decodeURIComponent(_.join(_.slice(param, 1), '='));\n    });\n};\n\n/**\n * [Todo: Shubham], Implement Download through I frame\n * Simulates file download in an app through creating and submitting a hidden form in DOM.\n * The action will be initiated through a Service Variable\n *\n * Query Params\n * The request params like query params are added as hidden input elements\n *\n * Header Params\n * The header params for a request are also added along with hidden input elements.\n * This is done as headers can not be set for a form POST call from JavaScript\n *\n * Finally, request parameters are sent as follows:\n * For a GET request, the request data is sent along with the query params.\n * For POST, it is sent as request body.\n *\n * @param variable: the variable that is called from user action\n * @param requestParams object consisting the info to construct the XHR request for the service\n */\nconst downloadThroughIframe = (requestParams, success) => {\n    // Todo: SHubham: URL contains '//' in between which should be handled at the URL formation only\n    if (requestParams.url[1] === '/' && requestParams.url[2] === '/') {\n        requestParams.url = requestParams.url.slice(0, 1) + requestParams.url.slice(2);\n    }\n    let iFrameElement,\n        formEl,\n        paramElement,\n        queryParams     = '';\n    const IFRAME_NAME     = 'fileDownloadIFrame',\n        FORM_NAME       = 'fileDownloadForm',\n        CONTENT_TYPE    = 'Content-Type',\n        url             = requestParams.url,\n        encType         = _.get(requestParams.headers, CONTENT_TYPE),\n        params          = _.pickBy(requestParams.headers, function (val, key) {return key !== CONTENT_TYPE; });\n    /* Todo: shubham : define getService method\n     WS_CONSTANTS    = getService('WS_CONSTANTS');*/\n\n    /* look for existing iframe. If exists, remove it first */\n    iFrameElement = $('#' + IFRAME_NAME);\n    if (iFrameElement.length) {\n        iFrameElement.first().remove();\n    }\n    iFrameElement = $('<iframe id=\"' + IFRAME_NAME + '\" name=\"' + IFRAME_NAME + '\" class=\"ng-hide\"></iframe>');\n    formEl        = $('<form id=\"' + FORM_NAME + '\" name=\"' + FORM_NAME + '\"></form>');\n    formEl.attr({\n        'target'  : iFrameElement.attr('name'),\n        'action'  : url,\n        'method'  : requestParams.method,\n        'enctype' : encType\n    });\n\n    /* process query params, append a hidden input element in the form against each param */\n    queryParams += url.indexOf('?') !== -1 ? url.substring(url.indexOf('?') + 1) : '';\n    queryParams += encType === WS_CONSTANTS.CONTENT_TYPES.FORM_URL_ENCODED ? ((queryParams ? '&' : '') + requestParams.dataParams) : '';\n\n    // For Non body methods only, set the input fields from query parameters\n    if (_.includes(WS_CONSTANTS.NON_BODY_HTTP_METHODS, _.toUpper(requestParams.method))) {\n        setParamsFromURL(queryParams, params); // Set params for URL query params\n    }\n    setParamsFromURL(requestParams.data, params); // Set params for request data\n    _.forEach(params, function (val, key) {\n        paramElement = $('<input type=\"hidden\">');\n        paramElement.attr({\n            'name'  : key,\n            'value' : val\n        });\n        formEl.append(paramElement);\n    });\n\n    /* append form to iFrame and iFrame to the document and submit the form */\n    $('body').append(iFrameElement);\n\n    // timeout for IE 10, iframeElement.contents() is empty in IE 10 without timeout\n    setTimeout(function () {\n        iFrameElement.contents().find('body').append(formEl);\n        formEl.submit();\n        triggerFn(success);\n    }, 100);\n};\n\n/**\n * Makes an XHR call against the config\n * the response is converted into a blob url, which is assigned to the src attribute of an anchor element with download=true\n * a click is simulated on the anchor to download the file\n * @param config\n * @param success\n * @param error\n */\nconst downloadThroughAnchor = (config, success, error) => {\n    const url     = config.url,\n        method  = config.method,\n        data    = config.dataParams || config.data,\n        headers = config.headers;\n\n    headers['Content-Type'] = headers['Content-Type'] || 'application/x-www-form-urlencoded';\n\n    // Todo: Replace http with getService\n    httpService.send({\n        'target' : 'WebService',\n        'action' : 'invokeRuntimeRestCall',\n        'method' : method,\n        'url'    : url,\n        'headers': headers,\n        'data'   : data,\n        'responseType': 'arraybuffer'\n    }).then(function (response) {\n        setTimeout(() => {\n            downloadFilefromResponse(response.body, response.headers, success, error);\n        }, 900);\n    }, function (err) {\n        triggerFn(error, err);\n    });\n};\n\n/**\n * appends a timestamp on the passed filename to prevent caching\n * returns the modified file name\n * @param fileName\n * @param exportFormat\n * @returns {string}\n */\nconst getModifiedFileName = (fileName, exportFormat) => {\n    let fileExtension;\n    const currentTimestamp = Date.now();\n\n    if (exportFormat) {\n        fileExtension = exportTypesMap[exportFormat];\n    } else {\n        fileExtension = '.' + _.last(_.split(fileName, '.'));\n        fileName = _.replace(fileName, fileExtension, '');\n    }\n    return fileName + '_' + currentTimestamp + fileExtension;\n};\n\nconst getCookieByName = (name) => {\n    // Todo: Shubham Implement cookie native js\n    return 'cookie';\n};\n\n/**\n * This function returns the cookieValue if xsrf is enabled.\n * In device, xsrf cookie is stored in localStorage.\n * @returns xsrf cookie value\n */\nconst isXsrfEnabled = () => {\n    if (CONSTANTS.hasCordova) {\n        return localStorage.getItem(CONSTANTS.XSRF_COOKIE_NAME);\n    }\n    return false;\n};\n\n/**\n * Returns the object node for a bind object, where the value has to be updated\n * obj.target = \"a\"\n * @param obj\n * @param root\n * @param variable\n * @returns {*}\n */\nconst getTargetObj = (obj, root, variable) => {\n    /*\n     * if the target key is in the form as \"['my.param']\"\n     * keep the target key as \"my.param\" and do not split further\n     * this is done, so that, the computed value against this binding is assigned as\n     *      {\"my.param\": \"value\"}\n     * and not as\n     *      {\n     *          \"my\": {\n     *              \"param\": \"value\"\n     *          }\n     *      }\n     */\n    let target = obj.target,\n        targetObj;\n    const rootNode = variable[root];\n    if (DOT_EXPR_REX.test(target)) {\n        targetObj = rootNode;\n    } else {\n        target = target.substr(0, target.lastIndexOf('.'));\n        if (obj.target === root) {\n            targetObj = variable;\n        } else if (target) {\n            targetObj = findValueOf(rootNode, target, true);\n        } else {\n            targetObj = rootNode;\n        }\n    }\n    return targetObj;\n};\n\n/**\n * Gets the key for the target object\n * the computed value will be updated against this key in the targetObject(computed by getTargetObj())\n * @param target\n * @param regex\n * @returns {*}\n */\nconst getTargetNodeKey = (target) => {\n    /*\n     * if the target key is in the form as \"['my.param']\"\n     * keep the target key as \"my.param\" and do not split further\n     * this is done, so that, the computed value against this binding is assigned as\n     *      {\"my.param\": \"value\"}\n     * and not as\n     *      {\n     *          \"my\": {\n     *              \"param\": \"value\"\n     *          }\n     *      }\n     */\n    let targetNodeKey;\n    if (DOT_EXPR_REX.test(target)) {\n        targetNodeKey = target.replace(/^(\\[[\"'])|([\"']\\])$/g, '');\n    } else {\n        targetNodeKey = target.split('.').pop();\n    }\n    return targetNodeKey;\n};\n\nconst setValueToNode = (target, obj, root, variable, value, noUpdate?) => {\n    const targetNodeKey = getTargetNodeKey(target),\n        targetObj = getTargetObj(obj, root, variable);\n    value = !_.isUndefined(value) ? value : obj.value;\n    /* sanity check, user can bind parent nodes to non-object values, so child node bindings may fail */\n    if (targetObj) {\n        targetObj[targetNodeKey] = value;\n    }\n    processVariablePostBindUpdate(targetNodeKey, value, obj.type, variable, noUpdate);\n};\n\n/**\n * The model internalBoundNodeMap stores the reference to latest computed values against internal(nested) bound nodes\n * This is done so that the internal node's computed value is not lost, once its parent node's value is computed at a later point\n * E.g.\n * Variable.employeeVar has following bindings\n * \"dataBinding\": [\n     {\n         \"target\": \"department.budget\",\n         \"value\": \"bind:Variables.budgetVar.dataSet\"\n     },\n     {\n         \"target\": \"department\",\n         \"value\": \"bind:Variables.departmentVar.dataSet\"\n     }\n ]\n * When department.budget is computed, employeeVar.dataSet = {\n *  \"department\": {\n *      \"budget\": {\"q1\": 1111}\n *  }\n * }\n *\n * When department is computed\n *  \"department\": {\n *      \"name\": \"HR\",\n *      \"location\": \"Hyderabad\"\n *  }\n * The budget field (computed earlier) is LOST.\n *\n * To avoid this, the latest values against internal nodes (in this case department.budget) are stored in a map\n * These values are assigned back to internal fields if the parent is computed (in this case department)\n * @param target\n * @param root\n * @param variable\n */\nconst updateInternalNodes = (target, root, variable) => {\n    const boundInternalNodes = _.keys(_.get(internalBoundNodeMap.get(variable), [variable.name, root])),\n        targetNodeKey = getTargetNodeKey(target);\n    let internalNodes;\n    function findInternalNodeBound() {\n        return _.filter(boundInternalNodes, function (node) {\n            // the later condition in check (targetNodeKey === root || targetNodeKey === 'dataBinding') is specifically for live variable of insert/update types\n            return (node !== targetNodeKey && _.includes(node, targetNodeKey)) || ((targetNodeKey === root || targetNodeKey === 'dataBinding') && node !== targetNodeKey);\n        });\n    }\n    internalNodes = findInternalNodeBound();\n    if ((internalNodes.length)) {\n        _.forEach(internalNodes, function (node) {\n            setValueToNode(node, {target: node}, root, variable, _.get(internalBoundNodeMap.get(variable), [variable.name, root, node]));\n        });\n    }\n};\n\n/**\n * New Implementation (DataBinding Flat Structure with x-path targets)\n * processes a dataBinding object, if bound to expression, watches over it, else assigns value to the expression\n * @param obj dataBinding object\n * @param scope scope of the variable\n * @param root root node string (dataBinding for all variables, dataSet for static variable)\n * @param variable variable object\n */\nconst processBindObject = (obj, scope, root, variable) => {\n    const target = obj.target,\n        targetObj = getTargetObj(obj, root, variable),\n        targetNodeKey = getTargetNodeKey(target),\n        runMode = true;\n    const destroyFn = scope.registerDestroyListener ? scope.registerDestroyListener.bind(scope) : _.noop;\n\n    if (stringStartsWith(obj.value, 'bind:')) {\n        destroyFn(\n            $watch(obj.value.replace('bind:', ''), scope, {}, function (newVal, oldVal) {\n                if ((newVal === oldVal && _.isUndefined(newVal)) || (_.isUndefined(newVal) && (!_.isUndefined(oldVal) || !_.isUndefined(targetObj[targetNodeKey])))) {\n                    return;\n                }\n                // Skip cloning for blob column\n                if (!_.includes(['blob', 'file'], obj.type)) {\n                    newVal = getClonedObject(newVal);\n                }\n                setValueToNode(target, obj, root, variable, newVal); // cloning newVal to keep the source clean\n\n                if (runMode) {\n                    /*set the internal bound node map with the latest updated value*/\n                    if (!internalBoundNodeMap.has(variable)) {\n                        internalBoundNodeMap.set(variable, {});\n                    }\n                    _.set(internalBoundNodeMap.get(variable), [variable.name, root, target], newVal);\n                    /*update the internal nodes after internal node map is set*/\n                    if (_.isObject(newVal)) {\n                        updateInternalNodes(target, root, variable);\n                    }\n                }\n            })\n        );\n    } else if (!_.isUndefined(obj.value)) {\n        setValueToNode(target, obj, root, variable, obj.value, true);\n        if (runMode && root !== targetNodeKey) {\n            if (!internalBoundNodeMap.has(variable)) {\n                internalBoundNodeMap.set(variable, {});\n            }\n            _.set(internalBoundNodeMap.get(variable), [variable.name, root, target], obj.value);\n        }\n    }\n};\n\n// *********************************************************** PUBLIC *********************************************************** //\n\n/**\n * Initializes watchers for binding expressions configured in the variable\n * @param variable\n * @param context, scope context in which the variable exists\n * @param {string} bindSource,  the field in variable where the databindings are configured\n *                              for most variables, it will be 'dataBinding', hence default fallback is to 'dataBinding'\n *                              for some it can be 'dataSet' and hence will be passed as param\n * @param {string} bindTarget, the object field in variable where the computed bindings will be set\n */\nexport const processBinding = (variable: any, context: any, bindSource?: string, bindTarget?: string) => {\n    bindSource = bindSource || 'dataBinding';\n    bindTarget = bindTarget || 'dataBinding';\n\n    const bindMap = variable[bindSource];\n    variable[bindSource] = {};\n    variable['_bind' + bindSource] = bindMap;\n    if (!bindMap) {\n        return;\n    }\n    bindMap.forEach(function (node) {\n        /* for static variable change the binding with target 'dataBinding' to 'dataSet', as the results have to reflect directly in the dataSet */\n        if (variable.category === 'wm.Variable' && node.target === 'dataBinding') {\n            node.target = 'dataSet';\n        }\n        processBindObject(node, context, bindTarget, variable);\n    });\n};\n\n/**\n * Downloads a file in the browser.\n * Two methods to do so, namely:\n * 1. downloadThroughAnchor, called if\n *      - if a header is to be passed\n *      OR\n *      - if security is ON and XSRF token is to be sent as well\n * NOTE: This method does not work with Safari version 10.0 and below\n *\n * 2. downloadThroughIframe\n *      - this method works across browsers and uses an iframe to downlad the file.\n * @param requestParams request params object\n * @param fileName represents the file name\n * @param exportFormat downloaded file format\n * @param success success callback\n * @param error error callback\n */\nexport const simulateFileDownload = (requestParams, fileName, exportFormat, success, error) => {\n    /*success and error callbacks are executed incase of downloadThroughAnchor\n     Due to technical limitation cannot be executed incase of iframe*/\n    if (CONSTANTS.hasCordova) {\n        let fileExtension;\n        if (exportFormat) {\n            fileExtension = exportTypesMap[exportFormat];\n        }\n        appManager.notify('device-file-download', { url: requestParams.url, name: fileName, extension: fileExtension, successCb: success, errorCb: error});\n    } else if (!_.isEmpty(requestParams.headers) || isXsrfEnabled()) {\n        downloadThroughAnchor(requestParams, success, error);\n    } else {\n        downloadThroughIframe(requestParams, success);\n    }\n};\n\n/**\n * sets the value against passed key on the \"inputFields\" object in the variable\n * @param targetObj: the object in which the key, value is to be set\n * @param variable\n * @param key: can be:\n *  - a string e.g. \"username\"\n *  - an object, e.g. {\"username\": \"john\", \"ssn\": \"11111\"}\n * @param val\n * - if key is string, the value against it (for that data type)\n * - if key is object, not required\n * @param options\n * @returns {any}\n */\nexport const setInput = (targetObj: any, key: any, val: any, options: any) => {\n    targetObj = targetObj || {};\n    let keys,\n        lastKey,\n        paramObj = {};\n\n    // content type check\n    if (_.isObject(options)) {\n        switch (options.type) {\n            case 'file':\n                val = getBlob(val, options.contentType);\n                break;\n            case 'number':\n                val = _.isNumber(val) ? val : parseInt(val, 10);\n                break;\n        }\n    }\n\n    if (_.isObject(key)) {\n        // check if the passed parameter is an object itself\n        paramObj = key;\n    } else if (key.indexOf('.') > -1) {\n        // check for '.' in key e.g. 'employee.department'\n        keys = key.split('.');\n        lastKey = keys.pop();\n        // Finding the object based on the key\n        targetObj = findValueOf(targetObj, keys.join('.'), true);\n        key = lastKey;\n        paramObj[key] = val;\n    } else {\n        paramObj[key] = val;\n    }\n\n    _.forEach(paramObj, function (paramVal, paramKey) {\n        targetObj[paramKey] = paramVal;\n    });\n    return targetObj;\n};\n\n/**\n * returns true if HTML5 File API is available else false\n * @returns {{prototype: Blob; new(blobParts?: any[], options?: BlobPropertyBag): Blob}}\n */\nexport const isFileUploadSupported = () => {\n    return (window.File && window.FileReader && window.FileList && window.Blob);\n};\n\n/**\n *\n * @param varOrder\n * @param optionsOrder\n * @returns {any}\n */\nexport const getEvaluatedOrderBy = (varOrder, optionsOrder) => {\n    let optionFields,\n        varOrderBy;\n    // If options order by is not defined, return variable order\n    if (!optionsOrder || _.isEmpty(optionsOrder)) {\n        return varOrder;\n    }\n    // If variable order by is not defined, return options order\n    if (!varOrder) {\n        return optionsOrder;\n    }\n    // If both are present, combine the options order and variable order, with options order as precedence\n    varOrder     = _.split(varOrder, ',');\n    optionsOrder = _.split(optionsOrder, ',');\n    optionFields = _.map(optionsOrder, function (order) {\n        return _.split(_.trim(order), ' ')[0];\n    });\n    // If a field is present in both options and variable, remove the variable orderby\n    _.remove(varOrder, function (orderBy) {\n        return _.includes(optionFields, _.split(_.trim(orderBy), ' ')[0]);\n    });\n    varOrderBy = varOrder.length ? ',' + _.join(varOrder, ',') : '';\n    return _.join(optionsOrder, ',') + varOrderBy;\n};\n\n/**\n * formatting the expression as required by backend which was enclosed by ${<expression>}.\n * @param fieldDefs\n * returns fieldDefs\n */\nexport const formatExportExpression = fieldDefs => {\n    _.forEach(fieldDefs, function (fieldDef) {\n        if (fieldDef.expression) {\n            fieldDef.expression = '${' + fieldDef.expression + '}';\n        }\n    });\n    return fieldDefs;\n};\n\nexport const debounceVariableCall = _invoke;\n\nconst getDateTimeFormatForType = (type) => {\n    return DEFAULT_FORMATS[_.toUpper(type)];\n};\n\n// Format value for datetime types\nconst _formatDate = (dateValue, type) => {\n    let epoch;\n    if (_.isDate(dateValue)) {\n        epoch = dateValue.getTime();\n    } else {\n        if (!isNaN(dateValue)) {\n            dateValue = parseInt(dateValue, 10);\n        }\n        epoch = dateValue && moment(dateValue).valueOf();\n    }\n    if (type === DataType.TIMESTAMP) {\n        return epoch;\n    }\n    if (type === DataType.TIME && !epoch) {\n        epoch = moment(new Date().toDateString() + ' ' + dateValue).valueOf();\n    }\n    return dateValue && appManager.getPipe('date').transform(epoch, getDateTimeFormatForType(type));\n};\n\n// Function to convert values of date time types into default formats\nexport const formatDate = (value, type) => {\n    if (_.includes(type, '.')) {\n        type = _.toLower(extractType(type));\n    }\n    if (_.isArray(value)) {\n        return _.map(value, function (val) {\n            return _formatDate(val, type);\n        });\n    }\n    return _formatDate(value, type);\n};\n","import { triggerFn } from '@wm/core';\n\nimport { NotifyPromise } from './notify-promise';\nimport { httpService } from './variable/variables.utils';\n\ndeclare const _;\n\nenum HTTP_EVENT_TYPE {\n    Sent = 0,\n    UploadProgress = 1,\n    ResponseHeader = 2,\n    DownloadProgress = 3,\n    Response= 4,\n    User = 5\n}\n\nenum UPLOAD_STATUS {\n    QUEUED        = 'queued',\n    IN_PROGRESS   = 'inprogress',\n    SUCCESS       = 'success',\n    ERROR         = 'error',\n    ABORTED       = 'abort'\n}\n\nfunction transformEvent(event) {\n    event.target = event.target || {\n        status: event.responseCode,\n        response: event.response\n    };\n    return event;\n}\n\nclass FileTransferObject {\n    name: string;\n    size: string;\n    status: string;\n    transferFn: Function;\n    abortFn: Function;\n    promise: any;\n    progress: number;\n\n    constructor(file, transferFn, promise, abortFn) {\n        this.name = file.name;\n        this.size = file.size || '';\n        this.status = UPLOAD_STATUS.QUEUED;\n        this.transferFn = transferFn;\n        this.promise = promise;\n        this.abortFn = abortFn;\n    }\n\n    start() {\n        if (this.status === UPLOAD_STATUS.QUEUED) {\n            this.status = UPLOAD_STATUS.IN_PROGRESS;\n            triggerFn(this.transferFn);\n        }\n    }\n\n    then(onSuccess, onError, onProgress) {\n        const self = this;\n        this.promise.then(function (event) {\n            self.status = UPLOAD_STATUS.SUCCESS;\n            triggerFn(onSuccess, event);\n        }, function (event) {\n            self.status = UPLOAD_STATUS.ERROR;\n            triggerFn(onError, event);\n        }, function (event) {\n            self.progress = Math.round(event.loaded / event.total * 100);\n            triggerFn(onProgress, event);\n        });\n        return this;\n    }\n\n    finally(onFinal?) {\n        this.promise.finally(onFinal);\n    }\n\n    /* aborts the file upload */\n    abort() {\n        this.status = UPLOAD_STATUS.ABORTED;\n        triggerFn(this.abortFn);\n        this.finally();\n    }\n\n}\n\nclass AjaxFileTransferObject extends FileTransferObject {\n    constructor(file, transferFn, promise, abortFn) {\n        super(file, transferFn, promise, abortFn);\n    }\n}\n\n/* upload file using fileTransfer */\nfunction uploadWithFileTransfer(file, url, options) {}\n\nfunction appendFileToFormData(file, fd, options) {\n    /* append file to form data */\n    if (_.isArray(file)) {\n        _.forEach(file, function (fileObject) {\n            fd.append(options.paramName, fileObject.content || fileObject, fileObject.name);\n        });\n    } else if (_.isObject(file)) {\n        fd.append(options.paramName, file.content || file, file.name);\n    }\n}\n\n/* upload file with ajax calling */\nfunction uploadWithAjax(file, fd, url, options) {\n    const cloneFD = new FormData();\n    const iterate = (value, key) => {\n        const fileObject = (_.isArray(value) ? value[0] : value);\n        if (!(fileObject instanceof File || fileObject instanceof Blob)) {\n            cloneFD.append(key, value);\n        }\n    };\n    // The foreeach method on form data doesn't exist in IE. Hence we check if it exists\n    // or else use the lodash forEach\n    if (fd.forEach) {\n        fd.forEach(iterate);\n    } else {\n        _.forEach(fd, iterate);\n    }\n    appendFileToFormData(file, cloneFD, options);\n\n    const promise = new NotifyPromise((resolve, reject, notify) => {\n        const request = httpService.upload(url, cloneFD).subscribe(event => {\n            if (event.type === HTTP_EVENT_TYPE.UploadProgress) {\n                const uploadProgress = Math.round(100 * event.loaded / event.total);\n                notify(uploadProgress);\n            }\n\n            if (event.type === HTTP_EVENT_TYPE.Response) {\n                resolve(event.body);\n            }\n        });\n        file._uploadProgress = request;\n    });\n\n    return promise;\n}\n\n/* upload the file - IE9 support */\nfunction uploadWithIframe(file, url, options) {}\n\n/* upload the next file depending on the status */\nfunction starNextFileTransfer(fts) {\n    const ft = _.find(fts, function (f) {\n        return f.status === UPLOAD_STATUS.QUEUED;\n    });\n    if (ft) {\n        ft.start();\n        ft.finally(starNextFileTransfer.bind(undefined, fts));\n    }\n}\n\n/* upload the max no of files at once i.e. two at once based on max*/\nfunction startFileTransfers(fts, max) {\n    let i = 0;\n    const len = fts.length;\n    while (i < max && i < len) {\n        starNextFileTransfer(fts);\n        i++;\n    }\n}\n\nfunction isMobileApp() {\n    return false;\n}\n\n/**\n * This function uploads the file to the given url endpoint.\n *\n * @param file file to upload\n * @param url http endpoint to which the file has to be submitted.\n * @param options\n * @returns a promise to listen for success, event, onProgress.\n *  One can also abort the upload by simply calling abort function.\n */\nexport function upload(files, fd, config, options?) {\n    options = _.extend({\n        'paramName' : config.fileParamName\n    }, options);\n    return uploadWithAjax(files, fd, config.url, options);\n    // let fileTransfers = [],\n    //     url = config.uploadUrl;\n    // options = _.extend({\n    //     'paramName' : config.fileParamName\n    // }, options);\n    //\n    // if (isMobileApp()) {\n    //     _.forEach(files, function (file) {\n    //         fileTransfers.push(uploadWithFileTransfer(file, url, options));\n    //     });\n    // } else if ((window as any).FormData) {\n    //     _.forEach(files, function (file) {\n    //         fileTransfers.push(uploadWithAjax(file, url, options));\n    //     });\n    // } else {\n    //     _.forEach(files, function (file) {\n    //         fileTransfers.push(uploadWithIframe(file, url, options));\n    //     });\n    // }\n    // startFileTransfers(fileTransfers, 2);\n    // return fileTransfers;\n}\n","import { httpService, processBinding } from '../../util/variable/variables.utils';\nimport { appManager} from './../../util/variable/variables.utils';\nimport { AdvancedOptions } from '../../advanced-options';\n\ndeclare const _;\n\nexport abstract class BaseVariableManager {\n\n    initBinding(variable, bindSource?, bindTarget?) {\n        processBinding(variable, variable._context, bindSource, bindTarget);\n    }\n\n    notifyInflight(variable, status: boolean, data?: any) {\n        appManager.notify('toggle-variable-state', {\n            variable: variable,\n            active: status,\n            data: data\n        });\n    }\n\n    /**\n     * This method makes the final angular http call that returns an observable.\n     * We attach this observable to variable to cancel a network call\n     * @param requestParams\n     * @param variable\n     * @param dbOperation\n     */\n    httpCall(requestParams, variable, params?: any) {\n        return new Promise((resolve, reject) => {\n            variable._observable = httpService.sendCallAsObservable(requestParams, params).subscribe((response: any) => {\n                if (response && response.type) {\n                    resolve(response);\n                }\n            }, (err: any) => {\n                if (httpService.isPlatformSessionTimeout(err)) {\n                    // send the notification manually to hide any context spinners on page.\n                    // [TODO]: any spinners on widget listening on this variable will also go off. Need to see an approach to sovle that.\n                    this.notifyInflight(variable, false, err);\n                    err._401Subscriber.asObservable().subscribe(\n                        response => resolve(response),\n                        e => reject(e));\n                } else {\n                    reject(err);\n                }\n            });\n        });\n    }\n\n    /**\n     * This method prepares the options parameter for variable callbacks.\n     * @param xhrObj, The xhrObj to be passed\n     * @param moreOptions, any other info to be passed in the options param\n     */\n    prepareCallbackOptions(xhrObj: any, moreOptions? : any): AdvancedOptions {\n        let options: AdvancedOptions = {};\n        options['xhrObj'] = xhrObj;\n        if (moreOptions) {\n            _.extend(options, moreOptions);\n        }\n        return options;\n    }\n}\n","import { BaseVariableManager } from './base-variable.manager';\n\ndeclare const _;\n\nconst checkEmptyObject = (obj) => {\n    let isEmpty = true;\n    _.forEach(obj, (value) => {\n        if (_.isEmpty(value)) {\n          return;\n        }\n        if (!_.isObject(value)) {\n            isEmpty = false;\n        } else if (_.isArray(value)) {\n            // If array, check if array is empty or if it has only one value and the value is empty\n            isEmpty = _.isEmpty(value) || (value.length === 1 ? _.isEmpty(value[0]) : false);\n        } else {\n            // If object, loop over the object to check if it is empty or not\n            isEmpty = checkEmptyObject(value);\n        }\n        return isEmpty; // isEmpty false will break the loop\n    });\n    return isEmpty;\n};\n\nexport class ModelVariableManager extends BaseVariableManager {\n    /*\n    * Case: a LIST type static variable having only one object\n    * and the object has all fields empty, remove that object\n    */\n    removeFirstEmptyObject(variable) {\n        if (_.isArray(variable.dataSet) && variable.dataSet.length === 1 && checkEmptyObject(variable.dataSet[0])) {\n            variable.dataSet = [];\n        }\n    }\n}\n","export class NotifyPromise {\n\n    constructor(fn) {\n        const notifyQueue = [],\n            notify = status => {\n            notifyQueue.forEach(fn1 => {\n                fn1(status);\n            });\n        };\n\n        const cleanUp = function() {\n            notifyQueue.length = 0;\n        };\n\n        const p1 =  new Promise((res, rej) => {\n            fn(res, rej, notify);\n        });\n\n        (p1 as any).superThen = p1.then.bind(p1);\n        (p1 as any).then = (onResolve, onReject, onNotify) => {\n            (p1 as any).superThen(\n                response => {\n                    onResolve(response);\n                    cleanUp();\n                },\n                reason => {\n                    onResolve(reason);\n                    cleanUp();\n                }\n            );\n            if (onNotify) {\n                notifyQueue.push(onNotify);\n            }\n        };\n        return p1;\n    }\n}\n\n// let newPromise = new PromiseWithNotify((resolve, reject, notify) => {\n//     setInterval(notify, 1000);\n// })\n// console.log(newPromise)\n// newPromise.then(undefined, undefined, () => console.log(3));\n","import { oauthService } from './variable/variables.utils';\n\nexport const performAuthorization = (url, providerId, onSuccess, onError) => {\n    oauthService.perfromOAuthorization(url, providerId, onSuccess, onError);\n};\n\nexport const getAccessToken = (provider, checkLoaclStorage) => {\n    return oauthService.getAccessToken(provider, checkLoaclStorage);\n};\n\nexport const removeAccessToken = (provider) => {\n    oauthService.removeAccessToken(provider);\n}\n","import { extractType, getBlob, isDateTimeType, isDefined, replace } from '@wm/core';\n\nimport { $rootScope, CONSTANTS, SWAGGER_CONSTANTS, VARIABLE_CONSTANTS, WS_CONSTANTS } from '../../constants/variables.constants';\nimport { isFileUploadSupported } from './variables.utils';\nimport { getAccessToken } from './../oAuth.utils';\nimport { formatDate } from '../../util/variable/variables.utils';\n\ndeclare const _;\n\n/**\n * returns true if a Service variable is:\n *  - for a query/procedure\n *  - performs a PUT/POST operation, i.e, takes a Request Body as input\n * @param variable\n * @returns {any}\n */\nconst isBodyTypeQueryOrProcedure = (variable) => {\n    return (_.includes(['QueryExecution', 'ProcedureExecution'], variable.controller)) && (_.includes(['put', 'post'], variable.operationType));\n};\n\n/**\n * returns true if the variable is a Query service variable\n * @param {string} controller\n * @param {string} serviceType\n * @returns {boolean}\n */\nconst isQueryServiceVar = (controller: string, serviceType: string) => {\n    return controller === VARIABLE_CONSTANTS.CONTROLLER_TYPE.QUERY && serviceType === VARIABLE_CONSTANTS.SERVICE_TYPE.DATA;\n};\n\n/**\n * Append given value to the formdata\n * @param formData\n * @param param - Param from which value has to be taken\n * @param paramValue - Value which is to be appended to formdata\n */\nconst getFormData = (formData, param, paramValue) => {\n    const paramType = _.toLower(extractType(_.get(param, 'items.type') || param.type)),\n        paramContentType = CONSTANTS.isStudioMode ? param['x-WM-CONTENT_TYPE'] : param.contentType;\n    if (isFileUploadSupported()) {\n        if ((paramType !== 'file') && (paramContentType === 'string' || !paramContentType)) {\n            if (_.isObject(paramValue)) {\n                paramValue = JSON.stringify(paramValue);\n            }\n            formData.append(param.name, paramValue);\n        } else {\n            if (_.isArray(paramValue) && paramType === 'file') {\n                _.forEach(paramValue, function (fileObject) {\n                    formData.append(param.name, (fileObject && fileObject.content) || getBlob(fileObject), fileObject.name);\n                });\n            } else {\n                formData.append(param.name, getBlob(paramValue, paramContentType), paramValue && paramValue.name);\n            }\n        }\n        return formData;\n    }\n};\n\n/**\n * Check for missing required params and format the date/time param values\n * @param inputData\n * @param params\n * @returns {{requestBody: {}; missingParams: any[]}}\n */\nconst processRequestBody = (inputData, params) => {\n    const requestBody = {},\n        missingParams = [];\n    let paramValue;\n    _.forEach(params, function (param) {\n        paramValue = _.get(inputData, param.name);\n        if (!_.isUndefined(paramValue) && paramValue !== '' && paramValue !== null && !param.readOnly) {\n            paramValue = isDateTimeType(param.type) ? formatDate(paramValue, param.type) : paramValue;\n            // Construct ',' separated string if param is not array type but value is an array\n            if (_.isArray(paramValue) && _.toLower(extractType(param.type)) === 'string') {\n                paramValue = _.join(paramValue, ',');\n            }\n            requestBody[param.name] = paramValue;\n        } else if (param.required) {\n            missingParams.push(param.name || param.id);\n        }\n    });\n    return {\n        'requestBody': requestBody,\n        'missingParams': missingParams\n    };\n};\n\n/**\n * Done only for HTTP calls made via the proxy server\n * Goes though request headers, appends 'X-' to certain headers\n * these headers need not be processed at proxy server and should directly be passed to the server\n * e.g. Authorization, Cookie, etc.\n * @param headers\n * @returns {{}}\n */\nconst cloakHeadersForProxy = (headers) => {\n    const _headers = {},\n        UNCLOAKED_HEADERS = VARIABLE_CONSTANTS.REST_SERVICE.UNCLOAKED_HEADERS,\n        CLOAK_PREFIX = VARIABLE_CONSTANTS.REST_SERVICE.PREFIX.CLOAK_HEADER_KEY;\n    _.forEach(headers, function (val, key) {\n        if (_.includes(UNCLOAKED_HEADERS, key.toUpperCase())) {\n            _headers[key] = val;\n        } else {\n            _headers[CLOAK_PREFIX + key] = val;\n        }\n    });\n\n    return _headers;\n};\n\nexport class ServiceVariableUtils {\n    /**\n     * prepares the HTTP request info for a Service Variable\n     * @param variable\n     * @param operationInfo\n     * @param inputFields\n     * @returns {any}\n     */\n    static constructRequestParams(variable, operationInfo, inputFields) {\n        variable = variable || {};\n\n        // operationInfo is specifically null for un_authorized access\n        if (operationInfo === null) {\n            return {\n                'error' : {\n                    'type': VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.USER_UNAUTHORISED,\n                    'message': VARIABLE_CONSTANTS.REST_SERVICE.ERR_MSG.USER_UNAUTHORISED,\n                    'field': '_wmServiceOperationInfo'\n                }\n            };\n        } else if (_.isEmpty(operationInfo)) {\n            return {\n                'error' : {\n                    'type': VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.METADATA_MISSING,\n                    'message': VARIABLE_CONSTANTS.REST_SERVICE.ERR_MSG.METADATA_MISSING,\n                    'field': '_wmServiceOperationInfo'\n                }\n            };\n        }\n\n        const directPath = operationInfo.directPath || '',\n        relativePath = operationInfo.basePath ? operationInfo.basePath + operationInfo.relativePath : operationInfo.relativePath,\n        isBodyTypeQueryProcedure = isBodyTypeQueryOrProcedure(variable);\n        let queryParams = '',\n        bodyInfo,\n        headers = {},\n        requestBody,\n        url,\n        requiredParamMissing = [],\n        target,\n        pathParamRex,\n        invokeParams,\n        authDetails = null,\n        uname,\n        pswd,\n        method,\n        formData,\n        isProxyCall,\n        paramValueInfo,\n        params,\n        securityDefnObj,\n        accessToken,\n        withCredentials;\n\n        function getFormDataObj() {\n            if (formData) {\n                return formData;\n            }\n            formData = new FormData();\n            return formData;\n        }\n\n        securityDefnObj = _.get(operationInfo.securityDefinitions, '0');\n\n        if (securityDefnObj) {\n            switch (securityDefnObj.type) {\n                case VARIABLE_CONSTANTS.REST_SERVICE.SECURITY_DEFN.OAUTH2:\n                    accessToken = getAccessToken(securityDefnObj[VARIABLE_CONSTANTS.REST_SERVICE.OAUTH_PROVIDER_KEY], null);\n                    if (accessToken) {\n                        headers[VARIABLE_CONSTANTS.REST_SERVICE.AUTH_HDR_KEY] = VARIABLE_CONSTANTS.REST_SERVICE.PREFIX.AUTH_HDR_VAL.OAUTH + ' ' + accessToken;\n                    } else {\n                        return {\n                            'error': {\n                                'type' : VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.NO_ACCESSTOKEN,\n                                'message' : VARIABLE_CONSTANTS.REST_SERVICE.ERR_MSG.NO_ACCESSTOKEN\n                            },\n                            'securityDefnObj': securityDefnObj\n                        };\n                    }\n                    break;\n                case VARIABLE_CONSTANTS.REST_SERVICE.SECURITY_DEFN.BASIC:\n                    uname = inputFields['wm_auth_username'];\n                    pswd = inputFields['wm_auth_password'];\n                    if (uname && pswd) {\n                        // TODO[VIBHU]: bas64 encoding alternative.\n                        headers[VARIABLE_CONSTANTS.REST_SERVICE.AUTH_HDR_KEY] = VARIABLE_CONSTANTS.REST_SERVICE.PREFIX.AUTH_HDR_VAL.BASIC + ' ' + btoa(uname + ':' + pswd);\n                        authDetails = {\n                            'type': VARIABLE_CONSTANTS.REST_SERVICE.AUTH_TYPE.BASIC\n                        };\n                    } else {\n                        return {\n                            'error': {\n                                'type' : VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.NO_CREDENTIALS,\n                                'message': VARIABLE_CONSTANTS.REST_SERVICE.ERR_MSG.NO_CREDENTIALS\n                            },\n                            'securityDefnObj': securityDefnObj\n                        };\n                    }\n                    break;\n            }\n        }\n        operationInfo.proxySettings = operationInfo.proxySettings || {web: true, mobile: false};\n        method = operationInfo.httpMethod || operationInfo.methodType;\n        isProxyCall = (function () {\n            if (CONSTANTS.hasCordova) {\n                return operationInfo.proxySettings.mobile;\n            }\n            return operationInfo.proxySettings.web;\n        }());\n        withCredentials = operationInfo.proxySettings.withCredentials;\n        url = isProxyCall ? relativePath : directPath;\n\n        /* loop through all the parameters */\n        _.forEach(operationInfo.parameters, function (param) {\n            // Set params based on current workspace\n            function setParamsOfChildNode() {\n                if (inputFields) {\n                    // specific case for body type query/procedure variable with query params\n                    if (inputFields[param.name] && _.isObject(inputFields[param.name])) {\n                        paramValueInfo = inputFields[param.name];\n                    } else {\n                        paramValueInfo = inputFields;\n                    }\n                    params = _.get(operationInfo, ['definitions', param.type]);\n                } else {\n                    // For Api Designer\n                    paramValueInfo = paramValue || {};\n                    params = param.children;\n                }\n            }\n\n            let paramValue = param.sampleValue;\n\n            if ((isDefined(paramValue) && paramValue !== null && paramValue !== '') || (isBodyTypeQueryProcedure && param.type !== 'file')) {\n                // Format dateTime params for dataService variables\n                if (variable.serviceType === VARIABLE_CONSTANTS.SERVICE_TYPE.DATA && isDateTimeType(param.type)) {\n                    paramValue = formatDate(paramValue, param.type);\n                }\n                // Construct ',' separated string if param is not array type but value is an array\n                if (_.isArray(paramValue) && _.toLower(extractType(param.type)) === 'string' && variable.serviceType === VARIABLE_CONSTANTS.SERVICE_TYPE.DATA) {\n                    paramValue = _.join(paramValue, ',');\n                }\n                switch (param.parameterType.toUpperCase()) {\n                    case 'QUERY':\n                        // Ignore null valued query params for queryService variable\n                        if (_.isNull(paramValue) && isQueryServiceVar(variable.controller, variable.serviceType)) {\n                            break;\n                        }\n                        if (!queryParams) {\n                            queryParams = '?' + param.name + '=' + encodeURIComponent(paramValue);\n                        } else {\n                            queryParams += '&' + param.name + '=' + encodeURIComponent(paramValue);\n                        }\n                        break;\n                    case 'PATH':\n                        /* replacing the path param based on the regular expression in the relative path */\n                        pathParamRex = new RegExp('\\\\s*\\\\{\\\\s*' + param.name + '(:\\\\.\\\\+)?\\\\s*\\\\}\\\\s*');\n                        url = url.replace(pathParamRex, paramValue);\n                        break;\n                    case 'HEADER':\n                        headers[param.name] = paramValue;\n                        break;\n                    case 'BODY':\n                        // For post/put query methods wrap the input\n                        if (isBodyTypeQueryProcedure) {\n                            setParamsOfChildNode();\n                            bodyInfo = processRequestBody(paramValueInfo, params);\n                            requestBody = bodyInfo.requestBody;\n                            requiredParamMissing = _.concat(requiredParamMissing, bodyInfo.missingParams);\n                        } else {\n                            requestBody = paramValue;\n                        }\n                        break;\n                    case 'FORMDATA':\n                        if (isBodyTypeQueryProcedure && param.name === SWAGGER_CONSTANTS.WM_DATA_JSON) {\n                            setParamsOfChildNode();\n                            // Process query/procedure formData non-file params params\n                            bodyInfo = processRequestBody(paramValueInfo, params);\n                            requestBody = getFormData(getFormDataObj(), param, bodyInfo.requestBody);\n                            requiredParamMissing = _.concat(requiredParamMissing, bodyInfo.missingParams);\n                        } else {\n                            requestBody = getFormData(getFormDataObj(), param, paramValue);\n                        }\n                        break;\n                }\n            } else if (param.required) {\n                requiredParamMissing.push(param.name || param.id);\n            }\n        });\n\n        // if required param not found, return error\n        if (requiredParamMissing.length) {\n            return {\n                'error': {\n                    'type': VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.REQUIRED_FIELD_MISSING,\n                    'field': requiredParamMissing.join(','),\n                    'message': replace(VARIABLE_CONSTANTS.REST_SERVICE.ERR_MSG.REQUIRED_FIELD_MISSING, [requiredParamMissing.join(',')]),\n                    'skipDefaultNotification': true\n                }\n            };\n        }\n\n        // Setting appropriate content-Type for request accepting request body like POST, PUT, etc\n        if (!_.includes(WS_CONSTANTS.NON_BODY_HTTP_METHODS, _.toUpper(method))) {\n            /*Based on the formData browser will automatically set the content type to 'multipart/form-data' and webkit boundary*/\n            if (!(operationInfo.consumes && (operationInfo.consumes[0] === WS_CONSTANTS.CONTENT_TYPES.MULTIPART_FORMDATA))) {\n                headers['Content-Type'] = (operationInfo.consumes && operationInfo.consumes[0]) || 'application/json';\n            }\n        }\n\n        // if the consumes has application/x-www-form-urlencoded and\n        // if the http request of given method type can have body send the queryParams as Form Data\n        if (_.includes(operationInfo.consumes, WS_CONSTANTS.CONTENT_TYPES.FORM_URL_ENCODED)\n            && !_.includes(WS_CONSTANTS.NON_BODY_HTTP_METHODS, (method || '').toUpperCase())) {\n            // remove the '?' at the start of the queryParams\n            if (queryParams) {\n                requestBody = (requestBody ? requestBody + '&' : '') + queryParams.substring(1);\n            }\n            headers['Content-Type'] = WS_CONSTANTS.CONTENT_TYPES.FORM_URL_ENCODED;\n        } else {\n            url += queryParams;\n        }\n\n        /*\n         * for proxy calls:\n         *  - cloak the proper headers (required only for REST services)\n         *  - prepare complete url from relativeUrl\n         */\n        if (isProxyCall) {\n            // avoiding cloakHeadersForProxy when the method is invoked from apidesigner.\n                headers = variable.serviceType !== VARIABLE_CONSTANTS.SERVICE_TYPE.REST || operationInfo.skipCloakHeaders ? headers : cloakHeadersForProxy(headers);\n            if (variable.getPrefabName() && VARIABLE_CONSTANTS.REST_SUPPORTED_SERVICES.indexOf(variable.serviceType) !== -1) {\n                /* if it is a prefab variable (used in a normal project), modify the url */\n                url = 'prefabs/' + variable.getPrefabName() + url;\n                target = 'invokePrefabRestService';\n            } else if (!variable.getPrefabName()) {\n                url = 'services' + url;\n            }\n            url = $rootScope.project.deployedUrl + url;\n        }\n\n        /*creating the params needed to invoke the service. url is generated from the relative path for the operation*/\n        invokeParams = {\n            'projectID': $rootScope.project.id,\n            'url': url,\n            'target': target,\n            'method': method,\n            'headers': headers,\n            'data': requestBody,\n            'authDetails': authDetails,\n            'isDirectCall': !isProxyCall,\n            'isExtURL': variable.serviceType === VARIABLE_CONSTANTS.SERVICE_TYPE.REST,\n            'withCredentials': withCredentials\n        };\n\n        return invokeParams;\n    }\n\n    static isFileUploadRequest(variable) {\n        // temporary fix, have to find proper solution for deciding weather to upload file through variable\n        return variable.service === 'FileService' && variable.operation === 'uploadFile';\n    }\n\n    /**\n     * This method returns array of query param names for variable other then page,size,sort\n     * @params {params} params of the variable\n     */\n    static excludePaginationParams(params) {\n        return _.map(_.reject(params, (param) => {\n            return _.includes(VARIABLE_CONSTANTS.PAGINATION_PARAMS, param.name);\n        }), function (param) {\n            return param.name;\n        });\n    }\n}\n","class InflightQueue {\n    requestsQueue = new Map();\n\n    /**\n     * pushes the process against a variable in its queue\n     * @param variable\n     * @param {{resolve: (value?: any) => void; reject: (reason?: any) => void}} param2\n     * the resolve callback will be called on\n     */\n    private addToQueue(variable: any, param2: {resolve: (value?: (any)) => void; reject: (reason?: any) => void}) {\n        if (this.requestsQueue.has(variable)) {\n            this.requestsQueue.get(variable).push(param2);\n        } else {\n            const processes = [];\n            processes.push({resolve: param2.resolve, reject: param2.reject, active: false});\n            this.requestsQueue.set(variable, processes);\n        }\n    }\n\n    /**\n     * Calls the reject method against the passed process\n     * @param process\n     */\n    private rejectProcess(process: any) {\n        process.reject('Process rejected in the queue. Check the \"Inflight behavior\" for more info.');\n    }\n\n    /**\n     * clears the queue against a variable\n     * @param variable\n     */\n    public clear(variable) {\n        this.requestsQueue.delete(variable);\n    }\n\n    /**\n     * executes the n/w calls for a specified variable pushed in its respective queue (pushed while it was inFlight)\n     * @param variable\n     */\n    process(variable: any) {\n        const processes: [any] = this.requestsQueue.get(variable);\n        let nextProcess;\n\n        // process request queue for the variable only if it is not empty\n        if (!processes || !processes.length) {\n            this.clear(variable);\n            return;\n        }\n\n        // If only one item in queue\n        if (processes.length === 1) {\n            nextProcess = processes[0];\n            if (nextProcess.active) {\n                this.clear(variable);\n            } else {\n                nextProcess.active = true;\n                nextProcess.resolve();\n            }\n            return;\n        }\n\n        switch (variable.inFlightBehavior) {\n            case 'executeLast':\n                for (let i = 0; i < processes.length - 2; i++) {\n                    this.rejectProcess(processes[i]);\n                }\n                processes.splice(0, processes.length - 1);\n                this.process(variable);\n                break;\n            case 'executeAll':\n                nextProcess = processes.splice(0, 1)[0];\n                if (nextProcess.active) {\n                    nextProcess = processes.splice(0, 1)[0];\n                }\n                nextProcess.active = true;\n                nextProcess.resolve();\n                break;\n            default:\n                for (let i = 0; i < processes.length - 1; i++) {\n                    this.rejectProcess(processes[i]);\n                }\n                this.clear(variable);\n                break;\n        }\n    }\n\n    /**\n     * initializes the queue against a variable and makes the first process call\n     * If already initialized and a process in queue is in progress, the queue is not processed.\n     * To process the next item in the queue, the process method has to be called from the caller.\n     * @param variable\n     * @returns {Promise<any>}\n     */\n    submit(variable: any) {\n        return new Promise((resolve, reject) => {\n            this.addToQueue(variable, {resolve: resolve, reject: reject});\n\n            if (this.requestsQueue.get(variable).length === 1) {\n                this.process(variable);\n            }\n        });\n    }\n}\n\nexport const $queue = new InflightQueue();\n","import { $invokeWatchers, getClonedObject, getValidJSON, isDefined, isPageable, isValidWebURL, noop, triggerFn, xmlToJson } from '@wm/core';\n\nimport { upload } from '../../util/file-upload.util';\nimport { ServiceVariable } from '../../model/variable/service-variable';\nimport { ServiceVariableUtils } from '../../util/variable/service-variable.utils';\nimport { $queue } from '../../util/inflight-queue';\nimport { BaseVariableManager } from './base-variable.manager';\nimport { CONSTANTS, VARIABLE_CONSTANTS, WS_CONSTANTS } from '../../constants/variables.constants';\nimport { appManager, formatExportExpression, setInput } from './../../util/variable/variables.utils';\nimport { getEvaluatedOrderBy, httpService, initiateCallback, metadataService, securityService, simulateFileDownload } from '../../util/variable/variables.utils';\nimport { getAccessToken, performAuthorization, removeAccessToken } from '../../util/oAuth.utils';\nimport { AdvancedOptions } from '../../advanced-options';\n\ndeclare const _;\n\nexport class ServiceVariableManager extends BaseVariableManager {\n\n    fileUploadResponse: any = [];\n    fileUploadCount = 0;\n    totalFilesCount = 0;\n    successFileUploadCount = 0;\n    failedFileUploadCount = 0;\n\n    /**\n     * function to process error response from a service\n     * @param {ServiceVariable} variable\n     * @param {string} errMsg\n     * @param {Function} errorCB\n     * @param xhrObj\n     * @param {boolean} skipNotification\n     * @param {boolean} skipDefaultNotification\n     */\n    private processErrorResponse(variable: ServiceVariable, errMsg: string, errorCB: Function, xhrObj?: any, skipNotification?: boolean, skipDefaultNotification?: boolean) {\n        const methodInfo = this.getMethodInfo(variable, {}, {});\n        const securityDefnObj = _.get(methodInfo, 'securityDefinitions.0');\n        const advancedOptions: AdvancedOptions = this.prepareCallbackOptions(xhrObj);\n        // EVENT: ON_ERROR\n        if (!skipNotification) {\n            initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, errMsg, advancedOptions, skipDefaultNotification);\n        }\n        if (_.get(securityDefnObj, 'type') === VARIABLE_CONSTANTS.REST_SERVICE.SECURITY_DEFN.OAUTH2\n            && _.includes([VARIABLE_CONSTANTS.HTTP_STATUS_CODE.UNAUTHORIZED, VARIABLE_CONSTANTS.HTTP_STATUS_CODE.FORBIDDEN], _.get(xhrObj, 'status'))) {\n            removeAccessToken(securityDefnObj['x-WM-PROVIDER_ID']);\n        }\n        /* trigger error callback */\n        triggerFn(errorCB, errMsg);\n\n        if (!CONSTANTS.isStudioMode) {\n            /* process next requests in the queue */\n            variable.canUpdate = true;\n            $queue.process(variable);\n\n            // EVENT: ON_CAN_UPDATE\n            initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, errMsg, advancedOptions);\n        }\n    }\n\n    /**\n     * function to process success response from a service\n     * @param response\n     * @param variable\n     * @param options\n     * @param success\n     */\n    private processSuccessResponse(response, variable, options, success) {\n        let dataSet;\n        let newDataSet;\n        let pagination = {};\n        let advancedOptions: AdvancedOptions;\n        let jsonParsedResponse: any = getValidJSON(response);\n\n        response = isDefined(jsonParsedResponse) ? jsonParsedResponse : (xmlToJson(response) || response);\n\n        const isResponsePageable = isPageable(response);\n        if (isResponsePageable) {\n            dataSet = response.content;\n            pagination = _.omit(response, 'content');\n        } else {\n            dataSet = response;\n        }\n        /**\n         * send pagination object with advancedOptions all the time.\n         * With this, user can provide pagination option, even if it is not there.\n         * applicable to 3rd party services that do not support pagination out of the box.\n         */\n        advancedOptions = this.prepareCallbackOptions(options.xhrObj, {pagination: pagination, rawData: dataSet});\n\n        // EVENT: ON_RESULT\n        initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, response, advancedOptions);\n\n        // trigger success callback, pass data received from server as it is.\n        triggerFn(success, response, pagination);\n\n        /* if dataTransformation enabled, transform the data */\n        if (variable.transformationColumns) {\n            this.transformData(response, variable);\n        }\n\n        // if a primitive type response is returned, wrap it in an object\n        dataSet = (!_.isObject(dataSet)) ? {'value': dataSet} : dataSet;\n\n        // EVENT: ON_PREPARE_SETDATA\n        newDataSet = initiateCallback(VARIABLE_CONSTANTS.EVENT.PREPARE_SETDATA, variable, dataSet, advancedOptions);\n        if (isDefined(newDataSet)) {\n            // setting newDataSet as the response to service variable onPrepareSetData\n            dataSet = newDataSet;\n        }\n\n        /* update the dataset against the variable, if response is non-object, insert the response in 'value' field of dataSet */\n        if (!options.forceRunMode && !options.skipDataSetUpdate) {\n            variable.pagination = pagination;\n            variable.dataSet = dataSet;\n\n            // legacy properties in dataSet, [content]\n            if (isResponsePageable) {\n                Object.defineProperty(variable.dataSet, 'content', {\n                    get: () => {\n                        return variable.dataSet;\n                    }\n                });\n            }\n        }\n\n        $invokeWatchers(true);\n        setTimeout(() => {\n            // EVENT: ON_SUCCESS\n            initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, dataSet, advancedOptions);\n\n            if (!CONSTANTS.isStudioMode) {\n                /* process next requests in the queue */\n                variable.canUpdate = true;\n                $queue.process(variable);\n            }\n\n            // EVENT: ON_CAN_UPDATE\n            initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, dataSet, advancedOptions);\n        });\n\n        return {\n            data: variable.dataSet,\n            pagination: variable.pagination\n        };\n    }\n\n    private uploadFileInFormData(variable: ServiceVariable, options: any, success: Function, error: Function, file, requestParams) {\n        const promise = upload(file, requestParams.data, {\n            fileParamName: 'files',\n            url: requestParams.url\n        });\n        (promise as any).then((data) => {\n            this.fileUploadCount++;\n            this.successFileUploadCount++;\n            this.fileUploadResponse.push(data[0]);\n            if (this.totalFilesCount === this.fileUploadCount) {\n                if (this.failedFileUploadCount === 0) {\n                    this.processSuccessResponse(this.fileUploadResponse, variable, options, success);\n                    this.fileUploadResponse = [];\n                    appManager.notifyApp(appManager.getAppLocale().MESSAGE_FILE_UPLOAD_SUCCESS, 'success');\n                } else {\n                    initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, this.fileUploadResponse);\n                    this.fileUploadResponse = [];\n                    appManager.notifyApp(appManager.getAppLocale().MESSAGE_FILE_UPLOAD_ERROR, 'error');\n                }\n                this.fileUploadCount = 0;\n                this.successFileUploadCount = 0;\n                this.totalFilesCount = 0;\n            }\n            return data;\n        }, (e) => {\n            this.fileUploadCount++;\n            this.failedFileUploadCount++;\n            this.fileUploadResponse.push(e);\n            if (this.totalFilesCount === this.fileUploadCount) {\n                this.processErrorResponse(variable, this.fileUploadResponse, error, options.xhrObj, options.skipNotification);\n                initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, this.fileUploadResponse);\n                this.fileUploadResponse = [];\n                this.fileUploadCount = 0;\n                this.failedFileUploadCount = 0;\n                this.totalFilesCount = 0;\n            }\n            return e;\n        }, (data) => {\n            if (variable._progressObservable) {\n                variable._progressObservable.next({\n                    'progress': data,\n                    'status': VARIABLE_CONSTANTS.EVENT.PROGRESS,\n                    'fileName': file.name});\n            }\n            initiateCallback(VARIABLE_CONSTANTS.EVENT.PROGRESS, variable, data);\n            return data;\n        });\n        return promise;\n    }\n\n    /**\n     * Checks if the user is logged in or not and returns appropriate error\n     * If user is not logged in, Session timeout logic is run, for user to login\n     * @param variable\n     * @returns {any}\n     */\n    private handleAuthError(variable, success, errorCB, options) {\n        const isUserAuthenticated = _.get(securityService.get(), 'authenticated');\n        let info;\n\n        if (isUserAuthenticated) {\n            info = {\n                error: {\n                    message: 'You\\'re not authorised to access the resource \"' + variable.service + '\".'\n                }\n            };\n        } else {\n            info = {\n                error: {\n                    message: 'You\\'re not authenticated to access the resource \"' + variable.service + '\".',\n                    skipDefaultNotification: true\n                }\n            };\n            appManager.pushToSessionFailureRequests(variable.invoke.bind(variable, options, success, errorCB));\n            appManager.handle401();\n        }\n        return info;\n    }\n\n    /**\n     * Handles error, when variable's metadata is not found. The reason for this can be:\n     *  - API is secure and user is not logged in\n     *  - API is secure and user is logged in but not authorized\n     *  - The servicedefs are not generated properly at the back end (need to edit the variable and re-run the project)\n     * @param info\n     * @param variable\n     * @param errorCB\n     * @param options\n     */\n    private handleRequestMetaError(info, variable, success, errorCB, options) {\n        const err_type = _.get(info, 'error.type');\n\n        switch (err_type) {\n            case VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.NO_ACCESSTOKEN:\n                performAuthorization(undefined, info.securityDefnObj[VARIABLE_CONSTANTS.REST_SERVICE.OAUTH_PROVIDER_KEY], this.invoke.bind(this, variable, options, null, errorCB), null);\n                this.processErrorResponse(variable, info.error.message, errorCB, options.xhrObj, true, true);\n                break;\n            case VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.USER_UNAUTHORISED:\n                info = this.handleAuthError(variable, success, errorCB, options);\n                this.processErrorResponse(variable, info.error.message, errorCB, options.xhrObj, options.skipNotification, info.error.skipDefaultNotification);\n                break;\n            case VARIABLE_CONSTANTS.REST_SERVICE.ERR_TYPE.METADATA_MISSING:\n                this.processErrorResponse(variable, info.error.message, errorCB, options.xhrObj, options.skipNotification, info.error.skipDefaultNotification);\n                break;\n            default:\n                if (info.error.message) {\n                    console.warn(info.error.message, variable.name);\n                    this.processErrorResponse(variable, info.error.message, errorCB, options.xhrObj, options.skipNotification, info.error.skipDefaultNotification);\n                }\n        }\n        return info;\n    }\n\n    /**\n     * function to transform the service data as according to the variable configuration\n     * this is used when 'transformationColumns' property is set on the variable\n     * @param data: data returned from the service\n     * @variable: variable object triggering the service\n     */\n    private transformData(data, variable) {\n        data.wmTransformedData = [];\n\n        const columnsArray = variable.transformationColumns,\n            dataArray = _.get(data, variable.dataField) || [],\n            transformedData = data.wmTransformedData;\n\n        _.forEach(dataArray, function (datum, index) {\n            transformedData[index] = {};\n            _.forEach(columnsArray, function (column, columnIndex) {\n                transformedData[index][column] = datum[columnIndex];\n            });\n        });\n    }\n\n    /**\n     * gets the service operation info against a service variable\n     * this is extracted from the metadataservice\n     * @param variable\n     * @param inputFields: sample values, if provided, will be set against params in the definition\n     * @param options\n     * @returns {any}\n     */\n    private getMethodInfo(variable, inputFields, options) {\n        const serviceDef = getClonedObject(metadataService.getByOperationId(variable.operationId, variable.getPrefabName()));\n        const methodInfo = serviceDef === null ? null : _.get(serviceDef, 'wmServiceOperationInfo');\n        if (!methodInfo) {\n            return methodInfo;\n        }\n        const securityDefnObj = _.get(methodInfo.securityDefinitions, '0'),\n            isOAuthTypeService = securityDefnObj && (securityDefnObj.type === VARIABLE_CONSTANTS.REST_SERVICE.SECURITY_DEFN.OAUTH2);\n        if (methodInfo.parameters) {\n            methodInfo.parameters.forEach(function (param) {\n                // Ignore readOnly params in case of formData file params will be duplicated\n                if (param.readOnly) {\n                    return;\n                }\n                param.sampleValue = inputFields[param.name];\n                /* supporting pagination for query service variable */\n                if (VARIABLE_CONSTANTS.PAGINATION_PARAMS.indexOf(param.name) !== -1) {\n                    if (param.name === 'size') {\n                        param.sampleValue = options.size || param.sampleValue || parseInt(variable.maxResults, 10);\n                    } else if (param.name === 'page') {\n                        param.sampleValue = options.page || param.sampleValue || 1;\n                    } else if (param.name === 'sort') {\n                        param.sampleValue = getEvaluatedOrderBy(variable.orderBy, options.orderBy) || param.sampleValue || '';\n                    }\n                } else if (param.name === 'access_token' && isOAuthTypeService) {\n                    param.sampleValue = getAccessToken(securityDefnObj[VARIABLE_CONSTANTS.REST_SERVICE.OAUTH_PROVIDER_KEY], null);\n                }\n            });\n        }\n        return methodInfo;\n    }\n\n    /**\n     * Returns true if any of the files are in onProgress state\n     */\n    private isFileUploadInProgress(dataBindings) {\n        let filesStatus = false;\n        _.forEach(dataBindings, (dataBinding) => {\n            if (_.isArray(dataBinding) && dataBinding[0] instanceof File) {\n                _.forEach(dataBinding, (file) => {\n                    if (file.status === 'onProgress') {\n                        filesStatus = true;\n                        return;\n                    }\n                });\n            }\n        });\n        return filesStatus;\n    }\n\n    // Makes the call for Uploading file/ files\n    private uploadFile(variable, options, success, error, inputFields, requestParams ) {\n        let fileParamCount = 0;\n        const fileArr: any = [], promArr: any = [];\n        _.forEach(inputFields, (inputField) => {\n            if (_.isArray(inputField)) {\n                if (inputField[0] instanceof File) {\n                    fileParamCount++;\n                }\n                _.forEach(inputField, (input) => {\n                    if (input instanceof File || _.find(_.values(input), o => o instanceof Blob)) {\n                        fileArr.push(input);\n                        this.totalFilesCount++;\n                        fileParamCount = fileParamCount || 1;\n                    }\n                });\n            } else {\n                if (inputField instanceof File) {\n                    fileParamCount++;\n                    this.totalFilesCount++;\n                    fileArr.push(inputField);\n                }\n            }\n        });\n        if (fileParamCount === 1) {\n            if (inputFields.files.length > 1) {\n                _.forEach(fileArr, (file) => {\n                    promArr.push(this.uploadFileInFormData(variable, options, success, error, file, requestParams));\n                });\n                return Promise.all(promArr);\n            } else {\n                return this.uploadFileInFormData(variable, options, success, error, fileArr[0], requestParams);\n            }\n        }\n    }\n\n    /**\n     * proxy for the invoke call\n     * Request Info is constructed\n     * if error found, error is thrown\n     * else, call is made\n     * @param {ServiceVariable} variable\n     * @param options\n     * @param {Function} success\n     * @param {Function} error\n     * @returns {any}\n     * @private\n     */\n    private _invoke (variable: ServiceVariable, options: any, success: Function, error: Function) {\n        let inputFields = getClonedObject(options.inputFields || variable.dataBinding);\n        // EVENT: ON_BEFORE_UPDATE\n        const output: any = initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE, variable, inputFields, options);\n        let successHandler;\n        let errorHandler;\n\n        if (output === false) {\n            $queue.process(variable);\n            triggerFn(error);\n            return;\n        }\n        if (_.isObject(output)) {\n            inputFields = output;\n        }\n\n        const operationInfo = this.getMethodInfo(variable, inputFields, options),\n            requestParams = ServiceVariableUtils.constructRequestParams(variable, operationInfo, inputFields);\n\n        // check errors\n        if (requestParams.error) {\n            const info = this.handleRequestMetaError(requestParams, variable, success, error, options);\n            const reason = (_.get(info, 'error.message') || 'An error occurred while triggering the variable: ') + ': ' +  variable.name;\n            triggerFn(error);\n            return Promise.reject(reason);\n        }\n\n        // file upload\n        if (ServiceVariableUtils.isFileUploadRequest(variable)) {\n            const uploadPromise = this.uploadFile(variable, options, success, error, inputFields, requestParams);\n            if (uploadPromise) {\n                return uploadPromise;\n            }\n        }\n\n        // file download\n        if (operationInfo && _.isArray(operationInfo.produces) && _.includes(operationInfo.produces, WS_CONSTANTS.CONTENT_TYPES.OCTET_STREAM)) {\n            return simulateFileDownload(requestParams, variable.dataBinding.file || variable.name, variable.dataBinding.exportType, function () {\n                initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, null, null, null);\n                $queue.process(variable);\n                triggerFn(success);\n            }, function () {\n                initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, null, null, null);\n                triggerFn(error);\n            });\n        }\n\n        // notify variable progress\n        this.notifyInflight(variable, !options.skipToggleState);\n\n        successHandler = (response, resolve) => {\n            if (response && response.type) {\n                const data = this.processSuccessResponse(response.body, variable, _.extend(options, {'xhrObj': response}), success);\n                // notify variable success\n                this.notifyInflight(variable, false, data);\n                resolve(response);\n            }\n        };\n\n        errorHandler = (err, reject) => {\n            const errMsg = httpService.getErrMessage(err);\n            // notify variable error\n            this.notifyInflight(variable, false);\n            this.processErrorResponse(variable, errMsg, error, err, options.skipNotification);\n            reject({\n                error: errMsg,\n                details: err\n            });\n        };\n\n        // make the call and return a promise to the user to support script calls made by users\n        return new Promise((resolve, reject) => {\n            requestParams.responseType = 'text'; // this is to return text response. JSON & XML-to-JSON parsing is handled in success handler.\n            this.httpCall(requestParams, variable).then((response) => {\n                successHandler(response, resolve);\n            }, err => {\n                errorHandler(err, reject);\n            });\n            // the _observable property on variable is used store the observable using which the network call is made\n            // this can be used to cancel the variable calls.\n        });\n    }\n\n    // *********************************************************** PUBLIC ***********************************************************//\n\n    public invoke(variable, options, success, error) {\n        options = options || {};\n        options.inputFields = options.inputFields || getClonedObject(variable.dataBinding);\n        return $queue.submit(variable).then(this._invoke.bind(this, variable, options, success, error), error);\n    }\n\n    public download(variable, options, successHandler, errorHandler) {\n        options = options || {};\n        const inputParams  = getClonedObject(variable.dataBinding);\n        const inputData = options.data || {};\n        const methodInfo   = this.getMethodInfo(variable, inputParams, options);\n        let requestParams;\n\n        methodInfo.relativePath += '/export';\n        requestParams = ServiceVariableUtils.constructRequestParams(variable, methodInfo, inputParams);\n\n        requestParams.data = inputData;\n        requestParams.data.fields = formatExportExpression(inputData.fields || []);\n\n        // extra options provided, these may be used in future for integrating export feature with ext. services\n        requestParams.method = options.httpMethod || 'POST';\n        requestParams.url = options.url || requestParams.url;\n\n        // If request params returns error then show an error toaster\n        if (_.hasIn(requestParams, 'error.message')) {\n            triggerFn(errorHandler, requestParams.error.message);\n            return Promise.reject(requestParams.error.message);\n        }\n        return httpService.send(requestParams).then(response => {\n            if (response && isValidWebURL(response.body.result)) {\n                window.location.href = response.body.result;\n                triggerFn(successHandler, response);\n            } else {\n                initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, response);\n                triggerFn(errorHandler, response);\n            }\n        }, (response, xhrObj) => {\n            initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, response, xhrObj);\n            triggerFn(errorHandler, response);\n        });\n    }\n\n    public getInputParms(variable) {\n        const wmServiceOperationInfo = _.get(metadataService.getByOperationId(variable.operationId), 'wmServiceOperationInfo');\n        return _.get(wmServiceOperationInfo, 'parameters');\n    }\n\n    public setInput(variable, key, val, options) {\n        return setInput(variable.dataBinding, key, val, options);\n    }\n\n    /**\n     * Cancels an on going service request\n     * @param variable\n     * @param $file\n     */\n    public cancel(variable, $file?) {\n        // CHecks if there is any pending requests in the queue\n        if ($queue.requestsQueue.has(variable)) {\n            // If the request is a File upload request then modify the elements associated with file upload\n            // else unsubscribe from the observable on the variable.\n            if (ServiceVariableUtils.isFileUploadRequest(variable)) {\n                $file._uploadProgress.unsubscribe();\n                $file.status = 'abort';\n                this.totalFilesCount--;\n                initiateCallback(VARIABLE_CONSTANTS.EVENT.ABORT, variable, $file);\n                if (!this.isFileUploadInProgress(variable.dataBinding) && this.totalFilesCount === 0) {\n                    $queue.process(variable);\n                    // notify inflight variable\n                    this.notifyInflight(variable, false);\n                }\n            } else {\n                if (variable._observable) {\n                    variable._observable.unsubscribe();\n                    $queue.process(variable);\n                    // notify inflight variable\n                    this.notifyInflight(variable, false);\n                }\n            }\n        }\n    }\n\n    public defineFirstLastRecord(variable) {\n        if (variable.isList) {\n            Object.defineProperty(variable, 'firstRecord', {\n                'configurable': true,\n                'get': function () {\n                    const dataSet = variable.dataSet;\n                    // For procedure(v1) data doesn't come under content\n                    return _.head(dataSet && dataSet.content) || _.head(dataSet) || {};\n                }\n            });\n            Object.defineProperty(variable, 'lastRecord', {\n                'configurable': true,\n                'get': function () {\n                    const dataSet = variable.dataSet;\n                    // For procedure(v1) data doesn't come under content\n                    return _.last(dataSet && dataSet.content) || _.last(dataSet) || {};\n                }\n            });\n        }\n    }\n\n    // Gets the input params of the service variable and also add params from the searchKeys (filterfields)\n    private getQueryParams(filterFields, searchValue, variable) {\n        const inputParams = this.getInputParms(variable);\n        const queryParams = ServiceVariableUtils.excludePaginationParams(inputParams);\n        const inputFields = {};\n\n        // check if some param value is already available in databinding and update the inputFields accordingly\n        _.map(variable.dataBinding, function (value, key) {\n            inputFields[key] = value;\n        });\n\n        // add the query params mentioned in the searchkey to inputFields\n        _.forEach(filterFields, function (value) {\n            if (_.includes(queryParams, value)) {\n                inputFields[value] = searchValue;\n            }\n        });\n\n        return inputFields;\n    }\n\n    /**\n     * This method returns filtered records based on searchKey and queryText.\n     * @param variable\n     * @param options\n     * @param success\n     * @param error\n     * @returns {Promise<any>}\n     */\n    public searchRecords(variable, options, success, error) {\n        const inputFields = this.getQueryParams(_.split(options.searchKey, ','), options.query, variable);\n\n        const requestParams = {\n            page: options.page,\n            pagesize: options.pagesize,\n            skipDataSetUpdate: true, // dont update the actual variable dataset,\n            skipToggleState: true, // Dont change the varibale toggle state as this is a independent call\n            inFlightBehavior: 'executeAll',\n            inputFields: inputFields\n        };\n\n        if (options.onBeforeservicecall) {\n            options.onBeforeservicecall(inputFields);\n        }\n\n        return this.invoke(variable, requestParams, success, error).catch(noop);\n    }\n}\n","import { getClonedObject, hasCordova, isDefined, isNumberType, replace, triggerFn } from '@wm/core';\n\nimport { $rootScope, DB_CONSTANTS, SWAGGER_CONSTANTS } from '../../constants/variables.constants';\nimport { formatDate, getEvaluatedOrderBy } from './variables.utils';\n\ndeclare const _;\n\nexport class LiveVariableUtils {\n\n    static isCompositeKey(primaryKey) {\n        return !primaryKey || (primaryKey && (!primaryKey.length || primaryKey.length > 1));\n    }\n\n    static isNoPrimaryKey(primaryKey) {\n        return (!primaryKey || (primaryKey && !primaryKey.length));\n    }\n\n    // Generate the URL based on the primary keys and their values\n    static getCompositeIDURL(primaryKeysData) {\n        let compositeId = '';\n        //  Loop over the 'compositeKeysData' and construct the 'compositeId'.\n        _.forEach(primaryKeysData, (paramValue, paramName) => {\n            compositeId += paramName + '=' + encodeURIComponent(paramValue) + '&';\n        });\n        compositeId = compositeId.slice(0, -1);\n        return compositeId;\n    }\n\n\n    // Check if table has blob column\n    static hasBlob(variable) {\n        return _.find(_.get(variable, ['propertiesMap', 'columns']), {'type': 'blob'});\n    }\n\n    static getPrimaryKey(variable) {\n        if (!variable.propertiesMap) {\n            return [];\n        }\n\n        if (variable.propertiesMap.primaryFields) {\n            return variable.propertiesMap.primaryFields;\n        }\n        /*Old projects do not have primary fields. Get primary key from the columns*/\n        const primaryKey = [];\n        /*Loop through the propertiesMap and get the primary key column.*/\n        _.forEach(variable.propertiesMap.columns, (index, column) => {\n            if (column.isPrimaryKey) {\n                if (column.isRelated && (!_.includes(column.relatedFieldName, primaryKey))) {\n                    primaryKey.push(column.relatedFieldName);\n                } else if (!_.includes(column.fieldName, primaryKey)) {\n                    primaryKey.push(column.fieldName);\n                }\n            }\n        });\n        return primaryKey;\n    }\n\n    //  Construct the URL for blob columns and set it in the data, so that widgets can use this\n    static processBlobColumns(responseData, variable) {\n        if (!responseData) {\n            return;\n        }\n        const blobCols = _.map(_.filter(variable.propertiesMap.columns, {'type': 'blob'}), 'fieldName'),\n            deployedUrl = _.trim($rootScope.project.deployedUrl);\n        let href = '',\n            primaryKeys;\n\n        if (_.isEmpty(blobCols)) {\n            return;\n        }\n        if (hasCordova()) {\n             href += _.endsWith(deployedUrl, '/') ? deployedUrl : deployedUrl + '/';\n        }\n        href += ((variable._prefabName !== '' && variable._prefabName !== undefined) ? 'prefabs/' + variable._prefabName : 'services') + '/' + variable.liveSource + '/' + variable.type + '/';\n        primaryKeys = variable.propertiesMap.primaryFields || variable.propertiesMap.primaryKeys;\n        _.forEach(responseData, data => {\n            if (data) {\n                _.forEach(blobCols, col => {\n                    const compositeKeysData = {};\n                    if (data[col] === null || !_.isEmpty(_.trim(data[col]))) {\n                        return;\n                    }\n                    if (LiveVariableUtils.isCompositeKey(primaryKeys)) {\n                        primaryKeys.forEach(key => {\n                            compositeKeysData[key] = data[key];\n                        });\n                        data[col] = href + 'composite-id/content/' + col + '?' + LiveVariableUtils.getCompositeIDURL(compositeKeysData);\n                    } else {\n                        data[col] = href + data[_.join(primaryKeys)] + '/content/' + col;\n                    }\n                });\n            }\n        });\n    }\n\n    static getHibernateOrSqlType(variable, fieldName, type, entityName?: string) {\n        const columns = variable.propertiesMap.columns;\n        let column,\n            relatedCols,\n            relatedCol;\n        if (_.includes(fieldName, '.')) {\n            column = _.find(columns, col => {\n                return col.fieldName === fieldName.split('.')[0];\n            });\n            relatedCols = column && column.columns;\n            relatedCol = _.find(relatedCols, col => {\n                return col.fieldName === fieldName.split('.')[1];\n            });\n            return relatedCol && relatedCol[type];\n        }\n        column = _.find(columns, col => {\n            return col.fieldName === fieldName || col.relatedColumnName === fieldName;\n        });\n        if (!column && entityName) {\n            const entity = _.find(columns, col => col.relatedEntityName === entityName);\n            column = _.find(entity.columns, col => {\n                return col.fieldName === fieldName || col.relatedColumnName === fieldName;\n            });\n        }\n        return column && column[type];\n    }\n\n    /*Function to get the sqlType of the specified field.*/\n    static getSqlType(variable, fieldName, entityName?: string) {\n        return LiveVariableUtils.getHibernateOrSqlType(variable, fieldName, 'type', entityName);\n    }\n\n    /*Function to check if the specified field has a one-to-many relation or not.*/\n    static isRelatedFieldMany(variable, fieldName) {\n        const columns = variable.propertiesMap.columns,\n            columnsCount = columns.length;\n        let index,\n            column;\n        /*Loop through the columns of the liveVariable*/\n        for (index = 0; index < columnsCount; index += 1) {\n            column = columns[index];\n            /*If the specified field is found in the columns of the variable,\n            * then it has a many-to-one relation.*/\n            if (column.fieldName === fieldName) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    static isStringType(type) {\n        return _.includes(['text', 'string'], _.toLower(type));\n    }\n\n    static getSQLFieldType(variable, options) {\n        if (_.includes(['timestamp', 'datetime', 'date'], options.type)) {\n            return options.type;\n        }\n        return LiveVariableUtils.getSqlType(variable, options.fieldName) || options.type;\n    }\n\n    static getAttributeName(variable, fieldName) {\n        let attrName = fieldName;\n        variable.propertiesMap.columns.forEach(column => {\n            if (column.fieldName === fieldName && column.isRelated) {\n                attrName = column.relatedFieldName;\n            }\n        });\n        return attrName;\n    }\n\n    static getFilterCondition(filterCondition) {\n        if (_.includes(DB_CONSTANTS.DATABASE_RANGE_MATCH_MODES, filterCondition)) {\n            return filterCondition;\n        }\n        return DB_CONSTANTS.DATABASE_MATCH_MODES['exact'];\n    }\n\n    static getFilterOption(variable, fieldOptions, options) {\n        let attributeName,\n            fieldValue = fieldOptions.value,\n            filterOption,\n            filterCondition;\n\n        const matchModes = DB_CONSTANTS.DATABASE_MATCH_MODES,\n            fieldName = fieldOptions.fieldName,\n            fieldRequired = fieldOptions.required || false,\n            fieldType = LiveVariableUtils.getSQLFieldType(variable, fieldOptions);\n\n        filterCondition = matchModes[fieldOptions.matchMode] || matchModes[fieldOptions.filterCondition] || fieldOptions.filterCondition;\n\n        fieldOptions.type = fieldType;\n        /* if the field value is an object(complex type), loop over each field inside and push only first level fields */\n        if (_.isObject(fieldValue) && !_.isArray(fieldValue)) {\n            const firstLevelValues = [];\n            _.forEach(fieldValue, (subFieldValue, subFieldName) => {\n                if (subFieldValue && !_.isObject(subFieldValue)) {\n                    firstLevelValues.push(fieldName + '.' + subFieldName + '=' + subFieldValue);\n                }\n            });\n            return firstLevelValues;\n        }\n\n        if (_.includes(DB_CONSTANTS.DATABASE_EMPTY_MATCH_MODES, filterCondition)) {\n            attributeName = LiveVariableUtils.getAttributeName(variable, fieldName);\n            // For non string types empty match modes are not supported, so convert them to null match modes.\n            if (fieldType && !LiveVariableUtils.isStringType(fieldType)) {\n                filterCondition = DB_CONSTANTS.DATABASE_NULL_EMPTY_MATCH[filterCondition];\n            }\n            filterOption = {\n                'attributeName': attributeName,\n                'attributeValue': '',\n                'attributeType': _.toUpper(fieldType),\n                'filterCondition': filterCondition,\n                'required': fieldRequired\n            };\n            if (options.searchWithQuery) {\n                filterOption.isVariableFilter = fieldOptions.isVariableFilter;\n            }\n            return filterOption;\n        }\n\n        if (isDefined(fieldValue) && fieldValue !== null && fieldValue !== '') {\n            /*Based on the sqlType of the field, format the value & set the filter condition.*/\n            if (fieldType) {\n                switch (fieldType) {\n                    case 'integer':\n                        fieldValue = _.isArray(fieldValue) ? _.reduce(fieldValue, (result, value) => {\n                            value = parseInt(value, 10);\n                            if (!_.isNaN(value)) {\n                                result.push(value);\n                            }\n                            return result;\n                        }, []) : parseInt(fieldValue, 10);\n                        filterCondition = filterCondition ? LiveVariableUtils.getFilterCondition(filterCondition) : matchModes['exact'];\n                        break;\n                    case 'date':\n                    case 'datetime':\n                    case 'timestamp':\n                        fieldValue = formatDate(fieldValue, fieldType);\n                        filterCondition = filterCondition ? LiveVariableUtils.getFilterCondition(filterCondition) : matchModes['exact'];\n                        break;\n                    case 'text':\n                    case 'string':\n                        if (_.isArray(fieldValue)) {\n                            filterCondition = _.includes([matchModes['in'], matchModes['notin']], filterCondition) ? filterCondition : matchModes['exact'];\n                        } else {\n                            filterCondition = filterCondition || matchModes['anywhereignorecase'];\n                        }\n                        break;\n                    default:\n                        filterCondition = filterCondition ? LiveVariableUtils.getFilterCondition(filterCondition) : matchModes['exact'];\n                        break;\n                }\n            } else {\n                filterCondition = _.isString(fieldValue) ? matchModes['anywhereignorecase'] : matchModes['exact'];\n            }\n            attributeName = LiveVariableUtils.getAttributeName(variable, fieldName);\n            filterOption = {\n                'attributeName': attributeName,\n                'attributeValue': fieldValue,\n                'attributeType': _.toUpper(fieldType),\n                'filterCondition': filterCondition,\n                'required': fieldRequired\n            };\n            if (options.searchWithQuery) {\n                filterOption.isVariableFilter = fieldOptions.isVariableFilter;\n            }\n            return filterOption;\n        }\n    }\n\n    static getFilterOptions(variable, filterFields, options) {\n        let filterOptions = [];\n        _.each(filterFields, (fieldOptions) => {\n            const filterOption = LiveVariableUtils.getFilterOption(variable, fieldOptions, options);\n            if (!_.isNil(filterOption)) {\n                if (_.isArray(filterOption)) {\n                    filterOptions = filterOptions.concat(filterOption);\n                } else {\n                    filterOptions.push(filterOption);\n                }\n            }\n        });\n        return filterOptions;\n    }\n\n    // Wrap the field name and value in lower() in ignore case scenario\n    // TODO: Change the function name to represent the added functionality of identifiers for datetime, timestamp and float types. Previously only lower was warapped.\n    static wrapInLowerCase(value, options, ignoreCase, isField?) {\n        const type = _.toLower(options.attributeType);\n        if (!isField) {\n            // Wrap the identifiers for datetime, timestamp and float types. Wrappring is not required for fields.\n            if (type === 'datetime') {\n                return 'wm_dt(' + value + ')';\n            }\n            if (type === 'timestamp') {\n                return 'wm_ts(' + value + ')';\n            }\n            if (type === 'float') {\n                return 'wm_float(' + value + ')';\n            }\n            if (type === 'boolean') {\n                return 'wm_bool(' + value + ')';\n            }\n        }\n        // If ignore case is true and type is string/ text and match mode is string type, wrap in lower()\n        if (ignoreCase && (!type || LiveVariableUtils.isStringType(type)) && _.includes(DB_CONSTANTS.DATABASE_STRING_MODES, options.filterCondition)) {\n            return 'lower(' + value + ')';\n        }\n        return value;\n    }\n\n    static encodeAndAddQuotes(value, type, skipEncode) {\n        let encodedValue = skipEncode ? value : encodeURIComponent(value);\n        type = _.toLower(type);\n        encodedValue = _.replace(encodedValue, /'/g, '\\'\\'');\n        // For number types, don't wrap the value in quotes\n        if ((isNumberType(type) && type !== 'float')) {\n            return encodedValue;\n        }\n        return '\\'' + encodedValue + '\\'';\n    }\n\n    static getParamValue(value, options, ignoreCase, skipEncode) {\n        let param;\n        const filterCondition = options.filterCondition,\n            dbModes = DB_CONSTANTS.DATABASE_MATCH_MODES,\n            type = options.attributeType;\n        if (_.includes(DB_CONSTANTS.DATABASE_EMPTY_MATCH_MODES, filterCondition)) {\n            // For empty matchmodes, no value is required\n            return '';\n        }\n        switch (filterCondition) {\n            case dbModes.startignorecase:\n            case dbModes.start:\n                param = LiveVariableUtils.encodeAndAddQuotes(value + '%', type, skipEncode);\n                param = LiveVariableUtils.wrapInLowerCase(param, options, ignoreCase);\n                break;\n            case dbModes.endignorecase:\n            case dbModes.end:\n                param = LiveVariableUtils.encodeAndAddQuotes('%' + value, type, skipEncode);\n                param = LiveVariableUtils.wrapInLowerCase(param, options, ignoreCase);\n                break;\n            case dbModes.anywhereignorecase:\n            case dbModes.anywhere:\n                param = LiveVariableUtils.encodeAndAddQuotes('%' + value + '%', type, skipEncode);\n                param = LiveVariableUtils.wrapInLowerCase(param, options, ignoreCase);\n                break;\n            case dbModes.between:\n                param = _.join(_.map(value, val => {\n                    return LiveVariableUtils.wrapInLowerCase(LiveVariableUtils.encodeAndAddQuotes(val, type, skipEncode), options, ignoreCase);\n                }), ' and ');\n                break;\n            case dbModes.in:\n            case dbModes.notin:\n                param = _.join(_.map(value, val => {\n                    return LiveVariableUtils.wrapInLowerCase(LiveVariableUtils.encodeAndAddQuotes(val, type, skipEncode), options, ignoreCase);\n                }), ', ');\n                param = '(' + param + ')';\n                break;\n            /*case dbModes.exactignorecase:\n            case dbModes.exact:\n            case dbModes.notequals:\n            The above three cases will be handled by default*/\n            default:\n                param = LiveVariableUtils.encodeAndAddQuotes(value, type, skipEncode);\n                param = LiveVariableUtils.wrapInLowerCase(param, options, ignoreCase);\n                break;\n        }\n        return isDefined(param) ? param : '';\n    }\n\n    static getSearchQuery(filterOptions, operator, ignoreCase, skipEncode?) {\n        let query;\n        const params = [];\n        _.forEach(filterOptions, fieldValue => {\n            const value = fieldValue.attributeValue,\n                dbModes = DB_CONSTANTS.DATABASE_MATCH_MODES,\n                isValArray = _.isArray(value);\n            let fieldName = fieldValue.attributeName,\n                filterCondition = fieldValue.filterCondition,\n                matchModeExpr,\n                paramValue;\n            // If value is an empty array, do not generate the query\n            // If values is NaN and number type, do not generate query for this field\n            if ((isValArray && _.isEmpty(value)) || (!isValArray && isNaN(value) && isNumberType(fieldValue.attributeType))) {\n                return;\n            }\n            if (isValArray) {\n                // If array is value and mode is between, pass between. Else pass as in query\n                filterCondition = filterCondition === dbModes.between || filterCondition === dbModes.notin ? filterCondition : dbModes.in;\n                fieldValue.filterCondition = filterCondition;\n            }\n            matchModeExpr = DB_CONSTANTS.DATABASE_MATCH_MODES_WITH_QUERY[filterCondition];\n            paramValue = LiveVariableUtils.getParamValue(value, fieldValue, ignoreCase, skipEncode);\n            fieldName = LiveVariableUtils.wrapInLowerCase(fieldName, fieldValue, ignoreCase, true);\n            params.push(replace(matchModeExpr, [fieldName, paramValue]));\n        });\n        query = _.join(params, operator); // empty space added intentionally around OR\n        return query;\n    }\n\n    /**\n     * creating the proper values from the actual object like for between,in matchModes value has to be an array like [1,2]\n     * @param rules recursive filterexpressions object\n     * @param variable variable object\n     * @param options options\n     */\n    static processFilterFields(rules, variable, options) {\n        _.remove(rules, rule => {\n            return rule && (_.isString(rule.value) && rule.value.indexOf('bind:') === 0 || (rule.matchMode === 'between' ? (_.isString(rule.secondvalue) && rule.secondvalue.indexOf('bind:') === 0) : false));\n        });\n\n        _.forEach(rules, (rule, index) => {\n            if (rule) {\n                if (rule.rules) {\n                    LiveVariableUtils.processFilterFields(rule.rules, variable, options);\n                } else {\n                    if (!_.isNull(rule.target)) {\n                        const value = rule.matchMode.toLowerCase() === DB_CONSTANTS.DATABASE_MATCH_MODES.between.toLowerCase()\n                            ? (_.isArray(rule.value) ? rule.value : [rule.value, rule.secondvalue])\n                            : (rule.matchMode.toLowerCase() === DB_CONSTANTS.DATABASE_MATCH_MODES.in.toLowerCase() || rule.matchMode.toLowerCase() === DB_CONSTANTS.DATABASE_MATCH_MODES.notin.toLowerCase()\n                                ? (_.isArray(rule.value) ? rule.value : (rule.value ? rule.value.split(',').map(val => val.trim()) : ''))\n                                : rule.value);\n                        rules[index] = LiveVariableUtils.getFilterOption(variable, {\n                            'fieldName': rule.target,\n                            'type': rule.type,\n                            'value': value,\n                            'required': rule.required,\n                            'filterCondition': rule.matchMode || options.matchMode || variable.matchMode\n                        }, options);\n                    }\n                }\n            }\n        });\n    }\n\n    static getSearchField(fieldValue, ignoreCase, skipEncode) {\n        let fieldName = fieldValue.attributeName;\n        let matchModeExpr;\n        let paramValue;\n        let filterCondition = fieldValue.filterCondition;\n\n        const value = fieldValue.attributeValue;\n        const isValArray = _.isArray(value);\n        const dbModes = DB_CONSTANTS.DATABASE_MATCH_MODES;\n\n        // If value is an empty array, do not generate the query\n        // If values is NaN and number type, do not generate query for this field\n        if ((isValArray && _.isEmpty(value)) || (isValArray && _.some(value, val => (_.isNull(val) || _.isNaN(val) || val === ''))) || (!isValArray && isNaN(value) && isNumberType(fieldValue.attributeType))) {\n            return;\n        }\n        if (isValArray) {\n            // If array is value and mode is between, pass between. Else pass as in query\n            filterCondition = filterCondition === dbModes.between || filterCondition === dbModes.notin ? filterCondition : dbModes.in;\n            fieldValue.filterCondition = filterCondition;\n        }\n        matchModeExpr = DB_CONSTANTS.DATABASE_MATCH_MODES_WITH_QUERY[filterCondition];\n        paramValue = LiveVariableUtils.getParamValue(value, fieldValue, ignoreCase, skipEncode);\n        fieldName = LiveVariableUtils.wrapInLowerCase(fieldName, fieldValue, ignoreCase, true);\n        return replace(matchModeExpr, [fieldName, paramValue]);\n    }\n\n    /**\n     * this is used to identify whether to use ignorecase at each criteria level and not use the variable\n     * level isIgnoreCase flag and apply it to all the rules.\n     * Instead of adding an extra param to the criteria object, we have added few other matchmodes for string types like\n     * anywhere with anywhereignorecase, start with startignorecase, end with endignorecase, exact with exactignorecase,\n     * So while creating the criteria itseld user can choose whether to use ignore case or not for a particular column while querying\n     * @param matchMode\n     * @param ignoreCase\n     * @returns {*} boolean\n     */\n    static getIgnoreCase(matchMode, ignoreCase) {\n        const matchModes = DB_CONSTANTS.DATABASE_MATCH_MODES;\n        if (_.indexOf([matchModes['anywhere'], matchModes['start'], matchModes['end'], matchModes['exact']], matchMode) !== -1) {\n            return false;\n        }\n        if (_.indexOf([matchModes['anywhereignorecase'], matchModes['startignorecase'], matchModes['endignorecase'], matchModes['exactignorecase']], matchMode) !== -1) {\n            return true;\n        }\n        return ignoreCase;\n    }\n\n    static generateSearchQuery(rules, condition, ignoreCase, skipEncode) {\n        const params = [];\n        _.forEach(rules, rule => {\n            if (rule) {\n                if (rule.rules) {\n                    const query = LiveVariableUtils.generateSearchQuery(rule.rules, rule.condition, ignoreCase, skipEncode);\n                    if (query !== '') {\n                        params.push('(' + query + ')');\n                    }\n                } else {\n                    const searchField = LiveVariableUtils.getSearchField(rule, LiveVariableUtils.getIgnoreCase(rule.filterCondition, ignoreCase), skipEncode);\n                    if (!_.isNil(searchField)) {\n                        params.push(searchField);\n                    }\n                }\n            }\n        });\n        return _.join(params, ' ' + condition + ' ');\n    }\n\n    static prepareTableOptionsForFilterExps(variable, options, clonedFields) {\n        if (!isDefined(options.searchWithQuery)) {\n            options.searchWithQuery = true; // Using query api instead of  search api\n        }\n\n        const filterOptions = [];\n        const matchModes = DB_CONSTANTS.DATABASE_MATCH_MODES;\n        let orderByFields,\n            orderByOptions,\n            query;\n        let clonedObj = clonedFields || getClonedObject(variable.filterExpressions);\n\n        // if filterexpression from live filter is present use it to query\n        if (options.filterExpr && !_.isEmpty(options.filterExpr)) {\n            clonedObj = options.filterExpr;\n        }\n        // merge live filter runtime values\n        let filterRules: any = {};\n        if (!_.isEmpty(options.filterFields)) {\n            filterRules = {'condition': options.logicalOp || 'AND', 'rules': []};\n            _.forEach(options.filterFields, (filterObj, filterName) => {\n                const filterCondition = matchModes[filterObj.matchMode] || matchModes[filterObj.filterCondition] || filterObj.filterCondition;\n                if (_.includes(DB_CONSTANTS.DATABASE_EMPTY_MATCH_MODES, filterCondition) ||\n                    (!_.isNil(filterObj.value) && filterObj.value !== '')) {\n                    const type = filterObj.type || LiveVariableUtils.getSqlType(variable, filterName, options.entityName);\n                    const ruleObj = {\n                        'target': filterName,\n                        'type': type,\n                        'matchMode': filterObj.matchMode || (LiveVariableUtils.isStringType(type) ? 'startignorecase' : 'exact'),\n                        'value': filterObj.value,\n                        'required': filterObj.required || false\n                    };\n                    filterRules.rules.push(ruleObj);\n                }\n            });\n        }\n        if (!_.isEmpty(clonedObj)) {\n            if (!_.isNil(filterRules.rules) && filterRules.rules.length) {\n                // combine both the rules using 'AND'\n                const tempRules = {'condition': 'AND', 'rules': []};\n                tempRules.rules.push(getClonedObject(clonedObj));\n                tempRules.rules.push(filterRules);\n                clonedObj = tempRules;\n            }\n        } else {\n            clonedObj = filterRules;\n        }\n\n        LiveVariableUtils.processFilterFields(clonedObj.rules, variable, options);\n        query = LiveVariableUtils.generateSearchQuery(clonedObj.rules, clonedObj.condition, variable.ignoreCase, options.skipEncode);\n\n        orderByFields = getEvaluatedOrderBy(variable.orderBy, options.orderBy);\n        orderByOptions = orderByFields ? 'sort=' + orderByFields : '';\n\n        return {\n            'filter' : filterOptions,\n            'sort'   : orderByOptions,\n            'query'  : query\n        };\n    }\n\n    static prepareTableOptions(variable, options, clonedFields?) {\n        if (variable.operation === 'read') {\n            return LiveVariableUtils.prepareTableOptionsForFilterExps(variable, options, clonedFields);\n        }\n        if (!isDefined(options.searchWithQuery)) {\n            options.searchWithQuery = true; //  Using query api instead of  search api\n        }\n        const filterFields = [];\n        let filterOptions = [],\n            orderByFields,\n            orderByOptions,\n            query,\n            optionsQuery;\n        clonedFields = clonedFields || variable.filterFields;\n        // get the filter fields from the variable\n        _.forEach(clonedFields, (value, key) => {\n            if (_.isObject(value) && (!options.filterFields || !options.filterFields[key] || options.filterFields[key].logicalOp === 'AND')) {\n                value.fieldName = key;\n                if (LiveVariableUtils.isStringType(LiveVariableUtils.getSQLFieldType(variable, value))) {\n                    value.filterCondition = DB_CONSTANTS.DATABASE_MATCH_MODES[value.matchMode || variable.matchMode];\n                }\n                value.isVariableFilter = true;\n                filterFields.push(value);\n            }\n        });\n        // get the filter fields from the options\n        _.forEach(options.filterFields, (value, key) => {\n            value.fieldName = key;\n            value.filterCondition = DB_CONSTANTS.DATABASE_MATCH_MODES[value.matchMode || options.matchMode || variable.matchMode];\n            filterFields.push(value);\n        });\n        if (variable.operation === 'read' || options.operation === 'read') {\n            filterOptions = LiveVariableUtils.getFilterOptions(variable, filterFields, options);\n        }\n        /*if searchWithQuery is true, then convert the input params into query string. For example if firstName and lastName\n         should be sent as params then query string will be q='firstName containing 'someValue' OR lastName containing 'someValue''\n         */\n        if (options.searchWithQuery && filterOptions.length) {\n            // Generate query for variable filter fields. This has AND logical operator\n            query = LiveVariableUtils.getSearchQuery(_.filter(filterOptions, {'isVariableFilter': true}), ' AND ', variable.ignoreCase, options.skipEncode);\n            // Generate query for option filter fields. This has default logical operator as OR\n            optionsQuery = LiveVariableUtils.getSearchQuery(_.filter(filterOptions, {'isVariableFilter': undefined}), ' ' + (options.logicalOp || 'AND') + ' ', variable.ignoreCase, options.skipEncode);\n            if (optionsQuery) {\n                // If both variable and option query are present, merge them with AND\n                query = query ? (query + ' AND ( ' + optionsQuery + ' )') : optionsQuery;\n            }\n        }\n        orderByFields = getEvaluatedOrderBy(variable.orderBy, options.orderBy);\n        orderByOptions = orderByFields ? 'sort=' + orderByFields : '';\n\n        return {\n            'filter': filterOptions,\n            'sort': orderByOptions,\n            'query': query\n        };\n    }\n\n    /* Function to check if specified field is of type date*/\n    static getFieldType(fieldName, variable, relatedField?) {\n        let fieldType,\n            columns,\n            result;\n        if (variable.propertiesMap) {\n            columns = variable.propertiesMap.columns || [];\n            result = _.find(columns, obj => {\n                return obj.fieldName === fieldName;\n            });\n            // if related field name passed, get its type from columns inside the current field\n            if (relatedField && result) {\n                result = _.find(result.columns, obj => {\n                    return obj.fieldName === relatedField;\n                });\n            }\n            fieldType = result && result.type;\n        }\n        return fieldType;\n    }\n\n    // Prepare formData for blob columns\n    static prepareFormData(variableDetails, rowObject) {\n        const formData: any = new FormData();\n        formData.rowData = _.clone(rowObject);\n        _.forEach(rowObject, (colValue, colName) => {\n            if (LiveVariableUtils.getFieldType(colName, variableDetails) === 'blob') {\n                if (_.isObject(colValue)) {\n                    if (_.isArray(colValue)) {\n                        _.forEach(colValue, fileObject => {\n                            formData.append(colName, fileObject, fileObject.name);\n                        });\n                    } else {\n                        formData.append(colName, colValue, colValue.name);\n                    }\n                }\n                rowObject[colName] = colValue !== null ? '' : null;\n            }\n        });\n        formData.append(SWAGGER_CONSTANTS.WM_DATA_JSON, new Blob([JSON.stringify(rowObject)], {\n            type: 'application/json'\n        }));\n        return formData;\n    }\n\n    static traverseFilterExpressions(filterExpressions, traverseCallbackFn) {\n        if (filterExpressions && filterExpressions.rules) {\n            _.forEach(filterExpressions.rules, (filExpObj, i) => {\n                if (filExpObj.rules) {\n                    LiveVariableUtils.traverseFilterExpressions(filExpObj, traverseCallbackFn);\n                } else {\n                    return triggerFn(traverseCallbackFn, filterExpressions, filExpObj);\n                }\n            });\n        }\n    }\n\n    /**\n     * Traverses recursively the filterExpressions object and if there is any required field present with no value,\n     * then we will return without proceeding further. Its upto the developer to provide the mandatory value,\n     * if he wants to assign it in teh onbefore<delete/insert/update>function then make that field in\n     * the filter query section as optional\n     * @param filterExpressions - recursive rule Object\n     * @returns {Object} object or boolean. Object if everything gets validated or else just boolean indicating failure in the validations\n     */\n    static getFilterExprFields(filterExpressions) {\n        let isRequiredFieldAbsent = false;\n        const traverseCallbackFn = (parentFilExpObj, filExpObj) => {\n            if (filExpObj\n                && filExpObj.required\n                && ((_.indexOf(['null', 'isnotnull', 'empty', 'isnotempty', 'nullorempty'], filExpObj.matchMode) === -1) && filExpObj.value === '')) {\n                isRequiredFieldAbsent = true;\n                return false;\n            }\n        };\n        LiveVariableUtils.traverseFilterExpressions(filterExpressions, traverseCallbackFn);\n        return isRequiredFieldAbsent ? !isRequiredFieldAbsent : filterExpressions;\n    }\n\n    /**\n     *\n     * @param variable\n     * @param options\n     * @returns {function(*=): *} returns a function which should be called for the where clause.\n     * This return function can take a function as argument. This argument function can modify the filter fields\n     * before generating where clause.\n     */\n    static getWhereClauseGenerator(variable, options, updatedFilterFields?: any) {\n        return (modifier, skipEncode?: boolean) => {\n            const clonedFields = LiveVariableUtils.getFilterExprFields(getClonedObject(updatedFilterFields || variable.filterExpressions));\n            // this flag skips the encoding of the query\n            if (isDefined(skipEncode)) {\n                options.skipEncode = skipEncode;\n            }\n            if (modifier) {\n                // handling the scenario where variable can also have filterFields\n                if (options.filterFields) {\n                    modifier(clonedFields, options);\n                } else {\n                    modifier(clonedFields);\n                }\n            }\n            return LiveVariableUtils.prepareTableOptions(variable, options, clonedFields).query;\n        };\n    }\n}\n\n","import { getClonedObject, removeExtraSlashes } from '@wm/core';\n\nimport { VARIABLE_URLS } from '../../constants/variables.constants';\nimport { httpService } from './variables.utils';\n\ndeclare const _;\n\nconst isStudioMode = false;\n\nexport const parseConfig = (serviceParams: any): any => {\n\n    let val, param, config;\n    const urlParams = serviceParams.urlParams;\n\n    /*get the config out of baseServiceManager*/\n    if (VARIABLE_URLS.hasOwnProperty(serviceParams.target) && VARIABLE_URLS[serviceParams.target].hasOwnProperty(serviceParams.action)) {\n        config = getClonedObject(VARIABLE_URLS[serviceParams.target][serviceParams.action]);\n\n        /*To handle dynamic urls, append the serviceParams.config.url with the static url(i.e., config.url)*/\n        if (serviceParams.config) {\n            config.url = (serviceParams.config.url || '') + config.url;\n            config.method = serviceParams.config.method || config.method;\n            config.headers = config.headers || {};\n\n            // TODO[Shubham] - change to for - of\n            for (const key in serviceParams.config.headers) {\n                val = serviceParams.config.headers[key];\n                config.headers[key] = val;\n            }\n        }\n        /* check for url parameters to replace the url */\n        if (urlParams) {\n            for (param in urlParams) {\n                if (urlParams.hasOwnProperty(param)) {\n                    val = urlParams[param];\n                    if (!_.isUndefined(val) && val !== null) {\n                        config.url = config.url.replace(new RegExp(':' + param, 'g'), val);\n                    }\n                }\n            }\n        }\n\n        /* check for data */\n        if (serviceParams.params) {\n            config.params = serviceParams.params;\n        }\n        /* check for data */\n        if (!_.isUndefined(serviceParams.data)) {\n            config.data = serviceParams.data;\n        }\n        /* check for data parameters, written to support old service calls (.json calls) */\n        if (serviceParams.dataParams) {\n            config.data.params = serviceParams.dataParams;\n        }\n        /* check for headers */\n        if (serviceParams.headers) {\n            config.headers = serviceParams.headers;\n        }\n\n        /* set extra config flags */\n        config.byPassResult    = serviceParams.byPassResult;\n        config.isDirectCall    = serviceParams.isDirectCall;\n        config.isExtURL        = serviceParams.isExtURL;\n        config.preventMultiple = serviceParams.preventMultiple;\n        config.responseType    = serviceParams.responseType;\n\n        return config;\n    }\n\n    return null;\n};\n\nexport const generateConnectionParams = (params, action) => {\n    let connectionParams,\n        urlParams,\n        requestData;\n    requestData = params.data;\n\n    urlParams = {\n        projectID        : params.projectID,\n        service          : !_.isUndefined(params.service) ? params.service : 'services',\n        dataModelName    : params.dataModelName,\n        entityName       : params.entityName,\n        queryName        : params.queryName,\n        queryParams      : params.queryParams,\n        procedureName    : params.procedureName,\n        procedureParams  : params.procedureParams,\n        id               : params.id,\n        relatedFieldName : params.relatedFieldName,\n        page             : params.page,\n        size             : params.size,\n        sort             : params.sort\n    };\n    connectionParams = {\n        target    : 'DATABASE',\n        action    : action,\n        urlParams : urlParams,\n        data      : requestData || '',\n        config    : {\n            'url' : params.url\n        }\n    };\n\n    connectionParams = parseConfig(connectionParams);\n    // TODO: Remove after backend fix\n    connectionParams.url = removeExtraSlashes(connectionParams.url);\n\n    return connectionParams;\n};\n\nconst initiateAction = (action, params, successCallback?, failureCallback?, noproxy?) => {\n    let connectionParams,\n        urlParams,\n        requestData,\n        param,\n        val,\n        config,\n        headers,\n        httpDetails;\n\n    /*\n    config      = getClonedObject(config[action]);\n    headers     = config && config.headers;\n\n    requestData = params.data;\n\n    urlParams = {\n        projectID        : params.projectID,\n        service          : !_.isUndefined(params.service) ? params.service : 'services',\n        dataModelName    : params.dataModelName,\n        entityName       : params.entityName,\n        queryName        : params.queryName,\n        queryParams      : params.queryParams,\n        procedureName    : params.procedureName,\n        procedureParams  : params.procedureParams,\n        id               : params.id,\n        relatedFieldName : params.relatedFieldName,\n        page             : params.page,\n        size             : params.size,\n        sort             : params.sort\n    };\n    */\n    if (params.url && isStudioMode && !noproxy) {\n/*\n        /!* Check for url parameters to replace the URL.\n         * So the variable parameters in the URL will be replaced by the actual parameter values.*!/\n        if (urlParams) {\n            for (param in urlParams) {\n                if (urlParams.hasOwnProperty(param)) {\n                    val = urlParams[param];\n                    if (!_.isUndefined(val) && val !== null) {\n                        config.url = config.url.replace(new RegExp(':' + param, 'g'), val);\n                    }\n                }\n            }\n        }\n        headers = headers || {};\n        headers.skipSecurity = 'true';\n        headers['Content-Type'] = headers['Content-Type'] || 'application/json';\n        /!*(!$rootScope.preferences.workspace.loadXDomainAppDataUsingProxy is added in endpointAddress to differentiate desktop from saas*!/\n        if (action === 'testRunQuery') {\n            headers['Content-Type'] = undefined;\n            httpDetails = {\n                'endpointAddress'   : $window.location.protocol + (!$rootScope.preferences.workspace.loadXDomainAppDataUsingProxy ? ('//' + $window.location.host) : '') + params.url + config.url,\n                'method'            : config.method,\n                'content-Type'      : 'multipart/form-data',\n                'headers'           : headers\n            };\n            requestData.append(SWAGGER_CONSTANTS.WM_HTTP_JSON, new Blob([JSON.stringify(httpDetails)], {\n                type: 'application/json'\n            }));\n            connectionParams = {\n                'data': requestData,\n                'headers': headers,\n                'urlParams'         : {\n                    projectID: $rootScope.project.id\n                }\n            };\n        } else {\n            connectionParams = {\n                'data': {\n                    'endpointAddress'   : $window.location.protocol + (!$rootScope.preferences.workspace.loadXDomainAppDataUsingProxy ? ('//' + $window.location.host) : '') + params.url + config.url,\n                    'method'            : config.method,\n                    'requestBody'       : JSON.stringify(requestData),\n                    'headers'           : headers\n                },\n                'urlParams'         : {\n                    projectID: $rootScope.project.id\n                }\n            };\n        }\n        WebService.testRestService(connectionParams, function (response) {\n            var parsedData = getValidJSON(response.responseBody),\n                errMsg,\n                localeObject;\n            if (parsedData.hasOwnProperty('result')) {\n                triggerFn(successCallback, parsedData.result);\n            } else if (parsedData.hasOwnProperty('error')) {\n                triggerFn(failureCallback, (parsedData.error && parsedData.error.message) || parsedData.error);\n            } else if (parsedData.hasOwnProperty('errorDetails')) {\n                localeObject = $rootScope.locale || $rootScope.appLocale;\n                errMsg = getClonedObject(localeObject[parsedData.errorDetails.code]);\n                triggerFn(failureCallback, replace(errMsg, parsedData.errorDetails.data) || parsedData.errorDetails);\n            } else {\n                triggerFn(successCallback, parsedData);\n            }\n        }, failureCallback);*/\n    } else {\n        connectionParams = generateConnectionParams(params, action);\n        params.operation = action;\n        return httpService.sendCallAsObservable({\n            url: connectionParams.url,\n            method: connectionParams.method,\n            data: connectionParams.data,\n            headers: connectionParams.headers\n        }, params);\n    }\n};\n\nexport const LVService = {\n    searchTableDataWithQuery: (params, successCallback, failureCallback) => initiateAction('searchTableDataWithQuery', params, successCallback, failureCallback),\n    executeAggregateQuery: (params, successCallback, failureCallback) => initiateAction('executeAggregateQuery', params, successCallback, failureCallback),\n    searchTableData: (params, successCallback, failureCallback) => initiateAction('searchTableData', params, successCallback, failureCallback),\n    readTableData: (params, successCallback, failureCallback) => initiateAction('readTableData', params, successCallback, failureCallback),\n    insertTableData: (params, successCallback, failureCallback) => initiateAction('insertTableData', params, successCallback, failureCallback),\n    insertMultiPartTableData: (params, successCallback, failureCallback) => initiateAction('insertMultiPartTableData', params, successCallback, failureCallback),\n    updateTableData: (params, successCallback, failureCallback) => initiateAction('updateTableData', params, successCallback, failureCallback),\n    updateCompositeTableData: (params, successCallback, failureCallback) => initiateAction('updateCompositeTableData', params, successCallback, failureCallback),\n    periodUpdateCompositeTableData: (params, successCallback, failureCallback) => initiateAction('periodUpdateCompositeTableData', params, successCallback, failureCallback),\n    updateMultiPartTableData: (params, successCallback, failureCallback) => initiateAction('updateMultiPartTableData', params, successCallback, failureCallback),\n    updateMultiPartCompositeTableData: (params, successCallback, failureCallback) => initiateAction('updateMultiPartCompositeTableData', params, successCallback, failureCallback),\n    deleteTableData: (params, successCallback, failureCallback) => initiateAction('deleteTableData', params, successCallback, failureCallback),\n    deleteCompositeTableData: (params, successCallback, failureCallback) => initiateAction('deleteCompositeTableData', params, successCallback, failureCallback),\n    periodDeleteCompositeTableData: (params, successCallback, failureCallback) => initiateAction('periodDeleteCompositeTableData', params, successCallback, failureCallback),\n    exportTableData: params => initiateAction('exportTableData', params),\n    getDistinctDataByFields: params => initiateAction('getDistinctDataByFields', params),\n    countTableDataWithQuery: (params, successCallback, failureCallback) => initiateAction('countTableDataWithQuery', params, successCallback, failureCallback)\n};\n","import { $invokeWatchers, getClonedObject, isDateTimeType, isDefined, processFilterExpBindNode, triggerFn } from '@wm/core';\n\nimport { BaseVariableManager } from './base-variable.manager';\nimport {debounceVariableCall, formatExportExpression, initiateCallback, setInput, appManager, httpService, formatDate} from '../../util/variable/variables.utils';\nimport { LiveVariableUtils } from '../../util/variable/live-variable.utils';\nimport { $queue } from '../../util/inflight-queue';\nimport { $rootScope, CONSTANTS, VARIABLE_CONSTANTS, DB_CONSTANTS } from '../../constants/variables.constants';\nimport { AdvancedOptions } from '../../advanced-options';\nimport { generateConnectionParams } from '../../util/variable/live-variable.http.utils';\n\ndeclare const _, window;\nconst emptyArr = [];\n\nexport class LiveVariableManager extends BaseVariableManager {\n\n    public initFilterExpressionBinding(variable) {\n        const context = variable._context;\n        const destroyFn = context.registerDestroyListener ? context.registerDestroyListener.bind(context) : _.noop;\n\n        const filterSubscription = processFilterExpBindNode(context, variable.filterExpressions).subscribe((response: any) => {\n            if (variable.operation === 'read') {\n                /* if auto-update set for the variable with read operation only, get its data */\n                if (variable.autoUpdate && !_.isUndefined(response.newVal) && _.isFunction(variable.update)) {\n                    debounceVariableCall(variable, 'update');\n                }\n            } else {\n                /* if auto-update set for the variable with read operation only, get its data */\n                if (variable.autoUpdate && !_.isUndefined(response.newVal) && _.isFunction(variable[variable.operation + 'Record'])) {\n                    debounceVariableCall(variable, variable.operation + 'Record');\n                }\n            }\n        });\n\n        destroyFn(() => filterSubscription.unsubscribe());\n    }\n\n    private updateDataset(variable, data, propertiesMap, pagination) {\n        variable.pagination = pagination;\n        variable.dataSet = data;\n\n        // legacy properties in dataSet, [data, pagination]\n        Object.defineProperty(variable.dataSet, 'data', {\n            get: () => {\n                return variable.dataSet;\n            }\n        });\n        Object.defineProperty(variable.dataSet, 'pagination', {\n            get: () => {\n                return variable.pagination;\n            }\n        });\n    }\n\n    // Set the _options on variable which can be used by the widgets\n    private setVariableOptions(variable, options) {\n        variable._options = variable._options || {};\n        variable._options.orderBy = options && options.orderBy;\n        variable._options.filterFields = options && options.filterFields;\n    }\n\n    private handleError(variable, errorCB, response, options, advancedOptions?) {\n        let opt: AdvancedOptions;\n        /* If callback function is provided, send the data to the callback.\n         * The same callback if triggered in case of error also. The error-handling is done in grid.js*/\n        triggerFn(errorCB, response);\n\n        //  EVENT: ON_RESULT\n        initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, response, advancedOptions);\n\n        /* update the dataSet against the variable */\n        if (!options.skipDataSetUpdate) {\n            this.updateDataset(variable, emptyArr, variable.propertiesMap, null);\n        }\n\n        //  EVENT: ON_ERROR\n        opt = this.prepareCallbackOptions(options.errorDetails);\n        initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, response, opt);\n        //  EVENT: ON_CAN_UPDATE\n        variable.canUpdate = true;\n        initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, response, advancedOptions);\n    }\n\n    /**\n     * Traverses recursively the filterExpressions object and if there is any required field present with no value,\n     * then we will return without proceeding further. Its upto the developer to provide the mandatory value,\n     * if he wants to assign it in teh onbefore<delete/insert/update>function then make that field in\n     * the filter query section as optional\n     * @param filterExpressions - recursive rule Object\n     * @returns {Object} object or boolean. Object if everything gets validated or else just boolean indicating failure in the validations\n     */\n    private getFilterExprFields = function (filterExpressions) {\n        let isRequiredFieldAbsent = false;\n        const traverseCallbackFn = function (parentFilExpObj, filExpObj) {\n            if (filExpObj\n                && filExpObj.required\n                && ((_.indexOf(['null', 'isnotnull', 'empty', 'isnotempty', 'nullorempty'], filExpObj.matchMode) === -1) && filExpObj.value === '')) {\n                isRequiredFieldAbsent = true;\n                return false;\n            }\n        };\n        LiveVariableUtils.traverseFilterExpressions(filterExpressions, traverseCallbackFn);\n        return isRequiredFieldAbsent ? !isRequiredFieldAbsent : filterExpressions;\n    };\n\n    /**\n     * Allows the user to get the criteria of filtering and the filter fields, based on the method called\n     */\n    private getDataFilterObj = function (clonedFilterFields) {\n        return (function (clonedFields) {\n            function getCriteria(filterField) {\n                const criterian = [];\n                LiveVariableUtils.traverseFilterExpressions(clonedFields, function (filterExpressions, criteria) {\n                    if (filterField === criteria.target) {\n                        criterian.push(criteria);\n                    }\n                });\n                return criterian;\n            }\n\n            function getFilterFields() {\n                return clonedFields;\n            }\n\n            return {\n                getFilterFields: getFilterFields,\n                getCriteria: getCriteria\n            };\n        }(clonedFilterFields));\n    };\n\n    private makeCall(variable, dbOperation, params) {\n        const successHandler = (response, resolve) => {\n            if (response && response.type) {\n                resolve(response);\n            }\n        };\n        const errorHandler = (error, reject) => {\n            const errMsg = httpService.getErrMessage(error);\n            // notify variable error\n            this.notifyInflight(variable, false);\n            reject({\n                error: errMsg,\n                details: error\n            });\n        };\n        return new Promise((resolve, reject) => {\n            let reqParams = generateConnectionParams(params, dbOperation);\n            reqParams = {\n                url: reqParams.url,\n                method: reqParams.method,\n                data: reqParams.data,\n                headers: reqParams.headers\n            };\n            params.operation = dbOperation;\n            this.httpCall(reqParams, variable, params).then((response) => {\n                successHandler(response, resolve);\n            }, (e) => {\n                errorHandler(e, reject);\n            });\n        });\n    }\n\n    private getEntityData(variable, options, success, error) {\n        const dataObj: any = {};\n        let tableOptions,\n            dbOperation,\n            output,\n            newDataSet,\n            clonedFields,\n            requestData,\n            dbOperationOptions,\n            getEntitySuccess,\n            getEntityError;\n\n        // empty array kept (if variable is not of read type filterExpressions will be undefined)\n        clonedFields = this.getFilterExprFields(getClonedObject(variable.filterExpressions || {}));\n        // clonedFields = getClonedObject(variable.filterFields);\n        //  EVENT: ON_BEFORE_UPDATE\n        output = initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE, variable, this.getDataFilterObj(clonedFields), options);\n        // if filterFields are updated or modified inside the onBeforeUpdate event then in device use these fields to filter.\n        const updateFilterFields = _.isObject(output) ? getClonedObject(output) : undefined;\n        if (output === false) {\n            $queue.process(variable);\n            // $rootScope.$emit('toggle-variable-state', variable, false);\n            triggerFn(error, 'Call stopped from the event: ' + VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE);\n            return Promise.reject('Call stopped from the event: ' + VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE);\n        }\n\n        variable.canUpdate = false;\n\n        tableOptions = LiveVariableUtils.prepareTableOptions(variable, options, _.isObject(output) ? output : clonedFields);\n\n        //  if tableOptions object has query then set the dbOperation to 'searchTableDataWithQuery'\n        if (options.searchWithQuery) {\n            dbOperation = 'searchTableDataWithQuery';\n            requestData = tableOptions.query ? ('q=' + tableOptions.query) : '';\n        } else {\n            dbOperation = (tableOptions.filter && tableOptions.filter.length) ? 'searchTableData' : 'readTableData';\n            requestData = tableOptions.filter;\n        }\n        dbOperationOptions = {\n            'projectID': $rootScope.project.id,\n            'service': variable.getPrefabName() ? '' : 'services',\n            'dataModelName': variable.liveSource,\n            'entityName': variable.type,\n            'page': options.page || 1,\n            'size': options.pagesize || (CONSTANTS.isRunMode ? (variable.maxResults || 20) : (variable.designMaxResults || 20)),\n            'sort': tableOptions.sort,\n            'data': requestData,\n            'filter': LiveVariableUtils.getWhereClauseGenerator(variable, options, updateFilterFields),\n            // 'filterMeta': tableOptions.filter,\n            'url': variable.getPrefabName() ? ($rootScope.project.deployedUrl + '/prefabs/' + variable.getPrefabName()) : $rootScope.project.deployedUrl\n        };\n        getEntitySuccess = (response: any, resolve: any) => {\n            if (response && response.type) {\n                response = response.body;\n                dataObj.data = response.content;\n                dataObj.pagination = _.omit(response, 'content');\n                const advancedOptions: AdvancedOptions = this.prepareCallbackOptions(response, {pagination: dataObj.pagination});\n\n                if ((response && response.error) || !response || !_.isArray(response.content)) {\n                    this.handleError(variable, error, response.error, options, advancedOptions);\n                    return Promise.reject(response.error);\n                }\n\n                LiveVariableUtils.processBlobColumns(response.content, variable);\n\n                if (!options.skipDataSetUpdate) {\n                    //  EVENT: ON_RESULT\n                    initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, dataObj.data, advancedOptions);\n                    //  EVENT: ON_PREPARESETDATA\n                    newDataSet = initiateCallback(VARIABLE_CONSTANTS.EVENT.PREPARE_SETDATA, variable, dataObj.data, advancedOptions);\n                    if (newDataSet) {\n                        // setting newDataSet as the response to service variable onPrepareSetData\n                        dataObj.data = newDataSet;\n                    }\n                    /* update the dataSet against the variable */\n                    this.updateDataset(variable, dataObj.data, variable.propertiesMap, dataObj.pagination);\n                    this.setVariableOptions(variable, options);\n\n                    // watchers should get triggered before calling onSuccess event.\n                    // so that any variable/widget depending on this variable's data is updated\n                    $invokeWatchers(true);\n                    setTimeout(() => {\n                        // if callback function is provided, send the data to the callback\n                        triggerFn(success, dataObj.data, variable.propertiesMap, dataObj.pagination);\n\n                        //  EVENT: ON_SUCCESS\n                        initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, dataObj.data, advancedOptions);\n                        //  EVENT: ON_CAN_UPDATE\n                        variable.canUpdate = true;\n                        initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, dataObj.data, advancedOptions);\n                    });\n                }\n                return resolve({data: dataObj.data, pagination: dataObj.pagination});\n            }\n        };\n        getEntityError = (e: any, reject: any) => {\n            this.setVariableOptions(variable, options);\n            this.handleError(variable, error, e.error, _.extend(options, {errorDetails: e.details}));\n\n            return reject(e.error);\n        };\n        /* if it is a prefab variable (used in a normal project), modify the url */\n        /*Fetch the table data*/\n        return new Promise((resolve, reject) => {\n            this.makeCall(variable, dbOperation, dbOperationOptions).then((response) => {\n                getEntitySuccess(response, resolve);\n            }, err => {\n                getEntityError(err, reject);\n            });\n        });\n    }\n\n    private performCUD(operation, variable, options, success, error) {\n        options = options || {};\n        options.inputFields = options.inputFields || getClonedObject(variable.inputFields);\n        return $queue.submit(variable).then(() => {\n            this.notifyInflight(variable, !options.skipToggleState);\n            return this.doCUD(operation, variable, options, success, error)\n                .then((response) => {\n                    $queue.process(variable);\n                    this.notifyInflight(variable, false, response);\n                    return Promise.resolve(response);\n                }, (err) => {\n                    $queue.process(variable);\n                    this.notifyInflight(variable, false, err);\n                    return Promise.reject(err);\n                });\n        }, error);\n    }\n\n    private doCUD(action, variable, options, success, error) {\n        const projectID = $rootScope.project.id || $rootScope.projectName,\n            primaryKey = LiveVariableUtils.getPrimaryKey(variable),\n            isFormDataSupported = (window.File && window.FileReader && window.FileList && window.Blob);\n\n        let dbName,\n            compositeId = '',\n            rowObject = {},\n            prevData,\n            compositeKeysData = {},\n            prevCompositeKeysData = {},\n            id,\n            columnName,\n            clonedFields,\n            output,\n            onCUDerror,\n            onCUDsuccess,\n            inputFields = options.inputFields || variable.inputFields;\n\n        // EVENT: ON_BEFORE_UPDATE\n        clonedFields = getClonedObject(inputFields);\n        output = initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE, variable, clonedFields, options);\n        if (output === false) {\n            // $rootScope.$emit('toggle-variable-state', variable, false);\n            triggerFn(error);\n            return Promise.reject('Call stopped from the event: ' + VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE);\n        }\n        inputFields = _.isObject(output) ? output : clonedFields;\n        variable.canUpdate = false;\n\n        if (options.row) {\n            rowObject = options.row;\n            // For datetime types, convert the value to the format accepted by backend\n            _.forEach(rowObject, (value, key) => {\n                const fieldType = LiveVariableUtils.getFieldType(key, variable);\n                let fieldValue;\n                if (isDateTimeType(fieldType)) {\n                    fieldValue = formatDate(value, fieldType);\n                    rowObject[key] = fieldValue;\n                } else if (_.isArray(value) && LiveVariableUtils.isStringType(fieldType)) {\n                    // Construct ',' separated string if param is not array type but value is an array\n                    fieldValue = _.join(value, ',');\n                    rowObject[key] = fieldValue;\n                }\n            });\n            // Merge inputFields along with dataObj while making Insert/Update/Delete\n            _.forEach(inputFields, (attrValue, attrName) => {\n                if ((isDefined(attrValue) && attrValue !== '') && (!isDefined(rowObject[attrName]) || rowObject[attrName] === '')) {\n                    rowObject[attrName] = attrValue;\n                }\n            });\n        } else {\n            _.forEach(inputFields, (fieldValue, fieldName) => {\n                let fieldType;\n                const primaryKeys = variable.propertiesMap.primaryFields || variable.propertiesMap.primaryKeys;\n                if (!_.isUndefined(fieldValue) && fieldValue !== '') {\n                    /*For delete action, the inputFields need to be set in the request URL. Hence compositeId is set.\n                     * For insert action inputFields need to be set in the request data. Hence rowObject is set.\n                     * For update action, both need to be set.*/\n                    if (action === 'deleteTableData') {\n                        compositeId = fieldValue;\n                    }\n                    if (action === 'updateTableData') {\n                        primaryKeys.forEach(key => {\n                            if (fieldName === key) {\n                                compositeId = fieldValue;\n                            }\n                        });\n                    }\n                    if (action !== 'deleteTableData' || LiveVariableUtils.isCompositeKey(primaryKey)) {\n                        fieldType = LiveVariableUtils.getFieldType(fieldName, variable);\n                        if (isDateTimeType(fieldType)) {\n                            fieldValue = formatDate(fieldValue, fieldType);\n                        } else if (_.isArray(fieldValue) && LiveVariableUtils.isStringType(fieldType)) {\n                            // Construct ',' separated string if param is not array type but value is an array\n                            fieldValue = _.join(fieldValue, ',');\n                        }\n                        rowObject[fieldName] = fieldValue;\n                    }\n                    // for related entities, clear the blob type fields\n                    if (_.isObject(fieldValue) && !_.isArray(fieldValue)) {\n                        _.forEach(fieldValue, (val, key) => {\n                            if (LiveVariableUtils.getFieldType(fieldName, variable, key) === 'blob') {\n                                fieldValue[key] = val === null ? val : '';\n                            }\n                        });\n                    }\n                }\n            });\n        }\n\n        switch (action) {\n            case 'updateTableData':\n                prevData = options.prevData || {};\n                /*Construct the \"requestData\" based on whether the table associated with the live-variable has a composite key or not.*/\n                if (LiveVariableUtils.isCompositeKey(primaryKey)) {\n                    if (LiveVariableUtils.isNoPrimaryKey(primaryKey)) {\n                        prevCompositeKeysData = prevData || options.rowData || rowObject;\n                        compositeKeysData = rowObject;\n                    } else {\n                        primaryKey.forEach(key => {\n                            compositeKeysData[key] = rowObject[key];\n                            // In case of periodic update for Business temporal fields, passing updated field data.\n                            if (options.period) {\n                                prevCompositeKeysData[key] = rowObject[key];\n                            } else {\n                                prevCompositeKeysData[key] = prevData[key] || (options.rowData && options.rowData[key]) || rowObject[key];\n                            }\n                        });\n                    }\n                    options.row = compositeKeysData;\n                    options.compositeKeysData = prevCompositeKeysData;\n                } else {\n                    primaryKey.forEach((key) => {\n                        if (key.indexOf('.') === -1) {\n                            id = prevData[key] || (options.rowData && options.rowData[key]) || rowObject[key];\n                        } else {\n                            columnName = key.split('.');\n                            id = prevData[columnName[0]][columnName[1]];\n                        }\n                    });\n                    options.id = id;\n                    options.row = rowObject;\n                }\n\n                break;\n            case 'deleteTableData':\n                /*Construct the \"requestData\" based on whether the table associated with the live-variable has a composite key or not.*/\n                if (LiveVariableUtils.isCompositeKey(primaryKey)) {\n                    if (LiveVariableUtils.isNoPrimaryKey(primaryKey)) {\n                        compositeKeysData = rowObject;\n                    } else {\n                        primaryKey.forEach(key => {\n                            compositeKeysData[key] = rowObject[key];\n                        });\n                    }\n                    options.compositeKeysData = compositeKeysData;\n                } else if (!_.isEmpty(rowObject)) {\n                    primaryKey.forEach(key => {\n                        if (key.indexOf('.') === -1) {\n                            id = rowObject[key];\n                        } else {\n                            columnName = key.split('.');\n                            id = rowObject[columnName[0]][columnName[1]];\n                        }\n                    });\n                    options.id = id;\n                }\n                break;\n            default:\n                break;\n        }\n        // If table has blob column then send multipart data\n        if ((action === 'updateTableData' || action === 'insertTableData') && LiveVariableUtils.hasBlob(variable) && isFormDataSupported) {\n            if (action === 'updateTableData') {\n                action = 'updateMultiPartTableData';\n            } else {\n                action = 'insertMultiPartTableData';\n            }\n            rowObject = LiveVariableUtils.prepareFormData(variable, rowObject);\n        }\n        /*Check if \"options\" have the \"compositeKeysData\" property.*/\n        if (options.compositeKeysData) {\n            switch (action) {\n                case 'updateTableData':\n                    action = 'updateCompositeTableData';\n                    break;\n                case 'deleteTableData':\n                    action = 'deleteCompositeTableData';\n                    break;\n                case 'updateMultiPartTableData':\n                    action = 'updateMultiPartCompositeTableData';\n                    break;\n                default:\n                    break;\n            }\n            compositeId = LiveVariableUtils.getCompositeIDURL(options.compositeKeysData);\n        }\n        dbName = variable.liveSource;\n\n        /*Set the \"data\" in the request to \"undefined\" if there is no data.\n        * This handles cases such as \"Delete\" requests where data should not be passed.*/\n        if (_.isEmpty(rowObject) && action === 'deleteTableData') {\n            rowObject = undefined;\n        }\n\n        if ((action === 'updateCompositeTableData' || action === 'deleteCompositeTableData') && options.period) {\n            // capitalize first character\n            action = 'period' + action.charAt(0).toUpperCase() + action.substr(1);\n        }\n\n        const dbOperations = {\n            'projectID': projectID,\n            'service': variable._prefabName ? '' : 'services',\n            'dataModelName': dbName,\n            'entityName': variable.type,\n            'id': !_.isUndefined(options.id) ? encodeURIComponent(options.id) : compositeId,\n            'data': rowObject,\n            'url': variable._prefabName ? ($rootScope.project.deployedUrl + '/prefabs/' + variable._prefabName) : $rootScope.project.deployedUrl\n        };\n\n        onCUDerror = (response: any, reject: any) => {\n            const errMsg = response.error;\n            const advancedOptions: AdvancedOptions = this.prepareCallbackOptions(response);\n            // EVENT: ON_RESULT\n            initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, errMsg, advancedOptions);\n            // EVENT: ON_ERROR\n            if (!options.skipNotification) {\n                initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, errMsg, advancedOptions);\n            }\n            // EVENT: ON_CAN_UPDATE\n            variable.canUpdate = true;\n            initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, errMsg, advancedOptions);\n            triggerFn(error, errMsg);\n            reject(errMsg);\n        };\n\n        onCUDsuccess = (data: any, resolve: any) => {\n            let response = data.body;\n            const advancedOptions: AdvancedOptions = this.prepareCallbackOptions(data);\n\n            $queue.process(variable);\n            /* if error received on making call, call error callback */\n            if (response && response.error) {\n                // EVENT: ON_RESULT\n                initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, response, advancedOptions);\n                // EVENT: ON_ERROR\n                initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, response.error, advancedOptions);\n                // EVENT: ON_CAN_UPDATE\n                variable.canUpdate = true;\n                initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, response.error, advancedOptions);\n                triggerFn(error, response.error);\n                return Promise.reject(response.error);\n            }\n\n            // EVENT: ON_RESULT\n            initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, response, advancedOptions);\n            if (variable.operation !== 'read') {\n                // EVENT: ON_PREPARESETDATA\n                const newDataSet = initiateCallback(VARIABLE_CONSTANTS.EVENT.PREPARE_SETDATA, variable, response, advancedOptions);\n                if (newDataSet) {\n                    // setting newDataSet as the response to service variable onPrepareSetData\n                    response = newDataSet;\n                }\n                variable.dataSet = response;\n            }\n\n            // watchers should get triggered before calling onSuccess event.\n            // so that any variable/widget depending on this variable's data is updated\n            $invokeWatchers(true);\n            setTimeout(() => {\n                // EVENT: ON_SUCCESS\n                initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, response, advancedOptions);\n                // EVENT: ON_CAN_UPDATE\n                variable.canUpdate = true;\n                initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, response, advancedOptions);\n            });\n            triggerFn(success, response);\n            resolve(response);\n        };\n\n        return new Promise((resolve, reject) => {\n            this.makeCall(variable, action, dbOperations).then(data => {\n                onCUDsuccess(data, resolve);\n            }, response => {\n                onCUDerror(response, reject);\n            });\n        });\n    }\n\n\n\n    private aggregateData(deployedUrl, variable, options, success, error) {\n        let tableOptions,\n            dbOperationOptions,\n            aggregateDataSuccess,\n            aggregateDataError;\n        const dbOperation = 'executeAggregateQuery';\n        options = options || {};\n        options.skipEncode = true;\n        if (variable.filterFields) {\n            tableOptions = LiveVariableUtils.prepareTableOptions(variable, options);\n            options.aggregations.filter = tableOptions.query;\n        }\n        dbOperationOptions = {\n            'dataModelName': variable.liveSource,\n            'entityName': variable.type,\n            'page': options.page || 1,\n            'size': options.size || variable.maxResults,\n            'sort': options.sort || '',\n            'url': deployedUrl,\n            'data': options.aggregations\n        };\n        aggregateDataSuccess = (response: any, resolve: any) => {\n            if (response && response.type) {\n                if ((response && response.error) || !response) {\n                    triggerFn(error, response.error);\n                    return;\n                }\n                triggerFn(success, response);\n                resolve(response);\n            }\n        };\n        aggregateDataError = (errorMsg: any, reject: any) => {\n            triggerFn(error, errorMsg);\n            reject(errorMsg);\n        };\n\n        return new Promise((resolve, reject) => {\n            this.makeCall(variable, dbOperation, dbOperationOptions).then((response) => {\n                aggregateDataSuccess(response, resolve);\n            }, err => {\n                aggregateDataError(err, reject);\n            });\n        });\n    }\n\n\n    // *********************************************************** PUBLIC ***********************************************************//\n\n    /**\n     * Makes http call for a Live Variable against the configured DB Entity.\n     * Gets the paginated records against the entity\n     * @param variable\n     * @param options\n     * @param success\n     * @param error\n     * @returns {Promise<any>}: will be resolved on successful data fetch\n     */\n    public listRecords(variable, options, success, error) {\n        options = options || {};\n        options.filterFields = options.filterFields || getClonedObject(variable.filterFields);\n        return $queue.submit(variable).then(() => {\n            this.notifyInflight(variable, !options.skipToggleState);\n            return this.getEntityData(variable, options, success, error)\n                .then((response) => {\n                    $queue.process(variable);\n                    this.notifyInflight(variable, false, response);\n                    return Promise.resolve(response);\n                }, (err) => {\n                    $queue.process(variable);\n                    this.notifyInflight(variable, false, err);\n                    return Promise.reject(err);\n                });\n        }, error);\n    }\n\n    /**\n     * Makes a POST http call for a Live Variable against the configured DB Entity.\n     * Sends a Table record object with the request body\n     * the record is inserted into the entity at the backend\n     * @param variable\n     * @param options\n     * @param success\n     * @param error\n     * @returns {Promise<any>}: will be resolved on successful data fetch\n     */\n    public insertRecord(variable, options, success, error) {\n        return this.performCUD('insertTableData', variable, options, success, error);\n    }\n\n    /**\n     * Makes a PUT http call for a Live Variable against the configured DB Entity.\n     * Sends a Table record object with the request body against the primary key of an existing record\n     * the record is updated into the entity at the backend\n     * @param variable\n     * @param options\n     * @param success\n     * @param error\n     * @returns {Promise<any>}: will be resolved on successful data fetch\n     */\n    public updateRecord(variable, options, success, error) {\n        return this.performCUD('updateTableData', variable, options, success, error);\n    }\n\n    /**\n     * Makes a DELETE http call for a Live Variable against the configured DB Entity.\n     * Sends the primary key of an existing record\n     * the record is deleted from the entity at the backend\n     * @param variable\n     * @param options\n     * @param success\n     * @param error\n     * @returns {Promise<any>}: will be resolved on successful data fetch\n     */\n    public deleteRecord(variable, options, success, error) {\n        return this.performCUD('deleteTableData', variable, options, success, error);\n    }\n\n    /**\n     * sets the value against passed key on the \"inputFields\" object in the variable\n     * @param variable\n     * @param key: can be:\n     *  - a string e.g. \"username\"\n     *  - an object, e.g. {\"username\": \"john\", \"ssn\": \"11111\"}\n     * @param val\n     * - if key is string, the value against it (for that data type)\n     * - if key is object, not required\n     * @param options\n     * @returns {any}\n     */\n    public setInput(variable, key, val, options) {\n        variable.inputFields = variable.inputFields || {};\n        return setInput(variable.inputFields, key, val, options);\n    }\n\n    /**\n     * sets the value against passed key on the \"filterFields\" object in the variable\n     * @param variable\n     * @param key: can be:\n     *  - a string e.g. \"username\"\n     *  - an object, e.g. {\"username\": \"john\", \"ssn\": \"11111\"}\n     * @param val\n     * - if key is string, the value against it (for that data type)\n     * - if key is object, not required\n     * @param options\n     * @returns {any}\n     */\n    public setFilter(variable, key, val) {\n        let paramObj: any = {},\n            targetObj: any = {};\n        if (_.isObject(key)) {\n            paramObj = key;\n        } else {\n            paramObj[key] = val;\n        }\n\n        if (!variable.filterExpressions) {\n            variable.filterExpressions = {'condition': 'AND', 'rules': []};\n        }\n        targetObj = variable.filterExpressions;\n\n        // find the existing criteria if present or else return null. Find the first one and return.\n        // If the user wants to set a different object, then he has to use the getCriteria API defined\n        // on the dataFilter object passed to the onBeforeListRecords\n        function getExistingCriteria(filterField) {\n            let existingCriteria = null;\n            LiveVariableUtils.traverseFilterExpressions(targetObj, function (filterExpressions, criteria) {\n                if (filterField === criteria.target) {\n                    return existingCriteria = criteria;\n                }\n            });\n            return existingCriteria;\n        }\n\n        _.forEach(paramObj, function (paramVal, paramKey) {\n            const existingCriteria = getExistingCriteria(paramKey);\n            if (existingCriteria !== null) {\n                existingCriteria.value = paramVal;\n            } else {\n                targetObj.rules.push({\n                    target: paramKey,\n                    type: '',\n                    matchMode: '',\n                    value: paramVal,\n                    required: false\n                });\n            }\n        });\n\n        return targetObj;\n    }\n\n    /**\n     * Makes a file download call for a table\n     * @param variable\n     * @param options\n     */\n    public download(variable, options, successHandler, errorHandler) {\n        options = options || {};\n        let tableOptions,\n            dbOperationOptions,\n            downloadSuccess,\n            downloadError;\n        const data: any = {};\n        const dbOperation = 'exportTableData';\n        const projectID = $rootScope.project.id || $rootScope.projectName;\n        options.data.searchWithQuery = true; // For export, query api is used. So set this flag to true\n        options.data.skipEncode = true;\n        tableOptions = LiveVariableUtils.prepareTableOptions(variable, options.data, undefined);\n        data.query = tableOptions.query ? tableOptions.query : '';\n        data.exportSize = options.data.exportSize;\n        data.exportType = options.data.exportType;\n        data.fields = formatExportExpression(options.data.fields);\n        if (options.data.fileName) {\n            data.fileName = options.data.fileName;\n        }\n        dbOperationOptions = {\n            'projectID': projectID,\n            'service': variable.getPrefabName() ? '' : 'services',\n            'dataModelName': variable.liveSource,\n            'entityName': variable.type,\n            'sort': tableOptions.sort,\n            'url': variable.getPrefabName() ? ($rootScope.project.deployedUrl + '/prefabs/' + variable.getPrefabName()) : $rootScope.project.deployedUrl,\n            'data': data,\n            'filter': LiveVariableUtils.getWhereClauseGenerator(variable, options)\n            // 'filterMeta'    : tableOptions.filter\n        };\n        downloadSuccess = (response: any, resolve: any) => {\n            if (response && response.type) {\n                window.location.href = response.body.result;\n                triggerFn(successHandler, response);\n                resolve(response);\n            }\n        };\n        downloadError = (err: any, reject: any) => {\n            const opt: AdvancedOptions = this.prepareCallbackOptions(err.details);\n            initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, err.error, opt);\n            triggerFn(errorHandler, err.error);\n            reject(err);\n        };\n        return new Promise((resolve, reject) => {\n            this.makeCall(variable, dbOperation, dbOperationOptions).then((response) => {\n                downloadSuccess(response, resolve);\n            }, (error) => {\n                downloadError(error, reject);\n            });\n        });\n    }\n\n    /**\n     * gets primary keys against the passed related Table\n     * @param variable\n     * @param relatedField\n     * @returns {any}\n     */\n    public getRelatedTablePrimaryKeys(variable, relatedField) {\n        let primaryKeys,\n            result,\n            relatedCols;\n        if (!variable.propertiesMap) {\n            return;\n        }\n        result = _.find(variable.propertiesMap.columns || [], {'fieldName': relatedField});\n        // if related field name passed, get its type from columns inside the current field\n        if (result) {\n            relatedCols = result.columns;\n            primaryKeys = _.map(_.filter(relatedCols, 'isPrimaryKey'), 'fieldName');\n            if (primaryKeys.length) {\n                return primaryKeys;\n            }\n            if (relatedCols && relatedCols.length) {\n                relatedCols = _.find(relatedCols, {'isRelated': false});\n                return relatedCols && relatedCols.fieldName;\n            }\n        }\n    }\n\n    /**\n     * Makes HTTP call to get the data for related entity of a field in an entity\n     * @param variable\n     * @param columnName\n     * @param options\n     * @param success\n     * @param error\n     */\n    public getRelatedTableData(variable, columnName, options, success, error) {\n        const projectID = $rootScope.project.id || $rootScope.projectName;\n        const relatedTable = _.find(variable.relatedTables, table => table.relationName === columnName || table.columnName === columnName); // Comparing column name to support the old projects\n        const selfRelatedCols = _.map(_.filter(variable.relatedTables, o => o.type === variable.type), 'relationName');\n        const filterFields = [];\n        let orderBy,\n            filterOptions,\n            query,\n            action,\n            dbOperationOptions,\n            getRelatedTableDataSuccess,\n            getRelatedTableDataError;\n        _.forEach(options.filterFields, (value, key) => {\n            value.fieldName = key;\n            value.type = LiveVariableUtils.getFieldType(columnName, variable, key);\n            /**\n             * for 'in' mode we are taking the input as comma separated values and for between in ui there are two different fields\n             * but these are processed and merged into a single value with comma as separator. For these conditions like 'in' and 'between',\n             * for building the query, the function expects the values to be an array\n             */\n            if (value.filterCondition === DB_CONSTANTS.DATABASE_MATCH_MODES.in.toLowerCase() || value.filterCondition === DB_CONSTANTS.DATABASE_MATCH_MODES.between.toLowerCase()) {\n                value.value = value.value.split(',');\n            }\n            filterFields.push(value);\n        });\n        filterOptions = LiveVariableUtils.getFilterOptions(variable, filterFields, options);\n        query = LiveVariableUtils.getSearchQuery(filterOptions, ' ' + (options.logicalOp || 'AND') + ' ', variable.ignoreCase);\n        if (options.filterExpr) {\n            const _clonedFields = getClonedObject(_.isObject(options.filterExpr) ? options.filterExpr : JSON.parse(options.filterExpr));\n            LiveVariableUtils.processFilterFields(_clonedFields.rules, variable, options);\n            const filterExpQuery = LiveVariableUtils.generateSearchQuery(_clonedFields.rules, _clonedFields.condition, variable.ignoreCase, options.skipEncode);\n            if (query !== '') {\n                if (filterExpQuery !== '') {\n                    query = '(' + query + ') AND (' + filterExpQuery + ')';\n                }\n            } else if (filterExpQuery !== '') {\n                query = filterExpQuery;\n            }\n        }\n        query = query ? ('q=' + query) : '';\n        action = 'searchTableDataWithQuery';\n        orderBy = _.isEmpty(options.orderBy) ? '' : 'sort=' + options.orderBy;\n        dbOperationOptions = {\n            projectID: projectID,\n            service: variable.getPrefabName() ? '' : 'services',\n            dataModelName: variable.liveSource,\n            entityName: relatedTable ? relatedTable.type : '',\n            page: options.page || 1,\n            size: options.pagesize || undefined,\n            url: variable.getPrefabName() ? ($rootScope.project.deployedUrl + '/prefabs/' + variable.getPrefabName()) : $rootScope.project.deployedUrl,\n            data: query || '',\n            filter: LiveVariableUtils.getWhereClauseGenerator(variable, options),\n            sort: orderBy\n        };\n        getRelatedTableDataSuccess = (res: any, resolve: any) => {\n            if (res && res.type) {\n                const response = res.body;\n                /*Remove the self related columns from the data. As backend is restricting the self related column to one level, In liveform select, dataset and datavalue object\n                 * equality does not work. So, removing the self related columns to acheive the quality*/\n                const data = _.map(response.content, o => _.omit(o, selfRelatedCols));\n\n                const pagination = Object.assign({}, response);\n                delete pagination.content;\n\n                const result = {data: data, pagination};\n                triggerFn(success, result);\n\n                resolve(result);\n            }\n        };\n        getRelatedTableDataError = (errMsg: any, reject: any) => {\n            triggerFn(error, errMsg);\n            reject(errMsg);\n        };\n        return new Promise((resolve, reject) => {\n            this.makeCall(variable, action, dbOperationOptions).then((response) => {\n                getRelatedTableDataSuccess(response, resolve);\n            }, err => {\n                getRelatedTableDataError(err, reject);\n            });\n        });\n    }\n\n    /**\n     * Gets the distinct records for an entity\n     * @param variable\n     * @param options\n     * @param success\n     * @param error\n     */\n    public getDistinctDataByFields(variable, options, success, error) {\n        const dbOperation = 'getDistinctDataByFields';\n        const projectID = $rootScope.project.id || $rootScope.projectName;\n        const requestData: any = {};\n        let sort;\n        let tableOptions,\n            dbOperationOptions,\n            getDistinctDataByFieldsSuccess,\n            getDistinctDataByFieldsError;\n        options.skipEncode = true;\n        options.operation = 'read';\n        options = options || {};\n        tableOptions = LiveVariableUtils.prepareTableOptions(variable, options);\n        if (tableOptions.query) {\n            requestData.filter = tableOptions.query;\n        }\n        requestData.groupByFields = _.isArray(options.fields) ? options.fields : [options.fields];\n        sort = options.sort || requestData.groupByFields[0] + ' asc';\n        sort = sort ? 'sort=' + sort : '';\n        dbOperationOptions = {\n            'projectID': projectID,\n            'service': variable.getPrefabName() ? '' : 'services',\n            'dataModelName': variable.liveSource,\n            'entityName': options.entityName || variable.type,\n            'page': options.page || 1,\n            'size': options.pagesize,\n            'sort': sort,\n            'data': requestData,\n            'filter': LiveVariableUtils.getWhereClauseGenerator(variable, options),\n            'url': variable.getPrefabName() ? ($rootScope.project.deployedUrl + '/prefabs/' + variable.getPrefabName()) : $rootScope.project.deployedUrl\n        };\n        getDistinctDataByFieldsSuccess = (response: any, resolve: any) => {\n            if (response && response.type) {\n                if ((response && response.error) || !response) {\n                    triggerFn(error, response.error);\n                    return Promise.reject(response.error);\n                }\n                let result = response.body;\n                const pagination = Object.assign({}, response.body);\n                delete pagination.content;\n\n                result = {data: result.content, pagination};\n                triggerFn(success, result);\n                resolve(result);\n            }\n        };\n        getDistinctDataByFieldsError = (errorMsg: any, reject: any) => {\n            triggerFn(error, errorMsg);\n            reject(errorMsg);\n        };\n\n            return new Promise((resolve, reject) => {\n                this.makeCall(variable, dbOperation, dbOperationOptions).then((response) => {\n                    getDistinctDataByFieldsSuccess(response, resolve);\n                }, () => {\n                    getDistinctDataByFieldsError(error, reject);\n                });\n            });\n    }\n\n    /*Function to get the aggregated data based on the fields chosen*/\n    public getAggregatedData(variable, options, success, error) {\n        const deployedURL = appManager.getDeployedURL();\n        if (deployedURL) {\n            return this.aggregateData(deployedURL, variable, options, success, error);\n        }\n    }\n\n    public defineFirstLastRecord(variable) {\n        if (variable.operation === 'read') {\n            Object.defineProperty(variable, 'firstRecord', {\n                'configurable': true,\n                'get': () => {\n                    return _.get(variable.dataSet, 'data[0]', {});\n                }\n            });\n            Object.defineProperty(variable, 'lastRecord', {\n                'configurable': true,\n                'get': () => {\n                    const data = _.get(variable.dataSet, 'data', []);\n                    return data[data.length - 1];\n                }\n            });\n        }\n    }\n\n    public getPrimaryKey(variable) {\n        return LiveVariableUtils.getPrimaryKey(variable);\n    }\n\n    // Returns the search query params.\n    public prepareRequestParams(options) {\n        let requestParams;\n\n        const searchKeys = _.split(options.searchKey, ','),\n            matchModes = _.split(options.matchMode, ','),\n            formFields = {};\n\n        _.forEach(searchKeys, (colName, index) => {\n            formFields[colName] = {\n                value: options.query,\n                logicalOp: 'AND',\n                matchMode: matchModes[index] || matchModes[0] || 'startignorecase'\n            };\n        });\n\n        requestParams = {\n            filterFields: formFields,\n            page: options.page,\n            pagesize: options.limit || options.pagesize,\n            skipDataSetUpdate: true, // dont update the actual variable dataset,\n            skipToggleState: true, // Dont change the variable toggle state as this is a independent call\n            inFlightBehavior: 'executeAll',\n            logicalOp: 'OR',\n            orderBy: options.orderby ? _.replace(options.orderby, /:/g, ' ') : ''\n        };\n\n        if (options.onBeforeservicecall) {\n            options.onBeforeservicecall(formFields);\n        }\n\n        return requestParams;\n    }\n\n    /**\n     * Gets the filtered records based on searchKey\n     * @param variable\n     * @param options contains the searchKey and queryText\n     * @param success\n     * @param error\n     * @returns {Promise<any>}\n     */\n    public searchRecords(variable, options, success, error) {\n        const requestParams = this.prepareRequestParams(options);\n\n        return this.listRecords(variable, requestParams, success, error);\n    }\n\n    /**\n     * used in onBeforeUpdate call - called last in the function - used in old Variables using dataBinding.\n     * This function migrates the old data dataBinding to filterExpressions equivalent format\n     * @param variable\n     * @param inputData\n     * @private\n     */\n    public upgradeInputDataToFilterExpressions(variable, response, inputData) {\n        if (_.isObject(response)) {\n            inputData = response;\n            inputData.condition = 'AND';\n            inputData.rules = [];\n        }\n        /**\n         * if the user deletes a particular criteria, we need to remove this form our data aswell.\n         * so we are keeping a copy of it and the emptying the existing object and now fill it with the\n         * user set criteria. If its just modified, change the data and push it tohe rules or else just add a new criteria\n         */\n        const clonedRules = _.cloneDeep(inputData.rules);\n        inputData.rules = [];\n        _.forEach(inputData, function (valueObj, key) {\n            if (key !== 'condition' && key !== 'rules') {\n                const filteredObj = _.find(clonedRules, o => o.target === key);\n                // if the key is found update the value, else create a new rule obj and add it to the existing rules\n                if (filteredObj) {\n                    filteredObj.value = valueObj.value;\n                    filteredObj.matchMode = valueObj.matchMode || valueObj.filterCondition || filteredObj.matchMode || '';\n                    inputData.rules.push(filteredObj);\n                } else {\n                    inputData.rules.push({\n                        'target': key,\n                        'type': '',\n                        'matchMode': valueObj.matchMode || valueObj.filterCondition || '',\n                        'value': valueObj.value,\n                        'required': false\n                    });\n                }\n                delete inputData[key];\n            }\n        });\n        return inputData;\n    }\n\n    /**\n     * used in onBeforeUpdate call - called first in the function - used in old Variables using dataBinding.\n     * This function migrates the filterExpressions object to flat map structure\n     * @param variable\n     * @param inputData\n     * @private\n     */\n    public downgradeFilterExpressionsToInputData(variable, inputData) {\n        if (inputData.hasOwnProperty('getFilterFields')) {\n            inputData = inputData.getFilterFields();\n        }\n        _.forEach(inputData.rules, function (ruleObj) {\n            if (!_.isNil(ruleObj.target) && ruleObj.target !== '') {\n                inputData[ruleObj.target] = {\n                    'value': ruleObj.value,\n                    'matchMode': ruleObj.matchMode\n                };\n            }\n        });\n        return inputData;\n    }\n\n    public cancel(variable, options) {\n        if ($queue.requestsQueue.has(variable) && variable._observable) {\n            variable._observable.unsubscribe();\n            $queue.process(variable);\n            // notify inflight variable\n            this.notifyInflight(variable, false);\n        }\n    }\n}\n","import { appManager, processBinding } from '../../util/variable/variables.utils';\n\nexport abstract class BaseActionManager {\n    initBinding(variable, bindSource?, bindTarget?) {\n        processBinding(variable, variable._context, bindSource, bindTarget);\n    }\n\n    notifyInflight(variable, status: boolean, data?: any) {\n        appManager.notify('toggle-variable-state', {\n            variable: variable,\n            active: status,\n            data: data\n        });\n    }\n}\n","import * as NVUtils from '../../util/action/navigation-action.utils';\nimport { BaseActionManager } from './base-action.manager';\n\nexport class NavigationActionManager extends BaseActionManager {\n\n    invoke(variable, options) {\n        NVUtils.navigate(variable, options);\n    }\n}\n","import { navigationService } from '../variable/variables.utils';\n\n/**\n * Handles variable navigation operations\n * @param variable\n * @param options\n */\nexport const navigate = (variable, options) => {\n    variable.dataSet = (options && options.data) || variable.dataSet;\n    let viewName;\n    const pageName = variable.dataBinding.pageName || variable.pageName,\n        operation = variable.operation,\n        urlParams = variable.dataSet;\n\n    options = options || {};\n\n    /* if operation is goToPage, navigate to the pageName */\n    switch (operation) {\n        case 'goToPreviousPage':\n            navigationService.goToPrevious();\n            break;\n        case 'gotoPage':\n            navigationService.goToPage(pageName, {\n                transition: variable.pageTransitions,\n                $event: options.$event,\n                urlParams: urlParams\n            });\n            break;\n        case 'gotoView':\n            viewName = (variable.dataBinding && variable.dataBinding.viewName) || variable.viewName;\n            break;\n        case 'gotoTab':\n            viewName = (variable.dataBinding && variable.dataBinding.tabName) || variable.tabName;\n            break;\n        case 'gotoAccordion':\n            viewName = (variable.dataBinding && variable.dataBinding.accordionName) || variable.accordionName;\n            break;\n        case 'gotoSegment':\n            viewName = (variable.dataBinding && variable.dataBinding.segmentName) || variable.segmentName;\n            break;\n    }\n\n    /* if view name found, call routine to navigate to it */\n    if (viewName) {\n        navigationService.goToView(viewName, {\n            pageName: pageName,\n            transition: variable.pageTransitions,\n            $event: options.$event,\n            urlParams: urlParams\n        }, variable);\n    }\n};\n","import { BaseActionManager } from './base-action.manager';\nimport { VARIABLE_CONSTANTS } from '../../constants/variables.constants';\nimport { initiateCallback, toasterService, dialogService } from '../../util/variable/variables.utils';\n\ndeclare const _;\n\nexport class NotificationActionManager extends BaseActionManager {\n\n    private onToasterClick(variable) {\n        initiateCallback('onClick', variable, '');\n    }\n\n    private onToasterHide(variable) {\n        initiateCallback('onHide', variable, '');\n    }\n\n    private notifyViaToaster(variable, options) {\n        const type = (options.class || variable.dataBinding.class || 'info').toLowerCase(),\n            body = options.message || variable.dataBinding.text,\n            title = options.title,\n            positionClass = 'toast-' + (options.position || variable.dataBinding.toasterPosition || 'bottom right').replace(' ', '-'),\n            partialPage = variable.dataBinding.page,\n            DEFAULT_DURATION = 3000;\n        let duration = parseInt(variable.dataBinding.duration || options.duration, null),\n            toaster;\n\n        // duration\n        if (!duration) {\n            duration = (duration !== 0 && type === 'success') ? DEFAULT_DURATION : 0;\n        }\n        if (variable.dataBinding.content && variable.dataBinding.content === 'page' && partialPage) {\n            toaster = toasterService.showCustom(partialPage, {positionClass: positionClass, timeOut: duration,\n                partialParams: variable._binddataSet, context: variable._context});\n        } else {\n            toaster = toasterService.show(type, title, body || null, {positionClass: positionClass, timeOut: duration, enableHtml: true});\n        }\n\n        // callbacks\n        if (variable.onClick) {\n            toaster.onTap.subscribe( this.onToasterClick.bind(this, variable) );\n        }\n        if (variable.onHide) {\n            toaster.onHidden.subscribe( this.onToasterHide.bind(this, variable) );\n        }\n    }\n\n    private notifyViaDialog(variable, options) {\n        const commonPageDialogId = 'Common' + _.capitalize(variable.operation) + 'Dialog',\n            variableOwner = variable.owner,\n            dialogId = (variableOwner === VARIABLE_CONSTANTS.OWNER.APP ) ? commonPageDialogId : 'notification' + variable.operation + 'dialog';\n        dialogService.open(dialogId,  variable._context, {\n            notification: {\n                'title' : options.title || variable.dataBinding.title,\n                'text' : options.message || variable.dataBinding.text,\n                'okButtonText' : options.okButtonText || variable.dataBinding.okButtonText || 'OK',\n                'cancelButtonText' : options.cancelButtonText || variable.dataBinding.cancelButtonText || 'CANCEL',\n                'alerttype' : options.alerttype || variable.dataBinding.alerttype || 'information',\n                onOk: () => {\n                    initiateCallback('onOk', variable, options.data);\n                    // Close the action dialog after triggering onOk callback event\n                    dialogService.close(dialogId, variable._context);\n                },\n                onCancel: () => {\n                    initiateCallback('onCancel', variable, options.data);\n                    // Close the action dialog after triggering onCancel callback event\n                    dialogService.close(dialogId, variable._context);\n                },\n                onClose: () => {\n                    initiateCallback('onClose', variable, options.data);\n                }\n            }\n        });\n    }\n\n// *********************************************************** PUBLIC ***********************************************************//\n\n    notify(variable, options, success, error) {\n        const operation = variable.operation;\n        options = options || {};\n\n        if (operation === 'toast') {\n            this.notifyViaToaster(variable, options);\n        } else {\n            this.notifyViaDialog(variable, options);\n        }\n    }\n\n    getMessage(variable) {\n        return variable.dataBinding.text;\n    }\n\n    setMessage(variable, text) {\n        if (_.isString(text)) {\n            variable.dataBinding.text = text;\n        }\n        return variable.dataBinding.text;\n    }\n\n    getOkButtonText(variable) {\n        return variable.dataBinding.okButtonText;\n    }\n    setOkButtonText(variable, text) {\n        if (_.isString(text)) {\n            variable.dataBinding.okButtonText = text;\n        }\n        return variable.dataBinding.okButtonText;\n    }\n\n    getToasterDuration(variable) {\n        return variable.dataBinding.duration;\n    }\n\n    setToasterDuration(variable, duration) {\n        variable.dataBinding.duration = duration;\n        return variable.dataBinding.duration;\n    }\n\n    getToasterClass(variable) {\n        return variable.dataBinding.class;\n    }\n\n    setToasterClass(variable, type) {\n        if (_.isString(type)) {\n            variable.dataBinding.class = type;\n        }\n        return variable.dataBinding.class;\n    }\n\n    getToasterPosition(variable) {\n        return variable.dataBinding.class;\n    }\n\n    setToasterPosition(variable, position) {\n        if (_.isString(position)) {\n            variable.dataBinding.position = position;\n        }\n        return variable.dataBinding.position;\n    }\n\n    getAlertType(variable) {\n        return variable.dataBinding.alerttype;\n    }\n\n    setAlertType(variable, alerttype) {\n        if (_.isString(alerttype)) {\n            variable.dataBinding.alerttype = alerttype;\n        }\n        return variable.dataBinding.alerttype;\n    }\n\n    getCancelButtonText(variable) {\n        return variable.dataBinding.cancelButtonText;\n    }\n\n    setCancelButtonText(variable, text) {\n        if (_.isString(text)) {\n            variable.dataBinding.cancelButtonText = text;\n        }\n        return variable.dataBinding.cancelButtonText;\n    }\n}\n","import { getClonedObject, triggerFn } from '@wm/core';\n\nimport { BaseActionManager } from './base-action.manager';\nimport { CONSTANTS, VARIABLE_CONSTANTS } from '../../constants/variables.constants';\nimport { appManager, dialogService, initiateCallback, routerService, securityService } from '../../util/variable/variables.utils';\n\ndeclare const _;\n\nexport class LoginActionManager extends BaseActionManager {\n\n    private validate(params: any) {\n        let err, paramKey, remembermeKey;\n        const LOGIN_PARAM_REMEMBER_ME = 'j_rememberme';\n        const LOGIN_PARAM_REMEMBER_ME_OLD = ['rememberme', 'remembermecheck'];\n\n        // for older projects\n        LOGIN_PARAM_REMEMBER_ME_OLD.forEach((old_key) => {\n            if (_.isBoolean(params[old_key])) {\n                remembermeKey = old_key;\n            }\n        });\n\n        remembermeKey =  remembermeKey || LOGIN_PARAM_REMEMBER_ME;\n\n        // check remember me\n        params[remembermeKey] = _.isBoolean(params[remembermeKey]) ? params[remembermeKey] : false;\n\n        for (paramKey in params) {\n            if (params.hasOwnProperty(paramKey) &&\n                (params[paramKey] === '' || params[paramKey] === undefined)) {\n                err = 'Please provide required credentials';\n                break;\n            }\n        }\n\n        return err;\n    }\n\n    private migrateOldParams(params) {\n        const loginParams = {},\n            paramMigrationMap = {\n            'usernametext': 'j_username',\n            'username': 'j_username',\n            'passwordtext': 'j_password',\n            'password': 'j_password',\n            'remembermecheck': 'j_rememberme',\n            'rememberme': 'j_rememberme'\n        };\n\n        _.each(params, function(value, key) {\n            if (paramMigrationMap[key]) {\n                loginParams[paramMigrationMap[key]] = value;\n            } else {\n                loginParams[key] = value;\n            }\n        });\n        return loginParams;\n    }\n\n    login(variable, options, success, error) {\n        let newDataSet;\n        options = options || {};\n\n        // If login info provided along explicitly with options, don't look into the variable bindings for the same\n        const loginInfo: any = options.loginInfo || options.input || variable.dataBinding;\n\n        // client side validation\n        const errMsg = this.validate(loginInfo);\n\n        /* if error message initialized, return error */\n        if (errMsg) {\n            triggerFn(error, errMsg);\n            initiateCallback('onError', variable, errMsg);\n            return;\n        }\n\n        // Triggering 'onBeforeUpdate' and considering\n        let params: any = getClonedObject(loginInfo);\n        const output: any = initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE, variable, params);\n        if (_.isObject(output)) {\n            params = output;\n        } else if (output === false) {\n            triggerFn(error);\n            return;\n        }\n\n        // migrate old params to new\n        params = this.migrateOldParams(params);\n\n        // get previously loggedInUser name (if any)\n        const lastLoggedInUsername = _.get(securityService.get(), 'userInfo.userName');\n\n        this.notifyInflight(variable, true);\n        variable.promise = securityService.appLogin(params, (response) => {\n            // Closing login dialog after successful login\n            dialogService.close('CommonLoginDialog');\n\n            /*\n             * Get fresh security config\n             * Get App variables. if not loaded\n             * Update loggedInUser variable with new user details\n             */\n            appManager.reloadAppData().\n            then((config) => {\n                // EVENT: ON_RESULT\n                initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, _.get(config, 'userInfo'));\n                // EVENT: ON_PREPARESETDATA\n                newDataSet = initiateCallback(VARIABLE_CONSTANTS.EVENT.PREPARE_SETDATA, variable, _.get(config, 'userInfo'));\n                if (newDataSet) {\n                        // setting newDataSet as the response to service variable onPrepareSetData\n                        _.set(config, 'userInfo',newDataSet);\n                }\n                // hide the spinner after all the n/w calls are completed\n                this.notifyInflight(variable, false, response);\n                triggerFn(success);\n                setTimeout(()=>{\n                    // EVENT: ON_SUCCESS\n                    initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, _.get(config, 'userInfo'));\n\n                    /* handle navigation if defaultSuccessHandler on variable is true */\n                    if (variable.useDefaultSuccessHandler) {\n                        const isSameUserReloggedIn = lastLoggedInUsername === params['j_username'];\n                        // if first time user logging in or same user re-logging in, execute n/w calls failed before logging in\n                        if (!lastLoggedInUsername || isSameUserReloggedIn) {\n                            appManager.executeSessionFailureRequests();\n                        }\n                        // get redirectTo page from URL and remove it from URL\n                        const redirectPage = securityService.getCurrentRouteQueryParam('redirectTo'),\n                            noRedirect = appManager.noRedirect();\n                        // Get query params(page params of page being redirected to) and append to the URL after login.\n                        const queryParamsObj = securityService.getRedirectedRouteQueryParams();\n                        // The redirectTo param isn't required after login\n                        if (queryParamsObj.redirectTo) {\n                            delete queryParamsObj.redirectTo;\n                        }\n                        appManager.noRedirect(false);\n                        // first time login\n                        if (!lastLoggedInUsername) {\n                            // if redirect page found, navigate to it.\n                            if (!_.isEmpty(redirectPage)) {\n                                routerService.navigate([`/${redirectPage}`], { queryParams : queryParamsObj});\n                            } else if (!noRedirect) {\n                                // simply reset the URL, route handling will take care of page redirection\n                                routerService.navigate([`/`]);\n                            }\n                        } else {\n                        // login after a session timeout\n                            // if redirect page found and same user logs in again, just navigate to redirect page\n                            if (!_.isEmpty(redirectPage)) {\n                                // same user logs in again, just redirect to the redirectPage\n                                if (lastLoggedInUsername === params['j_username']) {\n                                    routerService.navigate([`/${redirectPage}`], { queryParams : queryParamsObj});\n                                } else {\n                                    // different user logs in, reload the app and discard the redirectPage\n                                    routerService.navigate([`/`]);\n                                    window.location.reload();\n                                }\n                            } else {\n                                const securityConfig = securityService.get(),\n                                    sessionTimeoutLoginMode = _.get(securityConfig, 'loginConfig.sessionTimeout.type') || 'PAGE';\n                                // if in dialog mode and a new user logs in OR login happening through page, reload the app\n                                if (!isSameUserReloggedIn || sessionTimeoutLoginMode !== 'DIALOG') {\n                                    routerService.navigate([`/`]);\n                                    window.location.reload();\n                                }\n                            }\n\n                        }\n                    }\n                    // EVENT: ON_CAN_UPDATE\n                    initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, _.get(config, 'userInfo'));\n                })\n                \n            });\n        }, (e) => {\n            // EVENT: ON_RESULT\n            initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, e);\n            this.notifyInflight(variable, false, e);\n            const errorMsg = e.error || 'Invalid credentials.';\n            const xhrObj = e.details;\n            /* if in RUN mode, trigger error events associated with the variable */\n            if (CONSTANTS.isRunMode) {\n                initiateCallback('onError', variable, errorMsg, xhrObj, true);\n            }\n            triggerFn(error, errorMsg, xhrObj);\n            // EVENT: ON_CAN_UPDATE\n            initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, e);\n        });\n    }\n}\n","import { getValidJSON, triggerFn } from '@wm/core';\n\nimport { BaseActionManager } from './base-action.manager';\nimport { CONSTANTS, VARIABLE_CONSTANTS } from '../../constants/variables.constants';\nimport { appManager, initiateCallback, securityService } from './../../util/variable/variables.utils';\nimport { routerService } from '../../util/variable/variables.utils';\n\nexport class LogoutActionManager extends BaseActionManager {\n    logout(variable, options, success, error) {\n        let handleError,\n            redirectPage,\n            output,\n            newDataSet;\n\n        handleError = function (msg, details, xhrObj) {\n            /* if in RUN mode, trigger error events associated with the variable */\n            if (!CONSTANTS.isStudioMode) {\n                initiateCallback('onError', variable, msg, xhrObj);\n            }\n            triggerFn(error, msg, xhrObj);\n        };\n\n        // EVENT: ON_BEFORE_UPDATE\n        output = initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_UPDATE, variable, null);\n        if (output === false) {\n            triggerFn(error);\n            return;\n        }\n        securityService.isAuthenticated(isAuthenticated => {\n            if (isAuthenticated) {\n                this.notifyInflight(variable, true);\n                variable.promise = securityService.appLogout(response => {\n                    let redirectUrl = response.body;\n                    redirectUrl = getValidJSON(redirectUrl);\n                    // Reset Security Config.\n                    // $rootScope.isUserAuthenticated = false;\n                    appManager.reloadAppData().\n                    then(() => {\n                        this.notifyInflight(variable, false, redirectUrl);\n                        // EVENT: ON_RESULT\n                        initiateCallback(VARIABLE_CONSTANTS.EVENT.RESULT, variable, redirectUrl);\n                        // EVENT: ON_PREPARESETDATA\n                        newDataSet = initiateCallback(VARIABLE_CONSTANTS.EVENT.PREPARE_SETDATA, variable, redirectUrl);\n                        if (newDataSet) {\n                                // setting newDataSet as the response to service variable onPrepareSetData\n                                redirectUrl = newDataSet;\n                        }\n                        setTimeout(()=>{\n                            // EVENT: ON_SUCCESS\n                            initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, redirectUrl);\n                            // EVENT: ON_CAN_UPDATE\n                            initiateCallback(VARIABLE_CONSTANTS.EVENT.CAN_UPDATE, variable, redirectUrl);\n                        })\n                    });\n\n                    // In case of CAS response will be the redirectUrl\n                    if (redirectUrl && redirectUrl.result) {\n                        window.location.href = redirectUrl.result;\n                    } else if (variable.useDefaultSuccessHandler) {\n                        redirectPage = variable.redirectTo;\n                        /* backward compatibility (index.html/login.html may be present in older projects) */\n                        if (!redirectPage || redirectPage === 'login.html' || redirectPage === 'index.html') {\n                            redirectPage = '';\n                        }\n                        routerService.navigate([`/${redirectPage}`]);\n                        // do not reload the mobile app.\n                        if (!window['cordova']) {\n                            setTimeout(() => {\n                                // reloading in timeout as, firefox and safari are not updating the url before reload(WMS-7887)\n                                window.location.reload();\n                            });\n                        }\n                    }\n                    triggerFn(success);\n                }, handleError);\n            } else {\n                handleError('No authenticated user to logout.');\n            }\n        }, (err) => {\n            this.notifyInflight(variable, false, err);\n            handleError(err);\n        });\n    }\n}\n","import { isDefined } from '@wm/core';\n\nimport { BaseActionManager } from './base-action.manager';\nimport { initiateCallback } from '../../util/variable/variables.utils';\nimport { CONSTANTS } from '../../constants/variables.constants';\n\nexport class TimerActionManager extends BaseActionManager {\n    trigger(variable, options, success, error) {\n        if (isDefined(variable._promise) || CONSTANTS.isStudioMode) {\n            return;\n        }\n        const repeatTimer = variable.repeating,\n            delay = variable.delay || CONSTANTS.DEFAULT_TIMER_DELAY,\n            event = 'onTimerFire',\n            exec = function () {\n                initiateCallback(event, variable, {});\n            };\n\n        variable._promise = repeatTimer ? setInterval(exec, delay) : setTimeout(function () {\n            exec();\n            variable._promise = undefined;\n        }, delay);\n\n        /*// destroy the timer on scope destruction\n        callBackScope.$on('$destroy', function () {\n            variable.cancel(variable._promise);\n        });*/\n\n        return variable._promise;\n    }\n\n    cancel(variable) {\n        if (isDefined(variable._promise)) {\n            if (variable.repeating) {\n                clearInterval(variable._promise);\n            } else {\n                clearTimeout(variable._promise);\n            }\n            variable._promise = undefined;\n        }\n    }\n}\n","import { BaseVariableManager } from './base-variable.manager';\nimport { initiateCallback } from '../../util/variable/variables.utils';\nimport { DeviceVariableService } from './device-variable-service';\n\n/**\n * Device operation registered in this class will be invoked when a device variable requests the operation.\n */\nexport class DeviceVariableManager extends BaseVariableManager {\n\n    /**\n     * A map that contains services and their operations.\n     *\n     * @type {Map<string, Map<string, DeviceVariableService>>}\n     */\n    private serviceRegistry: Map<string, DeviceVariableService> = new Map<string, DeviceVariableService>();\n\n    /**\n     * Invokes the given device variable and returns a promise that is resolved or rejected\n     * by the device operation's outcome.\n     * @param variable\n     * @param options\n     * @returns {Promise<any>}\n     */\n    public invoke(variable: any, options: any): Promise<any> {\n        const service = this.serviceRegistry.get(variable.service);\n        if (service == null) {\n            initiateCallback('onError', variable, null);\n            return Promise.reject(`Could not find service '${service}'`);\n        } else {\n            this.notifyInflight(variable, true);\n            return service.invoke(variable, options).then( response => {\n                this.notifyInflight(variable, false, response);\n                return response;\n            }, err => {\n                this.notifyInflight(variable, false, err);\n                return Promise.reject(err);\n            });\n        }\n    }\n\n    /**\n     * Adds an operation under the given service category\n     * @param {string} service\n     */\n    public registerService(service: DeviceVariableService) {\n        this.serviceRegistry.set(service.name, service);\n    }\n}\n","import { $WebSocket } from 'angular2-websocket/angular2-websocket';\n\nimport { getValidJSON, isDefined, isInsecureContentRequest, isObject, triggerFn, xmlToJson } from '@wm/core';\n\nimport { BaseVariableManager } from './base-variable.manager';\nimport { WebSocketVariable } from '../../model/variable/web-socket-variable';\nimport { initiateCallback, metadataService } from '../../util/variable/variables.utils';\nimport { CONSTANTS, VARIABLE_CONSTANTS } from '../../constants/variables.constants';\nimport { ServiceVariableUtils } from '../../util/variable/service-variable.utils';\n\ndeclare const _;\n\nexport class WebSocketVariableManager extends BaseVariableManager {\n\n    scope_var_socket_map = new Map();\n    PROPERTY = {\n        'SERVICE': 'service',\n        'DATA_UPDATE_STRATEGY': 'dataUpdateStrategy',\n        'DATA_LIMIT': 'dataLimit'\n    };\n    DATA_UPDATE_STRATEGY = {\n        'REFRESH': 'refresh',\n        'PREPEND': 'prepend',\n        'APPEND': 'append'\n    };\n\n    /**\n     * returns the state of property to decide weather to append new messages to dataSet or not\n     * @param variable\n     * @returns boolean\n     */\n    private shouldAppendData(variable) {\n        variable = variable || this;\n        return variable[this.PROPERTY.DATA_UPDATE_STRATEGY] !== this.DATA_UPDATE_STRATEGY.REFRESH;\n    }\n\n    /**\n     * returns the state of property to decide weather to APPEND or PREPEND new messages to dataSet\n     * @param variable\n     * @returns boolean\n     */\n    private shouldAppendLast(variable) {\n        return variable[this.PROPERTY.DATA_UPDATE_STRATEGY] === this.DATA_UPDATE_STRATEGY.APPEND;\n    }\n\n    /**\n     * returns upper limit on number of records to be in dataSet\n     * this is applicable only when appendData is true\n     * @param variable\n     * @returns {dataLimit}\n     */\n    private getDataLimit(variable) {\n        return variable.dataLimit;\n    }\n\n    /**\n     * get url from wmServiceOperationInfo\n     * @param variable\n     * @returns {*}\n     */\n    private getURL(variable) {\n        const prefabName = variable.getPrefabName();\n        const opInfo = prefabName ? _.get(metadataService.getByOperationId(variable.operationId, prefabName), 'wmServiceOperationInfo') : _.get(metadataService.getByOperationId(variable.operationId), 'wmServiceOperationInfo');\n        const inputFields = variable.dataBinding;\n        let config;\n\n        // add sample values to the params (url and path)\n        _.forEach(opInfo.parameters, function (param) {\n            param.sampleValue = inputFields[param.name];\n        });\n        // although, no header params will be present, keeping 'skipCloakHeaders' flag if support provided later\n        $.extend(opInfo, {\n            skipCloakHeaders: true\n        });\n\n        // call common method to prepare config for the service operation info.\n        config = ServiceVariableUtils.constructRequestParams(variable, opInfo, inputFields);\n        /* if error found, return */\n        if (config.error && config.error.message) {\n            this._onSocketError(variable, {data: config.error.message});\n            return;\n        }\n        return config.url;\n    }\n\n    /**\n     * handler for onMessage event on a socket connection for a variable\n     * the data returned is converted to JSON from string/xml and assigned to dataSet of variable\n     * If not able to do so, message is simply assigned to the dataSet of variable\n     * If appendData property is set, the message is appended to the dataSet, else it replaces the existing value of dataSet\n     * @param variable\n     * @param evt\n     * @private\n     */\n    private _onSocketMessage(variable, evt) {\n        let data = _.get(evt, 'data'), value, dataLength, dataLimit, shouldAddToLast, insertIdx;\n        data = getValidJSON(data) || xmlToJson(data) || data;\n        // EVENT: ON_MESSAGE\n        value = initiateCallback(VARIABLE_CONSTANTS.EVENT.MESSAGE_RECEIVE, variable, data, evt);\n        data = isDefined(value) ? value : data;\n        if (this.shouldAppendData(variable)) {\n            variable.dataSet = variable.dataSet || [];\n            dataLength = variable.dataSet.length;\n            dataLimit = this.getDataLimit(variable);\n            shouldAddToLast = this.shouldAppendLast(variable);\n            if (dataLimit && (dataLength >= dataLimit)) {\n                if (shouldAddToLast) {\n                    variable.dataSet.shift();\n                } else {\n                    variable.dataSet.pop();\n                }\n            }\n            insertIdx = shouldAddToLast ? dataLength : 0;\n            variable.dataSet.splice(insertIdx, 0, data);\n        } else {\n            variable.dataSet = isDefined(value) ? value : data;\n        }\n    }\n\n    /**\n     * calls the ON_BEFORE_SEND callback on the variable\n     * @param variable\n     * @param message\n     * @returns {*}\n     * @private\n     */\n    private _onBeforeSend(variable, message) {\n        // EVENT: ON_BEFORE_SEND\n        return initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_SEND, variable, message);\n    }\n\n    /**\n     * calls the ON_BEFORE_CLOSE callback assigned to the variable\n     * @param variable\n     * @param evt\n     * @returns {*}\n     * @private\n     */\n    private _onBeforeSocketClose(variable, evt?) {\n        // EVENT: ON_BEFORE_CLOSE\n        return initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_CLOSE, variable, _.get(evt, 'data'), evt);\n    }\n\n    /**\n     * calls the ON_BEFORE_OPEN callback assigned\n     * called just before the connection is open\n     * @param variable\n     * @param evt\n     * @returns {*}\n     * @private\n     */\n    private _onBeforeSocketOpen(variable, evt?) {\n        // EVENT: ON_BEFORE_OPEN\n        return initiateCallback(VARIABLE_CONSTANTS.EVENT.BEFORE_OPEN, variable, _.get(evt, 'data'), evt);\n    }\n\n    /**\n     * calls the ON_OPEN event on the variable\n     * this is called once the connection is established by the variable with the target WebSocket service\n     * @param variable\n     * @param evt\n     * @private\n     */\n    private _onSocketOpen(variable, evt) {\n        variable._socketConnected = true;\n        // EVENT: ON_OPEN\n        initiateCallback(VARIABLE_CONSTANTS.EVENT.OPEN, variable, _.get(evt, 'data'), evt);\n    }\n\n    /**\n     * clears the socket variable against the variable in a scope\n     * @param variable\n     */\n    private freeSocket(variable) {\n        this.scope_var_socket_map.set(variable, undefined);\n    }\n\n    /**\n     * calls the ON_CLOSE event on the variable\n     * this is called on close of an existing connection on a variable\n     * @param variable\n     * @param evt\n     * @private\n     */\n    private _onSocketClose(variable, evt) {\n        variable._socketConnected = false;\n        this.freeSocket(variable);\n        // EVENT: ON_CLOSE\n        initiateCallback(VARIABLE_CONSTANTS.EVENT.CLOSE, variable, _.get(evt, 'data'), evt);\n    }\n\n    /**\n     * calls the ON_ERROR event on the variable\n     * this is called if an error occurs while connecting to the socket service\n     * @param variable\n     * @param evt\n     * @private\n     */\n    private _onSocketError(variable, evt) {\n        variable._socketConnected = false;\n        this.freeSocket(variable);\n        // EVENT: ON_ERROR\n        initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, _.get(evt, 'data') || 'Error while connecting with ' + variable.service, evt);\n    }\n\n    /**\n     * returns an existing socket connection on the variable\n     * if not present, make the connection and return it\n     * @param variable\n     * @returns {*}\n     */\n    private getSocket(variable) {\n        const url     = this.getURL(variable);\n        let _socket = this.scope_var_socket_map.get(variable);\n        if (_socket) {\n            return _socket;\n        }\n\n        // Trigger error if unsecured webSocket is used in secured domain, ignore in mobile device\n        if (!CONSTANTS.hasCordova && isInsecureContentRequest(url)) {\n            triggerFn(this._onSocketError.bind(this, variable));\n            return;\n        }\n        _socket = new $WebSocket(url);\n        _socket.onOpen(this._onSocketOpen.bind(this, variable));\n        _socket.onError(this._onSocketError.bind(this, variable));\n        _socket.onMessage(this._onSocketMessage.bind(this, variable));\n        _socket.onClose(this._onSocketClose.bind(this, variable));\n\n        this.scope_var_socket_map.set(variable, _socket);\n        variable._socket = _socket;\n        return _socket;\n}\n\n    /**\n     * opens a socket connection on the variable.\n     * URL & other meta data is fetched from wmServiceOperationInfo\n     * @returns {*}\n     */\n    public open(variable: WebSocketVariable, success?, error?) {\n        const shouldOpen = this._onBeforeSocketOpen(variable);\n        let socket;\n        if (shouldOpen === false) {\n            triggerFn(error);\n            return;\n        }\n        socket = this.getSocket(variable);\n        triggerFn(success);\n        return socket;\n    }\n\n    /**\n     * closes an existing socket connection on variable\n     */\n    public close(variable: WebSocketVariable) {\n        const shouldClose = this._onBeforeSocketClose(variable),\n            socket      = this.getSocket(variable);\n        if (shouldClose === false) {\n            return;\n        }\n        socket.close();\n    }\n\n    /**\n     * sends a message to the existing socket connection on the variable\n     * If socket connection not open yet, open a connections and then send\n     * if message provide, it is sent, else the one present in RequestBody param is sent\n     * @param message\n     */\n    public send(variable: WebSocketVariable, message?: string) {\n        const socket      = this.getSocket(variable);\n        let response;\n\n        message = message || _.get(variable, 'dataBinding.RequestBody');\n        response = this._onBeforeSend(variable, message);\n        if (response === false) {\n            return;\n        }\n        message = isDefined(response) ? response : message;\n        message = isObject(message) ? JSON.stringify(message) : message;\n        socket.send(message, 0);\n    }\n}\n","import { ModelVariableManager } from '../manager/variable/model-variable.manager';\nimport { ServiceVariableManager } from '../manager/variable/service-variable.manager';\nimport { LiveVariableManager } from '../manager/variable/live-variable.manager';\nimport { NavigationActionManager } from '../manager/action/navigation-action.manager';\nimport { NotificationActionManager } from '../manager/action/notification-action.manager';\nimport { BaseVariableManager } from '../manager/variable/base-variable.manager';\nimport { BaseActionManager } from '../manager/action/base-action.manager';\nimport { LoginActionManager } from '../manager/action/login-action.manager';\nimport { LogoutActionManager } from '../manager/action/logout-action.manager';\nimport { TimerActionManager } from '../manager/action/timer-action.manager';\nimport { DeviceVariableManager } from '../manager/variable/device-variable-manager';\nimport { WebSocketVariableManager } from '../manager/variable/web-socket-variable.manager';\n\nconst managerMap = new Map(),\n    typeToManagerMap = {\n        'Variable': BaseVariableManager,\n        'Action': BaseActionManager,\n        'wm.Variable': ModelVariableManager,\n        'wm.ServiceVariable': ServiceVariableManager,\n        'wm.LiveVariable': LiveVariableManager,\n        'wm.NavigationVariable': NavigationActionManager,\n        'wm.NotificationVariable': NotificationActionManager,\n        'wm.LoginVariable': LoginActionManager,\n        'wm.LogoutVariable': LogoutActionManager,\n        'wm.TimerVariable': TimerActionManager,\n        'wm.DeviceVariable': DeviceVariableManager,\n        'wm.WebSocketVariable': WebSocketVariableManager\n    };\n\nexport class VariableManagerFactory {\n\n    static get(type) {\n        return managerMap.has(type) ?\n            managerMap.get(type) :\n            managerMap.set(type, new typeToManagerMap[type]()).get(type);\n    }\n}\n","import { $invokeWatchers } from '@wm/core';\n\nimport { initiateCallback } from '../../util/variable/variables.utils';\nimport { IDeviceVariableOperation } from './device-variable-operation';\nimport { CONSTANTS, VARIABLE_CONSTANTS } from '../../constants/variables.constants';\n\nexport class DeviceVariableService {\n\n    name: string;\n\n    protected operations: IDeviceVariableOperation[];\n\n    invoke(variable: any, options: any): Promise<any> {\n        const operation = this.operations.find(o => {\n            return o.name === variable.operation;\n        });\n        if (operation == null) {\n            initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, null);\n            return Promise.reject(`Could not find operation '${variable.operation}' in service '${this.name}'`);\n        } else if (CONSTANTS.hasCordova) {\n            const dataBindings = new Map<string, any>();\n            if (variable.dataBinding !== undefined) {\n                Object.entries(variable).forEach(o => {\n                    dataBindings.set(o[0], o[1]);\n                });\n                Object.entries(variable.dataBinding).forEach(o => {\n                    dataBindings.set(o[0], o[1]);\n                });\n            }\n            return operation.invoke(variable, options, dataBindings)\n                .then(function (data) {\n                    variable.dataSet = data;\n                    $invokeWatchers(true);\n                    initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, data);\n                    return data;\n                }, function (reason) {\n                    variable.dataSet = {};\n                    $invokeWatchers(true);\n                    initiateCallback(VARIABLE_CONSTANTS.EVENT.ERROR, variable, null);\n                    return reason;\n                });\n        } else {\n            return Promise.resolve()\n                .then(() => {\n                    initiateCallback(VARIABLE_CONSTANTS.EVENT.SUCCESS, variable, operation.model);\n                    return operation.model;\n                });\n        }\n    }\n}\n","declare const _;\n\nexport default class DatasetUtil {\n\n    static isValidDataset(dataSet, isList?) {\n        if (!dataSet) {\n            return false;\n        }\n\n        // check array type dataset for list type variable\n        if (isList && !_.isArray(dataSet)) {\n            return false;\n        }\n\n        // change the dataSet\n        return dataSet;\n    }\n\n    static getValue(dataSet, key, index, isList?) {\n        index = index || 0;\n\n        // return the value against the specified key\n        return isList ? dataSet[index][key] : dataSet[key];\n    }\n\n    static setValue(dataSet, key, value, isList?) {\n        // check param sanity\n        if (key && !isList) {\n            dataSet[key] = value;\n        }\n\n        // return the new dataSet\n        return dataSet;\n    }\n\n    static getItem(dataSet, index, isList?) {\n        // return the object against the specified index\n        return isList ? dataSet[index] : dataSet;\n    }\n\n    static setItem(dataSet, i, value, isList?) {\n        let index;\n\n        // check param sanity\n        if (_.isUndefined(i) || !isList) {\n            return dataSet;\n        }\n\n        if (_.isObject(i)) {\n            index = _.findIndex(dataSet, i);\n        } else {\n            index = i;\n        }\n\n        if (index > -1) {\n            // set the value against the specified index\n            dataSet[index] = value;\n        }\n\n        // return the new dataSet\n        return dataSet;\n    }\n\n    static addItem(dataSet, value, index, isList?) {\n        // check param sanity\n        if (_.isUndefined(value) || !isList) {\n            return dataSet;\n        }\n\n        // check for index sanity\n        index = index !== undefined ? index : dataSet.length;\n\n        // set the value against the specified index\n        dataSet.splice(index, 0, value);\n\n        // return the new dataSet\n        return dataSet;\n    }\n\n    /**\n     *\n     * @param dataSet\n     * @param i, can be index value of the object/element in array\n     *      or\n     * the whole object which needs to be removed\n     * @param exactMatch\n     * @returns {any}\n     */\n    static removeItem(dataSet, i, exactMatch) {\n        let index;\n        // check for index sanity\n        i = i !== undefined ? i : dataSet.length - 1;\n\n        if (_.isObject(i)) {\n            index = _.findIndex(dataSet, i);\n            // When exactMatch property is set to true delete only when every property values are same*/\n            if (index > -1 && (!exactMatch || (exactMatch && _.isEqual(dataSet[index], i)))) {\n                dataSet.splice(index, 1);\n            }\n        } else {\n            dataSet.splice(i, 1);\n        }\n        // return the new dataSet\n        return dataSet;\n    }\n\n    static getValidDataset(isList?) {\n        return isList ? [] : {};\n    }\n\n    static getCount(dataSet, isList?) {\n        return isList ? dataSet.length : Object.keys(dataSet).length;\n    }\n}\n","import { DataSource } from '@wm/core';\n\nimport DatasetUtil from '../util/dataset-util';\n\nexport abstract class BaseVariable {\n\n    protected _id: string;\n\n    name: string;\n    owner: string;\n    category: string;\n    isList: boolean;\n    dataSet: any;\n    dataBinding: any;\n    _context: any;\n\n    execute(operation, options) {\n        let returnVal;\n        switch (operation) {\n            case DataSource.Operation.GET_NAME:\n                returnVal = this.name;\n                break;\n            case DataSource.Operation.GET_UNIQUE_IDENTIFIER:\n                returnVal = this._id;\n                break;\n            case DataSource.Operation.GET_CONTEXT_IDENTIFIER:\n                returnVal = this._context;\n                break;\n            case DataSource.Operation.ADD_ITEM:\n                returnVal = this.addItem(options.item);\n                break;\n            case DataSource.Operation.SET_ITEM:\n                returnVal = this.setItem(options.prevItem, options.item);\n                break;\n            case DataSource.Operation.REMOVE_ITEM:\n                returnVal = this.removeItem(options.item);\n                break;\n        }\n        return returnVal;\n    }\n\n    getData() {\n        return this.dataSet;\n    }\n\n    setData(dataSet: any) {\n        if (DatasetUtil.isValidDataset(dataSet, this.isList)) {\n            this.dataSet = dataSet;\n        }\n        return this.dataSet;\n    }\n\n    getValue(key: string, index: number) {\n        return DatasetUtil.getValue(this.dataSet, key, index, this.isList);\n    }\n\n    setValue(key: string, value: any) {\n        return DatasetUtil.setValue(this.dataSet, key, value, this.isList);\n    }\n\n    getItem(index: number) {\n        return DatasetUtil.getItem(this.dataSet, index, this.isList);\n    }\n\n    /**\n     *\n     * @param index, a number in ideal case\n     *        it can be the object to be replaced by the passed value\n     * @param value\n     * @returns {any}\n     */\n    setItem(index: any, value: any) {\n        return DatasetUtil.setItem(this.dataSet, index, value, this.isList);\n    }\n\n    addItem(value: any, index?: number) {\n        return DatasetUtil.addItem(this.dataSet, value, index, this.isList);\n    }\n\n    removeItem(index: any, exactMatch?: boolean) {\n        return DatasetUtil.removeItem(this.dataSet, index, exactMatch);\n    }\n\n    clearData() {\n        this.dataSet = DatasetUtil.getValidDataset(this.isList);\n        return this.dataSet;\n    }\n\n    getCount() {\n        return DatasetUtil.getCount(this.dataSet, this.isList);\n    }\n\n    /**\n     * Return the prefab name if the variable is form a prefab\n     * @returns {string}\n     */\n    getPrefabName() {\n        // __self__ is a prefab name given to a prefab which is run in preview mode\n        return this._context && (this._context.prefabName !== '__self__' && this._context.prefabName);\n    }\n}\n","import { BaseVariable } from '../base-variable';\n\nexport abstract class ApiAwareVariable extends BaseVariable {\n\n    service: string;\n    operation: string;\n    controller: string;\n    operationId: string;\n    operationType: string;\n    serviceType: string;\n    maxResults: number;\n    startUpdate: boolean;\n    autoUpdate: boolean;\n    inFlightBehavior: boolean;\n    transformationRequired: boolean;\n    canUpdate: boolean;\n\n    firstRecord;\n    lastRecord;\n\n    onBeforeUpdate: string;\n    onResult: string;\n    onError: string;\n    onBeforeDatasetReady: string;\n    onSuccess: string;\n}\n","import { VariableManagerFactory } from '../../factory/variable-manager.factory';\nimport { VARIABLE_CONSTANTS } from '../../constants/variables.constants';\nimport { DeviceVariableManager } from '../../manager/variable/device-variable-manager';\nimport { ApiAwareVariable } from './api-aware-variable';\n\nconst getManager = () => {\n    return <DeviceVariableManager> VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.DEVICE);\n};\n\nexport class DeviceVariable extends ApiAwareVariable {\n    constructor(variable: any) {\n        super();\n        Object.assign(this as any, variable);\n    }\n\n    init() {\n        getManager().initBinding(this);\n    }\n\n    invoke(options?, onSuccess?, onError?) {\n        getManager().invoke(this, options).then(onSuccess, onError);\n    }\n}\n","import { DataSource, IDataSource, isDefined } from '@wm/core';\n\nimport { VariableManagerFactory } from '../../factory/variable-manager.factory';\nimport { ApiAwareVariable } from './api-aware-variable';\nimport { VARIABLE_CONSTANTS } from '../../constants/variables.constants';\nimport { LiveVariableManager } from '../../manager/variable/live-variable.manager';\n\nconst getManager = (): LiveVariableManager => {\n    return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.LIVE);\n};\n\nexport class LiveVariable extends ApiAwareVariable implements IDataSource {\n\n    matchMode;\n    liveSource;\n    propertiesMap;\n    pagination;\n    type;\n    orderBy;\n    _options;\n    // Used to track a variable http call, so that it can be cancelled at any point of time during its execution\n    _observable;\n\n    constructor(variable: any) {\n        super();\n        Object.assign(this as any, variable);\n    }\n\n    execute(operation, options) {\n        let returnVal = super.execute(operation, options);\n        if (isDefined(returnVal)) {\n            return returnVal;\n        }\n\n        switch (operation) {\n            case DataSource.Operation.IS_API_AWARE:\n                returnVal = true;\n                break;\n            case DataSource.Operation.SUPPORTS_CRUD:\n                returnVal = true;\n                break;\n            case DataSource.Operation.SUPPORTS_DISTINCT_API:\n                returnVal = true;\n                break;\n            case DataSource.Operation.IS_PAGEABLE:\n                returnVal = true;\n                break;\n            case DataSource.Operation.SUPPORTS_SERVER_FILTER:\n                returnVal = true;\n                break;\n            case DataSource.Operation.GET_OPERATION_TYPE:\n                returnVal = this.operation;\n                break;\n            case DataSource.Operation.GET_RELATED_PRIMARY_KEYS:\n                returnVal = this.getRelatedTablePrimaryKeys(options);\n                break;\n            case DataSource.Operation.GET_ENTITY_NAME:\n                returnVal = this.propertiesMap.entityName;\n                break;\n            case DataSource.Operation.LIST_RECORDS:\n                returnVal = this.listRecords(options);\n                break;\n            case DataSource.Operation.UPDATE_RECORD :\n                returnVal = this.updateRecord(options);\n                break;\n            case DataSource.Operation.INSERT_RECORD :\n                returnVal = this.insertRecord(options);\n                break;\n            case DataSource.Operation.DELETE_RECORD :\n                returnVal = this.deleteRecord(options);\n                break;\n            case DataSource.Operation.INVOKE :\n                returnVal = this.invoke(options);\n                break;\n            case DataSource.Operation.UPDATE :\n                returnVal = this.update(options);\n                break;\n            case DataSource.Operation.GET_RELATED_TABLE_DATA:\n                returnVal = this.getRelatedTableData(options.relatedField, options);\n                break;\n            case DataSource.Operation.GET_DISTINCT_DATA_BY_FIELDS:\n                returnVal = this.getDistinctDataByFields(options);\n                break;\n            case DataSource.Operation.GET_AGGREGATED_DATA:\n                returnVal = this.getAggregatedData(options);\n                break;\n            case DataSource.Operation.GET_MATCH_MODE:\n                returnVal = this.matchMode;\n                break;\n            case DataSource.Operation.DOWNLOAD:\n                returnVal = this.download(options);\n                break;\n            case DataSource.Operation.GET_PROPERTIES_MAP:\n                returnVal = this.propertiesMap;\n                break;\n            case DataSource.Operation.GET_PRIMARY_KEY:\n                returnVal = this.getPrimaryKey();\n                break;\n            case DataSource.Operation.GET_BLOB_URL:\n                returnVal = `services/${this.liveSource}/${this.type}/${options.primaryValue}/content/${options.columnName}`;\n                break;\n            case DataSource.Operation.GET_OPTIONS:\n                returnVal = this._options || {};\n                break;\n            case DataSource.Operation.SEARCH_RECORDS:\n                returnVal = this.searchRecords(options);\n                break;\n            case DataSource.Operation.GET_REQUEST_PARAMS:\n                returnVal = this.getRequestParams(options);\n                break;\n            case DataSource.Operation.GET_PAGING_OPTIONS:\n                returnVal = this.pagination;\n                break;\n            case DataSource.Operation.IS_UPDATE_REQUIRED:\n                returnVal = true;\n                break;\n            case DataSource.Operation.IS_BOUND_TO_LOCALE:\n                returnVal = false;\n                break;\n            case DataSource.Operation.CANCEL:\n                returnVal = false;\n                break;\n            default:\n                returnVal = {};\n                break;\n        }\n        return returnVal;\n    }\n\n    listRecords(options?, success?, error?) {\n        return getManager().listRecords(this, options, success, error);\n    }\n\n    updateRecord(options?, success?, error?) {\n        return getManager().updateRecord(this, options, success, error);\n    }\n\n    insertRecord(options?, success?, error?) {\n        return getManager().insertRecord(this, options, success, error);\n    }\n\n    deleteRecord(options?, success?, error?) {\n        return getManager().deleteRecord(this, options, success, error);\n    }\n\n    setInput(key, val, options) {\n        return getManager().setInput(this, key, val, options);\n    }\n\n    setFilter(key, val) {\n        return getManager().setFilter(this, key, val);\n    }\n\n    download(options, success?, error?) {\n        return getManager().download(this, options, success, error);\n    }\n\n    invoke(options?, success?, error?) {\n        switch (this.operation) {\n            case 'insert':\n                return this.insertRecord(options, success, error);\n            case 'update':\n                return this.updateRecord(options, success, error);\n            case 'delete':\n                return this.deleteRecord(options, success, error);\n            default:\n                return this.listRecords(options, success, error);\n        }\n    }\n\n    getRelatedTablePrimaryKeys(columnName) {\n        return getManager().getRelatedTablePrimaryKeys(this, columnName);\n    }\n\n    getRelatedTableData(columnName, options, success?, error?) {\n        return getManager().getRelatedTableData(this, columnName, options, success, error);\n    }\n\n    getDistinctDataByFields(options, success?, error?) {\n        return getManager().getDistinctDataByFields(this, options, success, error);\n    }\n\n    getAggregatedData(options, success?, error?) {\n        return getManager().getAggregatedData(this, options, success, error);\n    }\n\n    getPrimaryKey() {\n        return getManager().getPrimaryKey(this);\n    }\n\n    searchRecords(options, success?, error?) {\n        return getManager().searchRecords(this, options, success, error);\n    }\n\n    getRequestParams(options) {\n        return getManager().prepareRequestParams(options);\n    }\n\n    _downgradeInputData(data) {\n        return getManager().downgradeFilterExpressionsToInputData(this, data);\n    }\n\n    _upgradeInputData(response, data) {\n        return getManager().upgradeInputDataToFilterExpressions(this, response, data);\n    }\n\n    setOrderBy(expression) {\n        this.orderBy = expression;\n\n        /* update the variable if autoUpdate flag is set */\n        if (this.autoUpdate) {\n            this.update();\n        }\n\n        return this.orderBy;\n    }\n\n    // legacy method\n    update(options?, success?, error?) {\n        return this.invoke(options, success, error);\n    }\n\n    createRecord(options?, success?, error?) {\n        return this.insertRecord(options, success, error);\n    }\n\n    init() {\n        getManager().initBinding(this, 'dataBinding', this.operation === 'read' ? 'filterFields' : 'inputFields');\n        if (this.operation === 'read') {\n            getManager().initFilterExpressionBinding(this);\n        }\n        getManager().defineFirstLastRecord(this);\n    }\n\n    cancel(options?) {\n        return getManager().cancel(this, options);\n    }\n}\n","import { DataSource } from '@wm/core';\n\nimport DatasetUtil from '../util/dataset-util';\n\nexport abstract class BaseAction {\n\n    protected _id: string;\n\n    name: string;\n    owner: string;\n    category: string;\n    dataSet: any;\n    dataBinding: any;\n    _context: any;\n\n    execute(operation, options) {\n        let returnVal;\n        switch (operation) {\n            case DataSource.Operation.GET_NAME:\n                returnVal = this.name;\n                break;\n            case DataSource.Operation.GET_UNIQUE_IDENTIFIER:\n                returnVal = this._id;\n                break;\n            case DataSource.Operation.GET_CONTEXT_IDENTIFIER:\n                returnVal = this._context;\n                break;\n        }\n        return returnVal;\n    }\n\n    getData() {\n        return this.dataSet;\n    }\n\n    setData(dataSet: any) {\n        if (DatasetUtil.isValidDataset(dataSet)) {\n            this.dataSet = dataSet;\n        }\n        return this.dataSet;\n    }\n\n    getValue(key: string, index: number) {\n        return DatasetUtil.getValue(this.dataSet, key, index);\n    }\n\n    setValue(key: string, value: any) {\n        return DatasetUtil.setValue(this.dataSet, key, value);\n    }\n\n    getItem(index: number) {\n        return DatasetUtil.getItem(this.dataSet, index);\n    }\n\n    /**\n     *\n     * @param index, a number in ideal case\n     *        it can be the object to be replaced by the passed value\n     * @param value\n     * @returns {any}\n     */\n    setItem(index: any, value: any) {\n        return DatasetUtil.setItem(this.dataSet, index, value);\n    }\n\n    addItem(value: any, index: number) {\n        return DatasetUtil.addItem(this.dataSet, value, index);\n    }\n\n    removeItem(index: any, exactMatch: boolean) {\n        return DatasetUtil.removeItem(this.dataSet, index, exactMatch);\n    }\n\n    clearData() {\n        this.dataSet = DatasetUtil.getValidDataset();\n        return this.dataSet;\n    }\n\n    getCount() {\n        return DatasetUtil.getCount(this.dataSet);\n    }\n\n    init() {\n    }\n}\n","import { VariableManagerFactory } from '../../factory/variable-manager.factory';\nimport { BaseAction } from '../base-action';\nimport { VARIABLE_CONSTANTS } from '../../constants/variables.constants';\n\nconst  getManager = () => {\n    return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.NAVIGATION);\n};\n\nexport class NavigationAction extends BaseAction {\n    operation: string;\n    pageName: string;\n\n    constructor(variable: any) {\n        super();\n        Object.assign(this as any, variable);\n    }\n\n    invoke(options?) {\n        getManager().invoke(this, options);\n    }\n\n    // legacy method.\n    navigate(options?) {\n        this.invoke(options);\n    }\n\n    init() {\n        // static property bindings\n        getManager().initBinding(this, 'dataBinding', 'dataBinding');\n\n        // dynamic property bindings (e.g. page params)\n        getManager().initBinding(this, 'dataSet', 'dataSet');\n    }\n}\n","import { DataSource, IDataSource, isDefined } from '@wm/core';\n\nimport { VariableManagerFactory } from '../../factory/variable-manager.factory';\nimport { BaseVariable } from '../base-variable';\nimport { VARIABLE_CONSTANTS } from '../../constants/variables.constants';\nimport { appManager } from '../../util/variable/variables.utils';\n\nconst getManager = () => {\n    return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.MODEL);\n};\n\nexport class ModelVariable extends BaseVariable implements IDataSource {\n\n    type: any;\n    saveInPhonegap: any;\n\n    constructor(variable: any) {\n        super();\n        Object.assign(this as any, variable);\n    }\n\n    init() {\n        if (this.isList) {\n            getManager().removeFirstEmptyObject(this);\n        }\n\n        getManager().initBinding(this, 'dataBinding', 'dataSet');\n    }\n\n    execute(operation, options) {\n        let returnVal = super.execute(operation, options);\n        if (isDefined(returnVal)) {\n            return returnVal;\n        }\n\n        switch (operation) {\n            case DataSource.Operation.IS_API_AWARE:\n                returnVal = false;\n                break;\n            case DataSource.Operation.SUPPORTS_CRUD:\n                returnVal = false;\n                break;\n            case DataSource.Operation.SUPPORTS_DISTINCT_API:\n                returnVal = false;\n                break;\n            case DataSource.Operation.IS_PAGEABLE:\n                returnVal = false;\n                break;\n            case DataSource.Operation.SUPPORTS_SERVER_FILTER:\n                returnVal = false;\n                break;\n            case DataSource.Operation.IS_BOUND_TO_LOCALE:\n                returnVal = this.isBoundToLocale();\n                break;\n            case DataSource.Operation.GET_DEFAULT_LOCALE:\n                returnVal = this.getDefaultLocale();\n                break;\n            default:\n                returnVal = {};\n                break;\n        }\n        return returnVal;\n    }\n\n    isBoundToLocale() {\n        return this.name === 'supportedLocale';\n    }\n\n    getDefaultLocale() {\n        return appManager.getSelectedLocale();\n    }\n\n}\n","import { DataSource, IDataSource, isDefined } from '@wm/core';\n\nimport { VariableManagerFactory } from '../../factory/variable-manager.factory';\nimport { ApiAwareVariable } from './api-aware-variable';\nimport { VARIABLE_CONSTANTS } from '../../constants/variables.constants';\nimport { ServiceVariableManager } from '../../manager/variable/service-variable.manager';\nimport { ServiceVariableUtils } from '../../util/variable/service-variable.utils';\n\ndeclare const _;\n\nconst getManager = (): ServiceVariableManager => {\n    return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.SERVICE);\n};\n\nexport class ServiceVariable extends ApiAwareVariable implements IDataSource {\n\n    // Used to track progress of file upload\n    _progressObservable;\n    // Used to track a variable http call, so that it can be cancelled at any point of time during its execution\n    _observable;\n    pagination;\n\n    constructor(variable: any) {\n        super();\n        Object.assign(this as any, variable);\n    }\n\n    execute(operation, options) {\n        let returnVal = super.execute(operation, options);\n        if (isDefined(returnVal)) {\n            return returnVal;\n        }\n\n        switch (operation) {\n            case DataSource.Operation.IS_API_AWARE:\n                returnVal = true;\n                break;\n            case DataSource.Operation.SUPPORTS_CRUD:\n                returnVal = false;\n                break;\n            case DataSource.Operation.SUPPORTS_DISTINCT_API:\n                returnVal = false;\n                break;\n            case DataSource.Operation.IS_PAGEABLE:\n                returnVal = (this.controller === VARIABLE_CONSTANTS.CONTROLLER_TYPE.QUERY || !_.isEmpty(this.pagination));\n                break;\n            case DataSource.Operation.SUPPORTS_SERVER_FILTER:\n                returnVal = false;\n                break;\n            case DataSource.Operation.SET_INPUT:\n                returnVal = this.setInput(options);\n                break;\n            case DataSource.Operation.LIST_RECORDS:\n                returnVal = this.invoke(options);\n                break;\n            case DataSource.Operation.INVOKE :\n                returnVal = this.invoke(options);\n                break;\n            case DataSource.Operation.UPDATE :\n                returnVal = this.update(options);\n                break;\n            case DataSource.Operation.SEARCH_RECORDS:\n                returnVal = this.searchRecords(options);\n                break;\n            case DataSource.Operation.DOWNLOAD:\n                returnVal = this.download(options);\n                break;\n            case DataSource.Operation.GET_PAGING_OPTIONS:\n                returnVal = this.pagination;\n                break;\n            case DataSource.Operation.IS_UPDATE_REQUIRED:\n                returnVal = this.isUpdateRequired(options);\n                break;\n            case DataSource.Operation.IS_BOUND_TO_LOCALE:\n                returnVal = false;\n                break;\n            case DataSource.Operation.CANCEL:\n                returnVal = this.cancel(options);\n                break;\n            default :\n                returnVal = {};\n                break;\n        }\n        return returnVal;\n    }\n\n    invoke(options?, success?, error?) {\n        return getManager().invoke(this, options, success, error);\n    }\n\n    update(options, success?, error?) {\n        return getManager().invoke(this, options, success, error);\n    }\n\n    download(options, success?, error?) {\n        return getManager().download(this, options, success, error);\n    }\n\n    setInput(key, val?, options?) {\n        return getManager().setInput(this, key, val, options);\n    }\n\n    searchRecords(options, success?, error?) {\n        return new Promise((resolve, reject) => {\n            getManager().searchRecords(this, options, (response, pagination) => {\n                resolve({data: response.content || response, pagination});\n            }, reject);\n        });\n    }\n\n    isUpdateRequired(hasData) {\n        const inputFields = getManager().getInputParms(this);\n        const queryParams = ServiceVariableUtils.excludePaginationParams(inputFields);\n\n        if (!queryParams.length) {\n            // if we don't have any query params and variable data is available then we don't need variable update, so return false\n            if (hasData) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    cancel(options?) {\n        return getManager().cancel(this, options);\n    }\n\n    init() {\n        getManager().initBinding(this);\n        getManager().defineFirstLastRecord(this);\n    }\n}\n","import { DataSource, IDataSource, isDefined } from '@wm/core';\n\nimport { VariableManagerFactory } from '../../factory/variable-manager.factory';\nimport { BaseAction } from '../base-action';\nimport { VARIABLE_CONSTANTS } from '../../constants/variables.constants';\n\nconst getManager = () => {\n    return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.NOTIFICATION);\n};\n\nexport class NotificationAction extends BaseAction implements IDataSource {\n\n    message: string;\n\n    constructor(variable: any) {\n        super();\n        Object.assign(this as any, variable);\n    }\n\n    execute(operation, options) {\n        const returnVal = super.execute(operation, options);\n        if (isDefined(returnVal)) {\n            return returnVal;\n        }\n\n        return new Promise((resolve, reject) => {\n            switch (operation) {\n                case DataSource.Operation.INVOKE :\n                    this.invoke(options, resolve, reject);\n                    break;\n                case DataSource.Operation.NOTIFY :\n                    this.notify(options, resolve, reject);\n                    break;\n                default :\n                    reject(`${operation} operation is not supported on this data source`);\n                    break;\n            }\n        });\n    }\n\n    // Backward compatible method\n    notify(options, success, error) {\n        getManager().notify(this, options, success, error);\n    }\n\n    invoke(options, success, error) {\n        this.notify(options, success, error);\n    }\n\n    getMessage() {\n        return getManager().getMessage(this);\n    }\n\n    setMessage(text) {\n        return getManager().setMessage(this, text);\n    }\n\n    clearMessage() {\n        return getManager().setMessage(this, '');\n    }\n\n    getOkButtonText() {\n        return getManager().getOkButtonText(this);\n    }\n\n    setOkButtonText(text) {\n        return getManager().setOkButtonText(this, text);\n    }\n\n    getToasterDuration() {\n        return getManager().getToasterDuration(this);\n    }\n\n    setToasterDuration(duration) {\n        return getManager().setToasterDuration(this, duration);\n    }\n\n    getToasterClass() {\n        return getManager().getToasterClass(this);\n    }\n\n    setToasterClass(classText) {\n        return getManager().setToasterClass(this, classText);\n    }\n\n    getToasterPosition() {\n        return getManager().getToasterPosition(this);\n    }\n\n    setToasterPosition(position) {\n        return getManager().setToasterPosition(this, position);\n    }\n\n    getAlertType() {\n        return getManager().getAlertType(this);\n    }\n\n    setAlertType(type) {\n        return getManager().setAlertType(this, type);\n    }\n\n    getCancelButtonText() {\n        return getManager().getCancelButtonText(this);\n    }\n\n    setCancelButtonText(text) {\n        return getManager().setCancelButtonText(this, text);\n    }\n\n    init() {\n        // static property bindings\n        getManager().initBinding(this, 'dataBinding', 'dataBinding');\n\n        // dynamic property bindings\n        getManager().initBinding(this, 'dataSet', 'dataSet');\n    }\n}\n","import { BaseAction } from '../base-action';\nimport { VARIABLE_CONSTANTS } from '../../constants/variables.constants';\nimport { VariableManagerFactory } from '../../factory/variable-manager.factory';\n\nconst  getManager = () => {\n    return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.LOGIN);\n};\n\nexport class LoginAction extends BaseAction {\n\n    startUpdate: boolean;\n    autoUpdate: boolean;\n    useDefaultSuccessHandler: boolean;\n\n    constructor(variable: any) {\n        super();\n        Object.assign(this, variable);\n    }\n\n    login(options, success, error) {\n        return getManager().login(this, options, success, error);\n    }\n\n    invoke(options, success, error) {\n        return this.login(options, success, error);\n    }\n\n    cancel() {\n        // TODO[VIBHU]: implement http abort logic\n    }\n\n    init() {\n        getManager().initBinding(this, 'dataBinding', 'dataBinding');\n    }\n}\n","import { BaseAction } from '../base-action';\nimport { VARIABLE_CONSTANTS } from '../../constants/variables.constants';\nimport { VariableManagerFactory } from '../../factory/variable-manager.factory';\n\nconst  getManager = () => {\n    return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.LOGOUT);\n};\n\nexport class LogoutAction extends BaseAction {\n\n    startUpdate: boolean;\n    autoUpdate: boolean;\n    useDefaultSuccessHandler: boolean;\n\n    constructor(variable: any) {\n        super();\n        Object.assign(this, variable);\n    }\n\n    logout(options, success, error) {\n        getManager().logout(this, options, success, error);\n    }\n\n    invoke(options, success, error) {\n        this.logout(options, success, error);\n    }\n\n    cancel() {\n        // TODO[VIBHU]: implement http abort logic\n    }\n}\n","import { BaseAction } from '../base-action';\nimport { VARIABLE_CONSTANTS } from '../../constants/variables.constants';\nimport { VariableManagerFactory } from '../../factory/variable-manager.factory';\n\nconst  getManager = () => {\n    return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.TIMER);\n};\n\nexport class TimerAction extends BaseAction {\n    constructor(variable: any) {\n        super();\n        Object.assign(this, variable);\n    }\n\n    // Backward compatible method\n    fire(options, success, error) {\n        return getManager().trigger(this, options, success, error);\n    }\n\n    invoke(options, success, error) {\n        return this.fire(options, success, error);\n    }\n\n    cancel() {\n        return getManager().cancel(this);\n    }\n}\n","import { ApiAwareVariable } from './api-aware-variable';\nimport { VARIABLE_CONSTANTS } from '../../constants/variables.constants';\nimport { VariableManagerFactory } from '../../factory/variable-manager.factory';\n\nconst getManager = () => {\n    return VariableManagerFactory.get(VARIABLE_CONSTANTS.CATEGORY.WEBSOCKET);\n};\n\nexport class WebSocketVariable extends ApiAwareVariable {\n\n    constructor(variable: any) {\n        super();\n        Object.assign(this as any, variable);\n    }\n\n    open(success?, error?) {\n        return getManager().open(this, success, error);\n    }\n\n    close () {\n        return getManager().close(this);\n    }\n\n    update() {\n        return getManager().update(this);\n    }\n\n    send(message?: string) {\n        return getManager().send(this, message);\n    }\n\n    cancel() {\n        return this.close();\n    }\n\n    invoke(options?, success?, error?) {\n        this.open(success, error);\n    }\n\n    init () {\n        getManager().initBinding(this);\n    }\n}\n","import { DeviceVariable } from '../model/variable/device-variable';\nimport { LiveVariable } from '../model/variable/live-variable';\nimport { NavigationAction } from '../model/action/navigation-action';\nimport { ModelVariable } from '../model/variable/model-variable';\nimport { ServiceVariable } from '../model/variable/service-variable';\nimport { NotificationAction } from '../model/action/notification-action';\nimport { VARIABLE_CONSTANTS } from '../constants/variables.constants';\nimport { LoginAction } from '../model/action/login-action';\nimport { LogoutAction } from '../model/action/logout-action';\nimport { TimerAction } from '../model/action/timer-action';\nimport { WebSocketVariable } from '../model/variable/web-socket-variable';\n\nexport class VariableFactory {\n\n    static create(variable, context) {\n        let variableInstance;\n        switch (variable.category) {\n            case VARIABLE_CONSTANTS.CATEGORY.MODEL:\n                variableInstance = new ModelVariable(variable);\n                break;\n            case VARIABLE_CONSTANTS.CATEGORY.SERVICE:\n                variableInstance = new ServiceVariable(variable);\n                break;\n            case VARIABLE_CONSTANTS.CATEGORY.LIVE:\n                variableInstance = new LiveVariable(variable);\n                break;\n            case VARIABLE_CONSTANTS.CATEGORY.DEVICE:\n                variableInstance = new DeviceVariable(variable);\n                break;\n            case VARIABLE_CONSTANTS.CATEGORY.NAVIGATION:\n                variableInstance = new NavigationAction(variable);\n                break;\n            case VARIABLE_CONSTANTS.CATEGORY.NOTIFICATION:\n                variableInstance = new NotificationAction(variable);\n                break;\n            case VARIABLE_CONSTANTS.CATEGORY.LOGIN:\n                variableInstance = new LoginAction(variable);\n                break;\n            case VARIABLE_CONSTANTS.CATEGORY.LOGOUT:\n                variableInstance = new LogoutAction(variable);\n                break;\n            case VARIABLE_CONSTANTS.CATEGORY.TIMER:\n                variableInstance = new TimerAction(variable);\n                break;\n            case VARIABLE_CONSTANTS.CATEGORY.WEBSOCKET:\n                variableInstance = new WebSocketVariable(variable);\n        }\n\n        variableInstance._context = context;\n        variableInstance.__cloneable__ = false;\n        return variableInstance;\n    }\n}\n","import { Injectable } from '@angular/core';\n\nimport { AbstractHttpService, hasCordova } from '@wm/core';\n\n@Injectable()\nexport class MetadataService {\n    metadataMap: Map<string, any>;\n    CONTEXT_APP = 'app';\n\n    constructor(private $http: AbstractHttpService) {}\n\n    isLoaded() {\n        return this.metadataMap ? this.metadataMap.has(this.CONTEXT_APP) : false;\n    }\n\n    load(prefabName?: string): Promise<any> {\n        let url;\n        if (hasCordova()) {\n            url = 'metadata/' + (prefabName ? `prefabs/${prefabName}/` : 'app/') + 'service-definitions.json';\n        } else {\n            url = './services/' + (prefabName ? `prefabs/${prefabName}/` : '') + 'servicedefs';\n        }\n        return new Promise((resolve, reject) => {\n            this.$http.send({'url' : url, 'method': 'GET'}).then((response) => {\n                this.metadataMap = this.metadataMap || new Map();\n                this.metadataMap.set(prefabName || this.CONTEXT_APP, response.body);\n                resolve(response.body);\n            }, reject);\n        });\n    }\n\n    getByOperationId(operationId, context) {\n        context = context || this.CONTEXT_APP;\n        const map = this.metadataMap.get(context);\n        return map && map[operationId];\n    }\n}\n","import { Injectable } from '@angular/core';\nimport { Router } from '@angular/router';\n\nimport { AbstractDialogService, AbstractHttpService, AbstractNavigationService, AbstractToasterService } from '@wm/core';\nimport { OAuthService } from '@wm/oAuth';\nimport { SecurityService } from '@wm/security';\n\nimport { VariableFactory } from '../factory/variable.factory';\nimport { BaseAction } from '../model/base-action';\nimport { setDependency } from '../util/variable/variables.utils';\nimport { MetadataService } from './metadata-service/metadata.service';\n\ndeclare const _;\n\n@Injectable()\nexport class VariablesService {\n\n    constructor(\n        private httpService: AbstractHttpService,\n        private metadataService: MetadataService,\n        private navigationService: AbstractNavigationService,\n        private routerService: Router,\n        private toasterService: AbstractToasterService,\n        private oAuthService: OAuthService,\n        private securityService: SecurityService,\n        private dialogService: AbstractDialogService\n    ) {\n        // set external dependencies, to be used across variable classes, managers and utils\n        setDependency('http', this.httpService);\n        setDependency('metadata', this.metadataService);\n        setDependency('navigationService', this.navigationService);\n        setDependency('router', this.routerService);\n        setDependency('toaster', this.toasterService);\n        setDependency('oAuth', this.oAuthService);\n        setDependency('security', this.securityService);\n        setDependency('dialog', this.dialogService);\n    }\n\n    /**\n     * loop through a collection of variables/actions\n     * trigger cancel on each (of exists)\n     * @param collection\n     */\n    bulkCancel(collection) {\n        Object.keys(collection).forEach(name => {\n            const variable = collection[name];\n            if (_.isFunction(variable.cancel)) {\n                variable.cancel();\n            }\n        });\n    }\n\n    /**\n     * loops over the variable/actions collection and trigger invoke on it if startUpdate on it is true\n     * @param collection\n     */\n    triggerStartUpdate(collection) {\n        return Promise.all(\n            Object.keys(collection)\n                .map(name => collection[name])\n                .filter( variable => variable.startUpdate && variable.invoke)\n                .map(variable => variable.invoke())\n            );\n    }\n\n    /**\n     * Takes the raw variables and actions json as input\n     * Initialize the variable and action instances through the factory\n     * collect the variables and actions in separate maps and return the collection\n     * @param {string} page\n     * @param variablesJson\n     * @param scope\n     * @returns {Variables , Actions}\n     */\n    register(page: string, variablesJson: any, scope: any) {\n        const variableInstances = {\n            Variables: {},\n            Actions: {},\n            callback: this.triggerStartUpdate\n        };\n        let varInstance;\n\n        for (const variableName in variablesJson) {\n            varInstance = VariableFactory.create(variablesJson[variableName], scope);\n            varInstance.init();\n            // if action type, put it in Actions namespace\n            if (varInstance instanceof BaseAction) {\n                variableInstances.Actions[variableName] = varInstance;\n            } else {\n                variableInstances.Variables[variableName] = varInstance;\n            }\n        }\n\n        // if the context has onDestroy listener, subscribe the event and trigger cancel on all varibales\n        if (scope.registerDestroyListener) {\n            scope.registerDestroyListener(() => {\n                this.bulkCancel(variableInstances.Variables);\n                this.bulkCancel(variableInstances.Actions);\n            });\n        }\n\n        return variableInstances;\n    }\n\n    destroy() {\n    }\n\n    registerDependency(name, ref) {\n        setDependency(name, ref);\n    }\n}\n","import { ModuleWithProviders, NgModule } from '@angular/core';\nimport {CommonModule, HashLocationStrategy, Location, LocationStrategy} from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\n\nimport { ToastrModule } from 'ngx-toastr';\n\nimport { HttpServiceModule } from '@wm/http';\nimport { SecurityModule } from '@wm/security';\nimport { OAuthModule } from '@wm/oAuth';\n\nimport { VariablesService } from './service/variables.service';\nimport { MetadataService } from './service/metadata-service/metadata.service';\n\nexport const toastrModule: ModuleWithProviders = ToastrModule.forRoot({maxOpened: 1, autoDismiss: true});\n\n@NgModule({\n    imports: [\n        CommonModule,\n        toastrModule,\n        HttpClientModule,\n        HttpServiceModule,\n        OAuthModule,\n        SecurityModule\n    ],\n    declarations: []\n})\nexport class VariablesModule {\n\n    static forRoot(): ModuleWithProviders {\n        return {\n            ngModule: VariablesModule,\n            providers: [\n                VariablesService,\n                MetadataService,\n                Location,\n                {provide: LocationStrategy, useClass: HashLocationStrategy}\n            ]\n        };\n    }\n}\n"]}